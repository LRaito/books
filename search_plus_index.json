{"./":{"url":"./","title":"ç®€ä»‹","keywords":"","body":"ç®€ä»‹ç®€å•åˆ†äº«ä¸€äº›æŠ€æœ¯æ–‡æ¡£Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_gitbook/":{"url":"doc_gitbook/","title":"GitBook","keywords":"","body":"ç®€ä»‹GitBook æ˜¯ä¸€ä¸ªä½¿ç”¨ Git å’Œ Markdown æ¥æ„å»ºä¹¦ç±çš„å·¥å…·ã€‚å®ƒå¯ä»¥å°†ä½ çš„ä¹¦è¾“å‡ºå¾ˆå¤šæ ¼å¼ï¼šPDFï¼ŒePubï¼Œmobiï¼Œæˆ–è€…è¾“å‡ºä¸ºé™æ€ç½‘é¡µã€‚GitBookå·¥å…·é“¾æ˜¯å¼€æºå¹¶ä¸”å®Œå…¨å…è´¹çš„ï¼Œå®ƒçš„æºç å¯ä»¥åœ¨ GitHub ä¸Šè·å–ã€‚Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_gitbook/deploy.html":{"url":"doc_gitbook/deploy.html","title":"å¿«é€Ÿéƒ¨ç½²","keywords":"","body":" GitBook å¿«é€Ÿéƒ¨ç½² ä½¿ç”¨ Docker éƒ¨ç½² ä½¿ç”¨ Docker-Compose éƒ¨ç½² GitBook å¿«é€Ÿéƒ¨ç½²ä½¿ç”¨ Docker éƒ¨ç½²å·¥ä½œç›®å½•ä¸‹å¿…é¡»å­˜åœ¨2ä¸ªæ–‡ä»¶ï¼š1. SUMMARY.md 2. README.md å‡å®šå·¥ä½œç›®å½•æ˜¯ ./gitbookï¼Œä½¿ç”¨ docker å¿«é€Ÿéƒ¨ç½² GitBookdocker run -v ./gitbook:/srv/gitbook -p 4000:4000 fellah/gitbook:3.2.1 gitbook serve . ä½¿ç”¨ Docker-Compose éƒ¨ç½²docker-compose.yaml ç¤ºä¾‹ï¼šservices: gitbook: restart: on-failure:10 image: fellah/gitbook:3.2.1 container_name: gitbook ports: - 4000:4000 volumes: - ./gitbook:/srv/gitbook command: gitbook serve . Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_gitbook/install_plugin.html":{"url":"doc_gitbook/install_plugin.html","title":"æ’ä»¶å®‰è£…","keywords":"","body":" GitBook æ’ä»¶å®‰è£… 1.å®‰è£…æ’ä»¶ 2.ç¼–è¾‘é…ç½®æ–‡ä»¶ 3.æ’ä»¶ç”Ÿæ•ˆ GitBook æ’ä»¶å®‰è£…1.å®‰è£…æ’ä»¶ä½¿ç”¨ npm å®‰è£…æ’ä»¶ï¼Œå‘½ä»¤å‚æ•°ä¸º:gitbook-plugin-æ’ä»¶åç§° ä»¥ç›®å½•æŠ˜å æ’ä»¶ç¤ºä¾‹ï¼Œå¦‚æœæ˜¯å®¹å™¨åŒ–éƒ¨ç½²å¯ä»¥ç›´æ¥åœ¨å®¹å™¨å†…æ‰§è¡Œï¼šnpm install gitbook-plugin-toggle-chapters 2.ç¼–è¾‘é…ç½®æ–‡ä»¶é¡¹ç›®æ ¹ç›®å½•ä¸‹éœ€è¦æœ‰æ–‡ä»¶ bool.jsonï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š{ \"plugins\": [ \"toggle-chapters\" ] } 3.æ’ä»¶ç”Ÿæ•ˆGitBook æ”¯æŒçƒ­æ›´æ–°ï¼Œä¿®æ”¹åä¼šè‡ªåŠ¨ç”Ÿæ•ˆCopyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_gitbook/pub_to_github.html":{"url":"doc_gitbook/pub_to_github.html","title":"å‘å¸ƒåˆ° GitHub Pages","keywords":"","body":"GitBook å‘å¸ƒåˆ° GitHub Pagesæ–°å»ºä¸€ä¸ªé¡¹ç›® public é¡¹ç›® books å°† GitBook ç¼–è¯‘åçš„ _book ç›®å½•ä¸‹çš„æ‰€æœ‰å†…å®¹å¤åˆ¶åˆ° books å¹¶æ¨é€åˆ° GitHub åœ¨ books é¡¹ç›®çš„ Settings -> Pages ä¸‹é€‰æ‹©åˆ†æ”¯å’Œ /(root) ç›®å½•åå¼€å¯éƒ¨ç½² ç¨ç­‰ä¸€ä¼šå„¿ä¼šæ˜¾ç¤º GitHub åˆ†é…çš„åœ°å€ Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_docker/":{"url":"doc_docker/","title":"Docker","keywords":"","body":"ç®€ä»‹Docker æ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€ å¹¶éµä» Apache2.0 åè®®å¼€æºã€‚ Docker å¯ä»¥è®©å¼€å‘è€…æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªè½»é‡çº§ã€å¯ç§»æ¤çš„å®¹å™¨ä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„ Linux æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚ å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£ï¼ˆç±»ä¼¼ iPhone çš„ appï¼‰,æ›´é‡è¦çš„æ˜¯å®¹å™¨æ€§èƒ½å¼€é”€æä½ã€‚Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_docker/docker_build.html":{"url":"doc_docker/docker_build.html","title":"Docker Build","keywords":"","body":"Docker BuildDocker Build æ˜¯ Docker Engine æœ€å¸¸ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ã€‚æ¯å½“æ‚¨åˆ›å»ºæ˜ åƒæ—¶ï¼Œæ‚¨éƒ½åœ¨ä½¿ç”¨ Docker Buildã€‚Build æ˜¯è½¯ä»¶å¼€å‘ç”Ÿå‘½å‘¨æœŸçš„å…³é”®éƒ¨åˆ†ï¼Œå¯è®©æ‚¨æ‰“åŒ…å’Œæ†ç»‘ä»£ç å¹¶å°†å…¶è¿é€åˆ°ä»»ä½•åœ°æ–¹ã€‚ Docker Build ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºæ˜ åƒçš„å‘½ä»¤ï¼Œä¹Ÿä¸ä»…ä»…æ˜¯æ‰“åŒ…ä»£ç ã€‚å®ƒæ˜¯ä¸€ä¸ªå®Œæ•´çš„å·¥å…·å’ŒåŠŸèƒ½ç”Ÿæ€ç³»ç»Ÿï¼Œä¸ä»…æ”¯æŒå¸¸è§çš„å·¥ä½œæµä»»åŠ¡ï¼Œè¿˜ä¸ºæ›´å¤æ‚å’Œé«˜çº§çš„åœºæ™¯æä¾›æ”¯æŒã€‚Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-04-02 "},"doc_docker/core_concepts.html":{"url":"doc_docker/core_concepts.html","title":"æ ¸å¿ƒæ¦‚å¿µ","keywords":"","body":"æ ¸å¿ƒæ¦‚å¿µCopyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-04-02 "},"doc_docker/docker_build_overview.html":{"url":"doc_docker/docker_build_overview.html","title":"Docker Build æ¦‚è§ˆ","keywords":"","body":" Docker Build æ¦‚è§ˆ Buildx BuildKit Docker Build æ¦‚è§ˆDocker Build å®ç°äº†å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„ï¼Œå…¶ä¸­ï¼šå®¢æˆ·ç«¯ï¼šBuildx æ˜¯ç”¨äºè¿è¡Œå’Œç®¡ç†æ„å»ºçš„å®¢æˆ·ç«¯å’Œç”¨æˆ·ç•Œé¢ã€‚ æœåŠ¡ç«¯ï¼šBuildKit æ˜¯å¤„ç†æ„å»ºæ‰§è¡Œçš„æœåŠ¡å™¨æˆ–æ„å»ºå™¨ã€‚ å½“æ‚¨è°ƒç”¨æ„å»ºæ—¶ï¼ŒBuildx å®¢æˆ·ç«¯ä¼šå‘ BuildKit åç«¯å‘é€æ„å»ºè¯·æ±‚ã€‚BuildKit è§£ææ„å»ºæŒ‡ä»¤å¹¶æ‰§è¡Œæ„å»ºæ­¥éª¤ã€‚æ„å»ºè¾“å‡ºè¦ä¹ˆå‘é€å›å®¢æˆ·ç«¯ï¼Œè¦ä¹ˆä¸Šä¼ åˆ°ä»“åº“ï¼Œä¾‹å¦‚ Docker Hubã€‚ Buildx å’Œ BuildKit éƒ½æ˜¯éš Docker Desktop å’Œ Docker Engine ä¸€èµ·å®‰è£…çš„ï¼Œå¼€ç®±å³ç”¨ã€‚å½“æ‚¨è°ƒç”¨ docker build å‘½ä»¤æ—¶ï¼Œæ‚¨æ­£åœ¨ä½¿ç”¨ Buildx å’Œ BuildKit è¿›è¡Œæ„å»ºã€‚BuildxBuildx æ˜¯æ‚¨ç”¨æ¥è¿è¡Œæ„å»ºçš„ CLI å·¥å…·ã€‚docker build å‘½ä»¤æ˜¯ Buildx çš„åŒ…è£…å™¨ã€‚å½“æ‚¨è°ƒç”¨ docker build æ—¶ï¼ŒBuildx ä¼šè§£é‡Šæ„å»ºé€‰é¡¹å¹¶å‘ BuildKit åç«¯å‘é€æ„å»ºè¯·æ±‚ã€‚ Buildx å®¢æˆ·ç«¯å¯ä»¥åšçš„ä¸ä»…ä»…æ˜¯æ„å»ºã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨ Buildx åˆ›å»ºå’Œç®¡ç† BuildKit åç«¯ï¼ˆç§°ä¸ºæ„å»ºå™¨ï¼‰ã€‚å®ƒè¿˜æ”¯æŒç®¡ç†ä»“åº“ä¸­çš„æ˜ åƒä»¥åŠåŒæ—¶è¿è¡Œå¤šä¸ªæ„å»ºçš„åŠŸèƒ½ã€‚ Docker Buildx é»˜è®¤éš Docker Desktop ä¸€èµ·å®‰è£…ã€‚æ‚¨è¿˜å¯ä»¥ä»æºä»£ç æ„å»º CLI æ’ä»¶ï¼Œæˆ–è€…ä» GitHub å­˜å‚¨åº“ä¸­è·å–äºŒè¿›åˆ¶æ–‡ä»¶å¹¶æ‰‹åŠ¨å®‰è£…ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… GitHub ä¸Šçš„ Buildx READMEã€‚è™½ç„¶ docker build åœ¨åå°è°ƒç”¨ Buildxï¼Œä½†æ­¤å‘½ä»¤ä¸è§„èŒƒçš„ docker buildx build ä¹‹é—´å­˜åœ¨ç»†å¾®å·®åˆ«ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… docker build å’Œ docker buildx build ä¹‹é—´çš„åŒºåˆ«ã€‚BuildKitä¸€æ¬¡æ„å»ºä»è°ƒç”¨ docker build å‘½ä»¤å¼€å§‹ã€‚Buildx è§£é‡Šæ‚¨çš„æ„å»ºå‘½ä»¤å¹¶å‘ BuildKit åç«¯å‘é€æ„å»ºè¯·æ±‚ã€‚æ„å»ºè¯·æ±‚åŒ…æ‹¬ï¼šThe Dockerfile Build arguments Export options Caching options BuildKit è§£ææ„å»ºæŒ‡ä»¤å¹¶æ‰§è¡Œæ„å»ºæ­¥éª¤ã€‚åœ¨ BuildKit æ‰§è¡Œæ„å»ºæ—¶ï¼ŒBuildx ä¼šç›‘æ§æ„å»ºçŠ¶æ€å¹¶å°†è¿›åº¦æ‰“å°åˆ°ç»ˆç«¯ã€‚ å¦‚æœæ„å»ºéœ€è¦æ¥è‡ªå®¢æˆ·ç«¯çš„èµ„æºï¼ˆä¾‹å¦‚æœ¬åœ°æ–‡ä»¶æˆ–æ„å»ºæœºå¯†ï¼‰ï¼ŒBuildKit ä¼šä» Buildx è¯·æ±‚æ‰€éœ€çš„èµ„æºã€‚ä¸æ—©æœŸç‰ˆæœ¬çš„ Docker ä¸­ä½¿ç”¨çš„æ—§æ„å»ºå™¨ç›¸æ¯”ï¼Œè¿™æ˜¯ BuildKit æ›´é«˜æ•ˆçš„ä¸€ç§æ–¹å¼ã€‚BuildKit ä»…åœ¨éœ€è¦æ—¶è¯·æ±‚æ„å»ºæ‰€éœ€çš„èµ„æºã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œæ—§æ„å»ºå™¨å§‹ç»ˆè·å–æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿçš„å‰¯æœ¬ã€‚ BuildKit å¯ä»¥ä» Buildx è¯·æ±‚çš„èµ„æºç¤ºä¾‹åŒ…æ‹¬ï¼šLocal filesystem build contexts Build secrets SSH sockets Registry authentication tokens Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-04-02 "},"doc_docker/dockerfile_overview.html":{"url":"doc_docker/dockerfile_overview.html","title":"Dockerfile æ¦‚è§ˆ","keywords":"","body":" Dockerfile æ¦‚è§ˆ Dockerfile Filename Docker images Example Dockerfile syntax Base image Environment setup Comments Installing dependencies Copying files Setting environment variables Exposed ports Starting the application Building Dockerfile æ¦‚è§ˆDockerfileä¸€åˆ‡éƒ½ä» Dockerfile å¼€å§‹ã€‚Docker é€šè¿‡è¯»å– Dockerfile ä¸­çš„æŒ‡ä»¤æ¥æ„å»ºé•œåƒã€‚Dockerfile æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æ„å»ºæºä»£ç çš„æŒ‡ä»¤ã€‚Dockerfile æŒ‡ä»¤è¯­æ³•ç”± Dockerfile Reference ä¸­çš„è§„èŒƒå®šä¹‰ã€‚ä»¥ä¸‹æ˜¯æœ€å¸¸è§çš„æŒ‡ä»¤ç±»å‹ï¼š æŒ‡ä»¤ æè¿° `FROM ` ä¸ºä½ çš„é•œåƒå®šä¹‰ä¸€ä¸ªåŸºç¡€é•œåƒ `RUN ` åœ¨å½“å‰é•œåƒä¹‹ä¸Šçš„æ–°å±‚æ‰§è¡Œå‘½ä»¤å¹¶æäº¤ç»“æ„ï¼Œ`RUN` è¿˜å…·æœ‰è¿è¡Œå‘½ä»¤çš„ Shell å½¢å¼ `WORKDIR ` ç»™è¯¥æŒ‡ä»¤åçš„ä»»æ„æŒ‡ä»¤å¦‚ `RUN`ã€`CMD`ã€`ENTRYPOINT`ã€`COPY`ã€`ADD` ç­‰è®¾ç½®å·¥ä½œç›®å½• `COPY ` æ‹·è´ `` æ–‡ä»¶æˆ–ç›®å½•åˆ°å®¹å™¨çš„æ–‡ä»¶ç³»ç»Ÿè·¯å¾„ `` `CMD ` æŒ‡å®šå®¹å™¨çš„é»˜è®¤è¿è¡Œç¨‹åºï¼Œå­˜åœ¨å¤šä¸ªæ—¶åªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆ Dockerfile æ˜¯é•œåƒæ„å»ºçš„å…³é”®è¾“å…¥ï¼Œå¯ä»¥æ ¹æ®æ‚¨çš„ç‹¬ç‰¹é…ç½®ä¿ƒè¿›è‡ªåŠ¨åŒ–ã€å¤šå±‚é•œåƒæ„å»ºã€‚Dockerfile å¯ä»¥ä»ç®€å•å¼€å§‹ï¼Œå¹¶æ ¹æ®æ‚¨çš„éœ€æ±‚æ‰©å±•ä»¥æ”¯æŒæ›´å¤æ‚çš„åœºæ™¯ã€‚FilenameDockerfile çš„é»˜è®¤æ–‡ä»¶åå°±æ˜¯ Dockerfileï¼Œä¸åŠ åç¼€å¯ä»¥è®© docker build æŒ‡ä»¤ç›´æ¥è¯†åˆ«ã€‚ å¦‚æœæ„å»ºå¤æ‚ï¼Œä¸€èˆ¬ä½¿ç”¨ .Dockerfile çš„æ–¹å¼å‘½åï¼Œå¹¶ç”¨ --file æ ‡è®°æ¥æŒ‡å®šæ–‡ä»¶ã€‚å»ºè®®ç»™å·¥ç¨‹æœ€ä¸»è¦çš„ Dockerfile å‘½åæˆ Dockerfileã€‚Docker imagesDocker é•œåƒç”±å±‚ç»„æˆã€‚æ¯ä¸€å±‚éƒ½æ˜¯ Dockerfile ä¸­æ„å»ºæŒ‡ä»¤çš„ç»“æœã€‚å±‚æŒ‰é¡ºåºå †å ï¼Œæ¯ä¸€å±‚éƒ½æ˜¯ä¸€ä¸ªå¢é‡ï¼Œè¡¨ç¤ºåº”ç”¨äºä¸Šä¸€å±‚çš„æ›´æ”¹ã€‚Example# syntax=docker/dockerfile:1 FROM ubuntu:22.04 # install app dependencies RUN apt-get update && apt-get install -y python3 python3-pip RUN pip install flask==3.0.* # install app COPY hello.py / # final configuration ENV FLASK_APP=hello EXPOSE 8000 CMD [\"flask\", \"run\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"] Dockerfile syntaxæŒ‡å®š dockfile è§£æç‰ˆæœ¬# syntax=docker/dockerfile:1 ç¬¬ä¸€è¡ŒæŒ‡å®šäº†ä½¿ç”¨ä¸»ç‰ˆæœ¬æ˜¯1çš„dockerfileè§£æå™¨ï¼Œå®ƒå®é™…æ˜¯ä¸€ä¸ªå­˜å‚¨åœ¨ Docker Hub ä¸Šçš„è½»é‡çº§é•œåƒï¼ˆç±»ä¼¼æ’ä»¶ï¼‰ï¼ŒåŒ…å«äº†è§£æ Dockerfile çš„å·¥å…·é“¾ã€‚æ„å»ºæ—¶ï¼ŒDocker ä¼šåŠ¨æ€åŠ è½½å®ƒã€‚å¯ä»¥æŸ¥çœ‹å®˜æ–¹é•œåƒæ ‡ç­¾é¡µç¡®å®šæœ€æ–°ç‰ˆæœ¬ã€‚å¦‚æœä¸å†™è¿™ä¸€è¡Œï¼ŒDocker ä¼šé»˜è®¤ä½¿ç”¨å½“å‰å®‰è£…çš„ Docker å¼•æ“å†…ç½®çš„ Dockerfile è§£æå™¨æ¥æ„å»ºé•œåƒBase imageå£°æ˜äº† ubuntu çš„ 22.04 ç‰ˆæœ¬çš„é•œåƒFROM ubuntu:22.04 Environment setupå®‰è£…ä¾èµ–# install app dependencies RUN apt-get update && apt-get install -y python3 python3-pip Commentsæ³¨é‡Šè¡Œ# install app dependencies å›é¡¾ # syntax=docker/dockerfile:1ï¼Œæ³¨æ„åªæœ‰å‡ºç°åœ¨æ–‡ä»¶å¼€å¤´ï¼Œå¹¶ä¸”ä½¿ç”¨äº† syntax directive çš„è¡Œä¸ä¼šè¢«å½“ä½œæ³¨é‡ŠInstalling dependencieså®‰è£…ä¾èµ–RUN pip install flask==3.0.* Copying filesæ‹·è´æ–‡ä»¶åˆ°å®¹å™¨COPY hello.py / Setting environment variablesè®¾ç½®ç¯å¢ƒå˜é‡ENV FLASK_APP=hello Exposed portsæš´éœ²ç«¯å£EXPOSE 8000 è¿™åªæ˜¯ä¸€ä¸ªå£°æ˜ï¼Œå¹¶éå¼ºåˆ¶è¦æ±‚ã€‚å³ä½¿ä¸å†™ï¼Œä¹Ÿä¸å½±å“å®¹å™¨æš´éœ²ç«¯å£ã€‚ä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªè‰¯å¥½çš„è§„èŒƒï¼Œæ¯”å¦‚å†™äº†ä¹‹åæ–¹ä¾¿å…¶ä»–äººé€šè¿‡ docker inspect æŸ¥çœ‹è¯¥å®¹å™¨å¯èƒ½æš´éœ²çš„ç«¯å£Starting the applicationè¿è¡Œåº”ç”¨ï¼Œæ¨èä½¿ç”¨ç¬¬ä¸€ç§ï¼Œç¬¬ä¸€ç§ç›´æ¥è¿è¡Œ flaskï¼Œç¬¬äºŒç§ä½¿ç”¨ shell è¿è¡Œ flaskï¼Œå¯¼è‡´ä¸»è¿›ç¨‹ä¸æ˜¯ flaskï¼Œä¼šå½±å“ SIGTERM ç­‰ä¿¡å·ä¼ é€’CMD [\"flask\", \"run\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"] CMD flask run --host 0.0.0.0 --port 8000 Buildingdocker build -t test:latest . (.)ç”¨æ¥æŒ‡å®š build contextï¼Œå³ Dockerfile å’Œæ„å»ºæ‰€éœ€æ–‡ä»¶è·¯å¾„ã€‚æ„å»ºå®Œæˆåä½¿ç”¨ä¸‹åˆ—å‘½ä»¤å¯åŠ¨å®¹å™¨ï¼šdocker run -p 127.0.0.1:8000:8000 test:latest åœ¨ VSCode å®‰è£…æ‰©å±• Docker VS Code Extension (Beta) æ¥æ›´å¥½çš„ç¼–å†™ DockerfileCopyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-04-02 "},"doc_docker/cache.html":{"url":"doc_docker/cache.html","title":"åŠ é€Ÿ Golang ç¨‹åºæ„å»º","keywords":"","body":"Docker åŠ é€Ÿ Golang ç¨‹åºæ„å»ºæŒ‚è½½Goç¼–è¯‘ç¼“å­˜ï¼šé€šè¿‡--mount=type=cache,target=/root/.cache/go-buildï¼Œå°†å®¿ä¸»æœºçš„ç¼“å­˜ç›®å½•æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„/root/.cache/go-buildè·¯å¾„ä¸‹ã€‚è¿™å¯ä»¥åŠ å¿«Goä»£ç çš„ç¼–è¯‘é€Ÿåº¦ï¼Œå› ä¸ºGoç¼–è¯‘å™¨ä¼šåœ¨è¿™é‡Œå­˜æ”¾å·²ç»ç¼–è¯‘è¿‡çš„åŒ…çš„ç¼“å­˜ã€‚ æŒ‚è½½Goçš„pkgç¼“å­˜ï¼šé€šè¿‡--mount=type=cache,target=/go/pkgï¼Œè¿™ä¸ªæŒ‚è½½ç‚¹ä¸»è¦æ˜¯ç”¨æ¥å­˜å‚¨å·²ç»ä¸‹è½½çš„ä¾èµ–åŒ…ï¼Œä»è€Œåœ¨åç»­æ„å»ºè¿‡ç¨‹ä¸­å¦‚æœéœ€è¦ç›¸åŒçš„ä¾èµ–ç‰ˆæœ¬ï¼Œåˆ™ä¸éœ€è¦å†æ¬¡ä»ç½‘ç»œä¸‹è½½ã€‚ # ç¼“å­˜ä¾èµ– & æ‰“åŒ… RUN --mount=type=cache,target=/root/.cache/go-build \\ --mount=type=cache,target=/go/pkg \\ go build . Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_docker/multi_arch.html":{"url":"doc_docker/multi_arch.html","title":"æ”¯æŒè¿è¡Œä¸åŒæ¶æ„å®¹å™¨","keywords":"","body":" Docker æ”¯æŒè¿è¡Œä¸åŒæ¶æ„å®¹å™¨ å®‰è£… qemu æ³¨å†Œ qemu æ£€æŸ¥å®‰è£… Docker æ”¯æŒè¿è¡Œä¸åŒæ¶æ„å®¹å™¨å®‰è£… qemusudo apt-get update sudo apt-get install -y qemu-user-static binfmt-support qemu-user-static æ˜¯ä¸€ä¸ªç”¨äºåœ¨ Linux ç³»ç»Ÿä¸Šè¿è¡Œéæœ¬æœºæ¶æ„ï¼ˆcross-architectureï¼‰äºŒè¿›åˆ¶æ–‡ä»¶çš„å·¥å…·ã€‚å®ƒæ˜¯ QEMUï¼ˆQuick Emulatorï¼‰çš„ä¸€éƒ¨åˆ†ï¼Œä¸“æ³¨äºç”¨æˆ·æ€æ¨¡æ‹Ÿï¼ˆuser-mode emulationï¼‰ï¼Œå…è®¸ä½ åœ¨ä¸€ä¸ªæ¶æ„çš„ç³»ç»Ÿä¸Šè¿è¡Œå¦ä¸€ç§æ¶æ„çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œæ— éœ€å®Œæ•´çš„è™šæ‹Ÿæœºæˆ–ç³»ç»Ÿçº§æ¨¡æ‹Ÿã€‚binfmt-support æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† Linux å†…æ ¸ binfmt_misc æ¨¡å—çš„å·¥å…·ï¼Œä¸»è¦ç”¨äºæ”¯æŒè¿è¡Œéæœ¬æœºæ¶æ„çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚å®ƒåœ¨è·¨æ¶æ„å®¹å™¨è¿è¡Œï¼ˆå¦‚ Dockerï¼‰å’Œå¼€å‘æµ‹è¯•ä¸­éå¸¸æœ‰ç”¨ã€‚é€šè¿‡ç»“åˆ QEMU æ¨¡æ‹Ÿå™¨ï¼Œå®ƒå¯ä»¥å®ç°æ— ç¼çš„å¤šæ¶æ„æ”¯æŒã€‚æ³¨å†Œ qemudocker run --rm --privileged multiarch/qemu-user-static --reset -p yes æ£€æŸ¥å®‰è£…docker buildx inspect --bootstrap | grep Platforms å¯ä»¥çœ‹åˆ°æ”¯æŒäº†ä»¥ä¸‹æ¶æ„:Platforms: linux/amd64, linux/amd64/v2, linux/amd64/v3, linux/amd64/v4, linux/arm64, linux/riscv64, linux/ppc64le, linux/s390x, linux/386, linux/mips64le, linux/mips64, linux/arm/v7, linux/arm/v6 æˆ–è€…å¯ä»¥åœ¨ docker builds ç•Œé¢çœ‹åˆ°æ”¯æŒçš„æ¶æ„ Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_web/":{"url":"doc_web/","title":"Web","keywords":"","body":"Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-17 "},"doc_web/cat.html":{"url":"doc_web/cat.html","title":"çŒ«çŒ«ç½‘é¡µ","keywords":"","body":" çŒ«çŒ«ç½‘é¡µ index.html çŒ«çŒ«ç½‘é¡µindex.html CatPhotoApp CatPhotoApp Cat Photos Everyone loves cute cats online! See more cat photos in our gallery. Cat Lists Things cats love: catnip laser pointers lasagna Cats love lasagna. Top 3 things cats hate: flea treatment thunder other cats Cats hate other cats. Cat Form Is your cat an indoor or outdoor cat? Indoor Outdoor What's your cat's personality? Loving Lazy Energetic Submit No Copyright - freeCodeCamp.org Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-25 "},"doc_web/cafe.html":{"url":"doc_web/cafe.html","title":"å’–å•¡èœå•","keywords":"","body":" å’–å•¡èœå• index.html styles.css å’–å•¡èœå•index.html Cafe Menu CAMPER CAFE Est. 2020 Coffee French Vanilla 3.00 Caramel Macchiato 3.75 Pumpkin Spice 3.50 Hazelnut 4.00 Mocha 4.50 Desserts Donut 1.50 Cherry Pie 2.75 Cheesecake 3.00 Cinnamon Roll 2.50 Visit our website 123 Free Code Camp Drive styles.cssbody { background-image: url(https://cdn.freecodecamp.org/curriculum/css-cafe/beans.jpg); font-family: sans-serif; padding: 20px; } h1 { font-size: 40px; margin-top: 0; margin-bottom: 15px; } h2 { font-size: 30px; } .established { font-style: italic; } h1, h2, p { text-align: center; } .menu { width: 80%; background-color: burlywood; margin-left: auto; margin-right: auto; padding: 20px; max-width: 500px; } img { display: block; margin-left: auto; margin-right: auto; margin-top: -25px; } hr { height: 2px; background-color: brown; border-color: brown; } .bottom-line { margin-top: 25px; } h1, h2 { font-family: Impact, serif; } .item p { display: inline-block; margin-top: 5px; margin-bottom: 5px; font-size: 18px; } .flavor, .dessert { text-align: left; width: 75%; } .price { text-align: right; width: 24%; } /* FOOTER */ footer { font-size: 14px; } .address { margin-bottom: 5px; } a { color: black; } a:visited { color: black; } a:hover { color: brown; } a:active { color: brown; } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-25 "},"doc_web/markers.html":{"url":"doc_web/markers.html","title":"é¢œæ–™ç¬”","keywords":"","body":" é¢œæ–™ç¬” index.html styles.css é¢œæ–™ç¬”index.html Colored Markers CSS Color Markers styles.cssh1 { text-align: center; } .container { background-color: rgb(255, 255, 255); padding: 10px 0; } .marker { width: 200px; height: 25px; margin: 10px auto; } .cap { width: 60px; height: 25px; } .sleeve { width: 110px; height: 25px; background-color: rgba(255, 255, 255, 0.5); border-left: 10px double rgba(0, 0, 0, 0.75); } .cap, .sleeve { display: inline-block; } .red { background: linear-gradient(rgb(122, 74, 14), rgb(245, 62, 113), rgb(162, 27, 27)); box-shadow: 0 0 20px 0 rgba(83, 14, 14, 0.8); } .green { background: linear-gradient(#55680D, #71F53E, #116C31); box-shadow: 0 0 20px 0 #3B7E20CC; } .blue { background: linear-gradient(hsl(186, 76%, 16%), hsl(223, 90%, 60%), hsl(240, 56%, 42%)); box-shadow: 0 0 20px 0 hsla(223, 59%, 31%, 0.8); } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-25 "},"doc_web/registration.html":{"url":"doc_web/registration.html","title":"æ³¨å†Œé¡µé¢","keywords":"","body":" æ³¨å†Œé¡µé¢ index.html styles.css æ³¨å†Œé¡µé¢index.html Registration Form Registration Form Please fill out this form with the required information Enter Your First Name: Enter Your Last Name: Enter Your Email: Create a New Password: Account type (required) Personal Business Upload a profile picture: Input your age (years): How did you hear about us? (select one) freeCodeCamp News freeCodeCamp YouTube Channel freeCodeCamp Forum Other Provide a bio: I accept the terms and conditions styles.cssbody { width: 100%; height: 100vh; margin: 0; background-color: #1b1b32; color: #f5f6f7; font-family: Tahoma; font-size: 16px; } h1, p { margin: 1em auto; text-align: center; } form { width: 60vw; max-width: 500px; min-width: 300px; margin: 0 auto; padding-bottom: 2em; } fieldset { border: none; padding: 2rem 0; border-bottom: 3px solid #3b3b4f; } fieldset:last-of-type { border-bottom: none; } label { display: block; margin: 0.5rem 0; } input, textarea, select { margin: 10px 0 0 0; width: 100%; min-height: 2em; } input, textarea { background-color: #0a0a23; border: 1px solid #0a0a23; color: #ffffff; } .inline { width: unset; margin: 0 0.5em 0 0; vertical-align: middle; } input[type=\"submit\"] { display: block; width: 60%; margin: 1em auto; height: 2em; font-size: 1.1rem; background-color: #3b3b4f; border-color: white; min-width: 300px; } input[type=\"file\"] { padding: 1px 2px; } a { color: #dfdfe2; } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-25 "},"doc_web/box.html":{"url":"doc_web/box.html","title":"ç›’æ¨¡å‹","keywords":"","body":" ç›’æ¨¡å‹ index.html styles.css ç›’æ¨¡å‹ index.html Rothko Painting styles.css.canvas { width: 500px; height: 600px; background-color: #4d0f00; overflow: hidden; filter: blur(2px); } .frame { border: 50px solid black; width: 500px; padding: 50px; margin: 20px auto; } .one { width: 425px; height: 150px; background-color: #efb762; margin: 20px auto; box-shadow: 0 0 3px 3px #efb762; border-radius: 9px; transform: rotate(-0.6deg); } .two { width: 475px; height: 200px; background-color: #8f0401; margin: 0 auto 20px; box-shadow: 0 0 3px 3px #8f0401; border-radius: 8px 10px; transform: rotate(0.4deg); } .one, .two { filter: blur(1px); } .three { width: 91%; height: 28%; background-color: #b20403; margin: auto; filter: blur(2px); box-shadow: 0 0 5px 5px #b20403; border-radius: 30px 25px 60px 12px; transform: rotate(-0.2deg); } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-26 "},"doc_web/flexbox.html":{"url":"doc_web/flexbox.html","title":"å¼¹æ€§ç›’æ¨¡å‹","keywords":"","body":" å¼¹æ€§ç›’æ¨¡å‹ index.html styles.css å¼¹æ€§ç›’æ¨¡å‹index.html Photo Gallery css flexbox photo gallery styles.css* { box-sizing: border-box; } body { margin: 0; font-family: sans-serif; background: #f5f6f7; } .header { text-align: center; text-transform: uppercase; padding: 32px; background-color: #0a0a23; color: #fff; border-bottom: 4px solid #fdb347; } .gallery { display: flex; flex-direction: row; flex-wrap: wrap; justify-content: center; align-items: center; gap: 16px; max-width: 1400px; margin: 0 auto; padding: 20px 10px; } .gallery img { width: 100%; max-width: 350px; height: 300px; object-fit: cover; border-radius: 10px; } .gallery::after { content: \"\"; width: 350px; } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-25 "},"doc_web/nutrition.html":{"url":"doc_web/nutrition.html","title":"è¥å…»è¡¨","keywords":"","body":" è¥å…»è¡¨ index.html styles.css è¥å…»è¡¨index.html Nutrition Label Nutrition Facts 8 servings per container Serving size 2/3 cup (55g) Amount per serving Calories 230 % Daily Value * Total Fat 8g 10% Saturated Fat 1g 5% Trans Fat 0g Cholesterol 0mg 0% Sodium 160mg 7% Total Carbohydrate 37g 13% Dietary Fiber 4g Total Sugars 12g Includes 10g Added Sugars 20% Protein 3g Vitamin D 2mcg 10% Calcium 260mg 20% Iron 8mg 45% Potassium 235mg 6% * The % Daily Value (DV) tells you how much a nutrient in a serving of food contributes to a daily diet. 2,000 calories a day is used for general nutrition advice. styles.css* { box-sizing: border-box; } html { font-size: 16px; } body { font-family: 'Open Sans', sans-serif; } .label { border: 2px solid black; width: 270px; margin: 20px auto; padding: 0 7px; } header h1 { text-align: center; margin: -4px 0; letter-spacing: 0.15px } p { margin: 0; display: flex; justify-content: space-between; } .divider { border-bottom: 1px solid #888989; margin: 2px 0; } .bold { font-weight: 800; } .large { height: 10px; } .large, .medium { background-color: black; border: 0; } .medium { height: 5px; } .small-text { font-size: 0.85rem; } .calories-info { display: flex; justify-content: space-between; align-items: flex-end; } .calories-info h2 { margin: 0; } .left-container p { margin: -5px -2px; font-size: 2em; font-weight: 700; } .calories-info span { margin: -7px -2px; font-size: 2.4em; font-weight: 700; } .right { justify-content: flex-end; } .indent { margin-left: 1em; } .double-indent { margin-left: 2em; } .daily-value p:not(.no-divider) { border-bottom: 1px solid #888989; } .note { font-size: 0.6rem; margin: 5px 0; padding: 0 8px; text-indent: -8px; } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-25 "},"doc_web/accessibility.html":{"url":"doc_web/accessibility.html","title":"æ— éšœç¢é˜…è¯»","keywords":"","body":" æ— éšœç¢é˜…è¯» index.html styles.css æ— éšœç¢é˜…è¯»index.html Accessibility Quiz HTML/CSS Quiz INFO HTML CSS Student Info Name: Email: Date of Birth: HTML Question1 The legend element represents a caption for the content of its parent fieldset element True False Question2 A label element nesting an input element is required to have a for attribute with the same value as the input's id True False CSS Can the CSS margin property accept negative values? Select an option Yes No Do you have any questions: Send freeCodeCamp San Francisco California USA styles.css/* å¹³æ»‘æ»šåŠ¨è®¾ç½®ï¼šä»…åœ¨ç”¨æˆ·æœªå¼€å¯\"å‡å°‘åŠ¨ç”»\"åå¥½æ—¶å¯ç”¨ */ @media (prefers-reduced-motion: no-preference) { * { scroll-behavior: smooth; /* å¯ç”¨å¹³æ»‘æ»šåŠ¨æ•ˆæœ */ } } /* å…¨å±€åŸºç¡€æ ·å¼ */ body { background: #f5f6f7; /* é¡µé¢èƒŒæ™¯è‰² */ color: #1b1b32; /* é»˜è®¤æ–‡å­—é¢œè‰² */ font-family: Helvetica; /* é»˜è®¤å­—ä½“ */ margin: 0; /* ç§»é™¤é»˜è®¤å¤–è¾¹è· */ } /* é¡µçœ‰æ ·å¼ */ header { width: 100%; /* å…¨å®½ */ height: 50px; /* å›ºå®šé«˜åº¦ */ background-color: #1b1b32; /* æ·±è‰²èƒŒæ™¯ */ display: flex; /* å¼¹æ€§å¸ƒå±€ */ justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */ align-items: center; /* å‚ç›´å±…ä¸­ */ top: 0; /* é¡¶éƒ¨å¯¹é½ */ } /* Logoæ ·å¼ */ #logo { width: max(10rem, 18vw); /* å“åº”å¼å®½åº¦ */ background-color: #0a0a23; /* LogoèƒŒæ™¯è‰² */ aspect-ratio: 35 / 4; /* å›ºå®šå®½é«˜æ¯” */ padding: 0.4rem; /* å†…è¾¹è· */ } /* ä¸»æ ‡é¢˜æ ·å¼ */ h1 { color: #f1be32; /* é‡‘è‰²æ–‡å­— */ font-size: min(5vw, 1.2em); /* å“åº”å¼å­—ä½“å¤§å° */ text-align: center; /* å±…ä¸­æ˜¾ç¤º */ } /* å¯¼èˆªæ å®¹å™¨ */ nav { width: 50%; /* å æ®50%å®½åº¦ */ max-width: 300px; /* æœ€å¤§å®½åº¦é™åˆ¶ */ height: 50px; /* ä¸headeråŒé«˜ */ } /* å¯¼èˆªèœå•åˆ—è¡¨ */ nav>ul { display: flex; /* å¼¹æ€§å¸ƒå±€ */ justify-content: space-evenly; /* å‡åŒ€åˆ†å¸ƒ */ flex-wrap: wrap; /* å…è®¸æ¢è¡Œ */ align-items: center; /* å‚ç›´å±…ä¸­ */ padding-inline-start: 0; /* ç§»é™¤é»˜è®¤å·¦å†…è¾¹è· */ margin-block: 0; /* ç§»é™¤é»˜è®¤å¤–è¾¹è· */ height: 100%; /* ç»§æ‰¿çˆ¶å…ƒç´ é«˜åº¦ */ } /* å¯¼èˆªèœå•é¡¹ */ nav>ul>li { color: #dfdfe2; /* æµ…è‰²æ–‡å­— */ margin: 0 0.2rem; /* å·¦å³å¤–è¾¹è· */ padding: 0.2rem; /* å†…è¾¹è· */ display: block; /* å—çº§æ˜¾ç¤º */ } /* å¯¼èˆªèœå•æ‚¬åœæ•ˆæœ */ nav>ul>li:hover { background-color: #dfdfe2; /* èƒŒæ™¯è‰²å˜åŒ– */ color: #1b1b32; /* æ–‡å­—é¢œè‰²å˜åŒ– */ cursor: pointer; /* é¼ æ ‡æŒ‡é’ˆå˜åŒ– */ } /* å¯¼èˆªé“¾æ¥æ ·å¼ */ li>a { color: inherit; /* ç»§æ‰¿çˆ¶å…ƒç´ é¢œè‰² */ text-decoration: none; /* ç§»é™¤ä¸‹åˆ’çº¿ */ } /* ä¸»å†…å®¹åŒºåŸŸ */ main { padding-top: 50px; /* é¡¶éƒ¨å†…è¾¹è·ï¼Œé˜²æ­¢è¢«headeré®æŒ¡ */ } /* å†…å®¹åŒºå—æ ·å¼ */ section { width: 80%; /* å®½åº¦å æ¯” */ margin: 0 auto 10px auto; /* æ°´å¹³å±…ä¸­ï¼Œåº•éƒ¨å¤–è¾¹è· */ max-width: 600px; /* æœ€å¤§å®½åº¦é™åˆ¶ */ } /* æ ‡é¢˜å­—ä½“è®¾ç½® */ h1, h2 { font-family: Verdana, Tahoma; /* æŒ‡å®šå­—ä½“ */ } /* äºŒçº§æ ‡é¢˜æ ·å¼ */ h2 { border-bottom: 4px solid #dfdfe2; /* åº•éƒ¨è¾¹æ¡† */ margin-top: 0px; /* ç§»é™¤é¡¶éƒ¨å¤–è¾¹è· */ padding-top: 60px; /* é¡¶éƒ¨å†…è¾¹è· */ } /* ä¿¡æ¯åŒºåŸŸæ ·å¼ */ .info { padding: 10px 0 0 5px; /* è‡ªå®šä¹‰å†…è¾¹è· */ } /* è¡¨å•è¡Œæ ·å¼ */ .formrow { margin-top: 30px; /* é¡¶éƒ¨å¤–è¾¹è· */ padding: 0px 15px; /* å·¦å³å†…è¾¹è· */ } /* è¾“å…¥æ¡†åŸºç¡€æ ·å¼ */ input { font-size: 1rem; /* æ ‡å‡†å­—ä½“å¤§å° */ } /* ä¿¡æ¯æ ‡ç­¾å’Œè¾“å…¥æ¡†å¸ƒå±€ */ .info label, .info input { display: inline-block; /* è¡Œå†…å—å¸ƒå±€ */ } /* ä¿¡æ¯è¾“å…¥æ¡†æ ·å¼ */ .info input { width: 50%; /* å®½åº¦å æ¯” */ text-align: left; /* æ–‡å­—å·¦å¯¹é½ */ } /* ä¿¡æ¯æ ‡ç­¾æ ·å¼ */ .info label { width: 10%; /* å®½åº¦å æ¯” */ min-width: 55px; /* æœ€å°å®½åº¦ */ text-align: right; /* æ–‡å­—å³å¯¹é½ */ } /* é—®é¢˜åŒºå—æ ·å¼ */ .question-block { text-align: left; /* æ–‡å­—å·¦å¯¹é½ */ display: block; /* å—çº§æ˜¾ç¤º */ width: 100%; /* å…¨å®½ */ margin-top: 20px; /* é¡¶éƒ¨å¤–è¾¹è· */ padding-top: 5px; /* é¡¶éƒ¨å†…è¾¹è· */ } /* ä¸‰çº§æ ‡é¢˜æ ·å¼ */ h3 { margin-top: 5px; /* é¡¶éƒ¨å¤–è¾¹è· */ padding-left: 15px; /* å·¦å†…è¾¹è· */ font-size: 1.375rem; /* å­—ä½“å¤§å° */ } /* ä¸‰çº§æ ‡é¢˜å‰ç¼€ */ h3::before { content: \"Question #\"; /* æ·»åŠ å‰ç¼€å†…å®¹ */ } /* é—®é¢˜æ ·å¼ */ .question { border: none; /* æ— è¾¹æ¡† */ padding-bottom: 0; /* åº•éƒ¨æ— å†…è¾¹è· */ } /* ç­”æ¡ˆåˆ—è¡¨æ ·å¼ */ .answers-list { list-style: none; /* ç§»é™¤åˆ—è¡¨æ ‡è®° */ padding: 0; /* ç§»é™¤å†…è¾¹è· */ } /* æŒ‰é’®æ ·å¼ */ button { display: block; /* å—çº§æ˜¾ç¤º */ margin: 40px auto; /* å¤–è¾¹è·è‡ªåŠ¨å±…ä¸­ */ width: 40%; /* å®½åº¦å æ¯” */ padding: 15px; /* å†…è¾¹è· */ font-size: 1.438rem; /* å­—ä½“å¤§å° */ background: #d0d0d5; /* èƒŒæ™¯è‰² */ border: 3px solid #3b3b4f; /* è¾¹æ¡†æ ·å¼ */ } /* é¡µè„šæ ·å¼ */ footer { background-color: #2a2a40; /* æ·±è‰²èƒŒæ™¯ */ display: flex; /* å¼¹æ€§å¸ƒå±€ */ justify-content: center; /* å†…å®¹å±…ä¸­ */ } /* é¡µè„šæ–‡å­—å’Œé“¾æ¥æ ·å¼ */ footer, footer a { color: #dfdfe2; /* æµ…è‰²æ–‡å­— */ } /* åœ°å€æ ·å¼ */ address { text-align: center; /* æ–‡å­—å±…ä¸­ */ padding: 0.3em; /* å†…è¾¹è· */ } /* å±å¹•é˜…è¯»å™¨ä¸“ç”¨æ ·å¼ï¼ˆéšè—å…ƒç´ ä½†å¯è¢«é˜…è¯»å™¨è¯»å–ï¼‰ */ .sr-only { position: absolute; /* ç»å¯¹å®šä½ */ width: 1px; /* æå°å®½åº¦ */ height: 1px; /* æå°é«˜åº¦ */ overflow: hidden; /* éšè—æº¢å‡º */ clip: rect(0, 0, 0, 0); /* è£å‰ªå…ƒç´  */ clip-path: inset(50%); /* è¿›ä¸€æ­¥è£å‰ª */ white-space: nowrap; /* é˜²æ­¢æ¢è¡Œ */ } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-26 "},"doc_web/balance.html":{"url":"doc_web/balance.html","title":"èµ„äº§è¡¨","keywords":"","body":" èµ„äº§è¡¨ index.html styles.css èµ„äº§è¡¨index.html Balance Sheet AcmeWidgetCorp Balance Sheet 2019 2020 2021 Assets 2019 2020 2021 Cash This is the cash we currently have on hand. $25 $30 $28 Checking Our primary transactional account. $54 $56 $53 Savings Funds set aside for emergencies. $500 $650 $728 Total Assets $579 $736 $809 Liabilities 2019 2020 2021 Loans The outstanding balance on our startup loan. $500 $250 $0 Expenses Annual anticipated expenses, such as payroll. $200 $300 $400 Credit The outstanding balance on our credit card. $50 $50 $75 Total Liabilities $750 $600 $475 Net Worth 2019 2020 2021 Total Net Worth $-171 $136 $334 styles.cssspan[class~=\"sr-only\"] { border: 0 !important; clip: rect(1px, 1px, 1px, 1px) !important; clip-path: inset(50%) !important; height: 1px !important; width: 1px !important; position: absolute !important; overflow: hidden !important; white-space: nowrap !important; padding: 0 !important; margin: -1px !important; } html { box-sizing: border-box; } body { font-family: sans-serif; color: #0a0a23; } h1 { max-width: 37.25rem; margin: 0 auto; padding: 1.5rem 1.25rem; } h1 .flex { display: flex; flex-direction: column-reverse; gap: 1rem; } h1 .flex span:first-of-type { font-size: 0.7em; } h1 .flex span:last-of-type { font-size: 1.2em; } section { max-width: 40rem; margin: 0 auto; border: 2px solid #d0d0d5; } #years { display: flex; justify-content: flex-end; position: sticky; z-index: 999; top: 0; background: #0a0a23; color: #fff; padding: 0.5rem calc(1.25rem + 2px) 0.5rem 0; margin: 0 -2px; } #years span[class] { font-weight: bold; width: 4.5rem; text-align: right; } .table-wrap { padding: 0 0.75rem 1.5rem 0.75rem; } table { border-collapse: collapse; border: 0; width: 100%; position: relative; margin-top: 3rem; } table caption { color: #356eaf; font-size: 1.3em; font-weight: normal; position: absolute; top: -2.25rem; left: 0.5rem; } tbody td { width: 100vw; min-width: 4rem; max-width: 4rem; } tbody th { width: calc(100% - 12rem); } tr[class=\"total\"] { border-bottom: 4px double #0a0a23; font-weight: bold; } tr[class=\"total\"] th { text-align: left; padding: 0.5rem 0 0.25rem 0.5rem; } tr.total td { text-align: right; padding: 0 0.25rem; } tr.total td:nth-of-type(3) { padding-right: 0.5rem; } tr.total:hover { background-color: #99c9ff; } td.current { font-style: italic; } tr.data { background-image: linear-gradient(to bottom, #dfdfe2 1.845rem, white 1.845rem); } tr.data th { text-align: left; padding-top: 0.3rem; padding-left: 0.5rem; } tr.data th .description { display: block; font-weight: normal; font-style: italic; padding: 1rem 0 0.75rem; margin-right: -13.5rem; } tr.data td { vertical-align: top; padding: 0.3rem 0.25rem 0; text-align: right; } tr.data td:last-of-type { padding-right: 0.5rem; } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-27 "},"doc_web/draw_cat.html":{"url":"doc_web/draw_cat.html","title":"ç”»çŒ«çŒ«","keywords":"","body":" ç”»çŒ«çŒ« index.html styles.css ç”»çŒ«çŒ«index.html fCC Cat Painting styles.css* { box-sizing: border-box; } body { background-color: #c9d2fc; } .cat-head { position: absolute; right: 0; left: 0; top: 0; bottom: 0; margin: auto; background: linear-gradient(#5e5e5e 85%, #45454f 100%); width: 205px; height: 180px; border: 1px solid #000; border-radius: 46%; } .cat-left-ear { position: absolute; top: -26px; left: -31px; z-index: 1; border-top-left-radius: 90px; border-top-right-radius: 10px; transform: rotate(-45deg); border-left: 35px solid transparent; border-right: 35px solid transparent; border-bottom: 70px solid #5e5e5e; } .cat-right-ear { position: absolute; top: -26px; left: 163px; z-index: 1; transform: rotate(45deg); border-top-left-radius: 90px; border-top-right-radius: 10px; border-left: 35px solid transparent; border-right: 35px solid transparent; border-bottom: 70px solid #5e5e5e; } .cat-left-inner-ear { position: absolute; top: 22px; left: -20px; border-top-left-radius: 90px; border-top-right-radius: 10px; border-bottom-right-radius: 40%; border-bottom-left-radius: 40%; border-left: 20px solid transparent; border-right: 20px solid transparent; border-bottom: 40px solid #3b3b4f; } .cat-right-inner-ear { position: absolute; top: 22px; left: -20px; border-top-left-radius: 90px; border-top-right-radius: 10px; border-bottom-right-radius: 40%; border-bottom-left-radius: 40%; border-left: 20px solid transparent; border-right: 20px solid transparent; border-bottom: 40px solid #3b3b4f; } .cat-left-eye { position: absolute; top: 54px; left: 39px; border-radius: 60%; transform: rotate(25deg); width: 30px; height: 40px; background-color: #000; } .cat-right-eye { position: absolute; top: 54px; left: 134px; border-radius: 60%; transform: rotate(-25deg); width: 30px; height: 40px; background-color: #000; } .cat-left-inner-eye { position: absolute; top: 8px; left: 2px; width: 10px; height: 20px; transform: rotate(10deg); background-color: #fff; border-radius: 60%; } .cat-right-inner-eye { position: absolute; top: 8px; left: 18px; transform: rotate(-5deg); width: 10px; height: 20px; background-color: #fff; border-radius: 60%; } .cat-nose { position: absolute; top: 108px; left: 85px; border-top-left-radius: 50%; border-bottom-right-radius: 50%; border-bottom-left-radius: 50%; transform: rotate(180deg); border-left: 15px solid transparent; border-right: 15px solid transparent; border-bottom: 20px solid #442c2c; } .cat-mouth div { width: 30px; height: 50px; border: 2px solid #000; border-radius: 190%/190px 150px 0 0; border-color: black transparent transparent transparent; } .cat-mouth-line-left { position: absolute; top: 88px; left: 74px; transform: rotate(170deg); } .cat-mouth-line-right { position: absolute; top: 88px; left: 91px; transform: rotate(165deg); } .cat-whiskers-left div { width: 40px; height: 1px; background-color: #000; } .cat-whiskers-right div { width: 40px; height: 1px; background-color: #000; } .cat-whisker-left-top { position: absolute; top: 120px; left: 52px; transform: rotate(10deg); } .cat-whisker-left-middle { position: absolute; top: 127px; left: 52px; transform: rotate(3deg); } .cat-whisker-left-bottom { position: absolute; top: 134px; left: 52px; transform: rotate(-3deg); } .cat-whisker-right-top { position: absolute; top: 120px; left: 109px; transform: rotate(-10deg); } .cat-whisker-right-middle { position: absolute; top: 127px; left: 109px; transform: rotate(-3deg); } .cat-whisker-right-bottom { position: absolute; top: 134px; left: 109px; transform: rotate(3deg); } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-04-02 "},"doc_web/piano.html":{"url":"doc_web/piano.html","title":"ç”»é’¢ç´","keywords":"","body":" é’¢ç´ index.html styles.css é’¢ç´index.html Piano styles.csshtml { box-sizing: border-box; } *, *::before, *::after { box-sizing: inherit; } #piano { background-color: #00471b; width: 992px; height: 290px; margin: 80px auto; padding: 90px 20px 0 20px; position: relative; border-radius: 10px; } .keys { background-color: #040404; width: 949px; height: 180px; padding-left: 2px; overflow: hidden; } .key { background-color: #ffffff; position: relative; width: 41px; height: 175px; margin: 2px; float: left; border-radius: 0 0 3px 3px; } .key.black--key::after { background-color: #1d1e22; content: \"\"; position: absolute; left: -18px; width: 32px; height: 100px; border-radius: 0 0 3px 3px; } .logo { width: 200px; position: absolute; top: 23px; } @media (max-width: 768px) { #piano { width: 358px; } .keys { width: 318px; } .logo { width: 150px; } } @media (max-width: 1199px) and (min-width: 769px) { #piano { width: 675px; } .keys { width: 633px; } .logo { width: 633px; } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-04-02 "},"doc_web/city.html":{"url":"doc_web/city.html","title":"åŸå¸‚å¤©é™…çº¿","keywords":"","body":" åŸå¸‚å¤©é™…çº¿ index.html styles.css åŸå¸‚å¤©é™…çº¿ index.html City Skyline styles.css:root { --building-color1: #aa80ff; --building-color2: #66cc99; --building-color3: #cc6699; --building-color4: #538cc6; --window-color1: #bb99ff; --window-color2: #8cd9b3; --window-color3: #d98cb3; --window-color4: #8cb3d9; } * { box-sizing: border-box; } body { height: 100vh; margin: 0; overflow: hidden; } .background-buildings, .foreground-buildings { width: 100%; height: 100%; display: flex; align-items: flex-end; justify-content: space-evenly; position: absolute; top: 0; } .building-wrap { display: flex; flex-direction: column; align-items: center; } .window-wrap { display: flex; align-items: center; justify-content: space-evenly; } .sky { background: radial-gradient( closest-corner circle at 15% 15%, #ffcf33, #ffcf33 20%, #ffff66 21%, #bbeeff 100% ); } /* BACKGROUND BUILDINGS - \"bb\" stands for \"background building\" */ .bb1 { width: 10%; height: 70%; } .bb1a { width: 70%; } .bb1b { width: 80%; } .bb1c { width: 90%; } .bb1d { width: 100%; height: 70%; background: linear-gradient( var(--building-color1) 50%, var(--window-color1) ); } .bb1-window { height: 10%; background: linear-gradient( var(--building-color1), var(--window-color1) ); } .bb2 { width: 10%; height: 50%; } .bb2a { border-bottom: 5vh solid var(--building-color2); border-left: 5vw solid transparent; border-right: 5vw solid transparent; } .bb2b { width: 100%; height: 100%; background: repeating-linear-gradient( var(--building-color2), var(--building-color2) 6%, var(--window-color2) 6%, var(--window-color2) 9% ); } .bb3 { width: 10%; height: 55%; background: repeating-linear-gradient( 90deg, var(--building-color3), var(--building-color3), var(--window-color3) 15% ); } .bb4 { width: 11%; height: 58%; } .bb4a { width: 3%; height: 10%; background-color: var(--building-color4); } .bb4b { width: 80%; height: 5%; background-color: var(--building-color4); } .bb4c { width: 100%; height: 85%; background-color: var(--building-color4); } .bb4-window { width: 18%; height: 90%; background-color: var(--window-color4); } /* FOREGROUND BUILDINGS - \"fb\" stands for \"foreground building\" */ .fb1 { width: 10%; height: 60%; } .fb1a { border-bottom: 7vh solid var(--building-color4); border-left: 2vw solid transparent; border-right: 2vw solid transparent; } .fb1b { width: 60%; height: 10%; background-color: var(--building-color4); } .fb1c { width: 100%; height: 80%; background: repeating-linear-gradient( 90deg, var(--building-color4), var(--building-color4) 10%, transparent 10%, transparent 15% ), repeating-linear-gradient( var(--building-color4), var(--building-color4) 10%, var(--window-color4) 10%, var(--window-color4) 90% ); } .fb2 { width: 10%; height: 40%; } .fb2a { width: 100%; border-bottom: 10vh solid var(--building-color3); border-left: 1vw solid transparent; border-right: 1vw solid transparent; } .fb2b { width: 100%; height: 75%; background-color: var(--building-color3); } .fb2-window { width: 22%; height: 100%; background-color: var(--window-color3); } .fb3 { width: 10%; height: 35%; } .fb3a { width: 80%; height: 15%; background-color: var(--building-color1); } .fb3b { width: 100%; height: 35%; background-color: var(--building-color1); } .fb3-window { width: 25%; height: 80%; background-color: var(--window-color1); } .fb4 { width: 8%; height: 45%; position: relative; left: 10%; } .fb4a { border-top: 5vh solid transparent; border-left: 8vw solid var(--building-color1); } .fb4b { width: 100%; height: 89%; background-color: var(--building-color1); display: flex; flex-wrap: wrap; } .fb4-window { width: 30%; height: 10%; border-radius: 50%; background-color: var(--window-color1); margin: 10%; } .fb5 { width: 10%; height: 33%; position: relative; right: 10%; background: repeating-linear-gradient( var(--building-color2), var(--building-color2) 5%, transparent 5%, transparent 10% ), repeating-linear-gradient( 90deg, var(--building-color2), var(--building-color2) 12%, var(--window-color2) 12%, var(--window-color2) 44% ); } .fb6 { width: 9%; height: 38%; background: repeating-linear-gradient( 90deg, var(--building-color3), var(--building-color3) 10%, transparent 10%, transparent 30% ), repeating-linear-gradient( var(--building-color3), var(--building-color3) 10%, var(--window-color3) 10%, var(--window-color3) 30% ); } @media (max-width: 1000px) { :root { --building-color1: #000; --building-color2: #000; --building-color3: #000; --building-color4: #000; } .sky { background: radial-gradient( closest-corner circle at 15% 15%, #ccc, #ccc 20%, #445 21%, #223 100% ); } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-04-02 "},"doc_web/magazine.html":{"url":"doc_web/magazine.html","title":"æ‚å¿—","keywords":"","body":" æ‚å¿— index.html styles.css æ‚å¿—index.html Magazine OUR NEW CURRICULUM Our efforts to restructure our curriculum with a more project-based focus By freeCodeCamp March 7, 2019 Soon the freeCodeCamp curriculum will be 100% project-driven learning. Instead of a series of coding challenges, you'll learn through building projects - step by step. Before we get into the details, let me emphasize: we are not changing the certifications. All 6 certifications will still have the same 5 required projects. We are only changing the optional coding challenges. After years - years - of pondering these two problems and how to solve them, I slipped, hit my head on the sink, and when I came to I had a revelation! A vision! A picture in my head! A picture of this! This is what makes time travel possible: the flux capacitor! It wasn't as dramatic as Doc's revelation in Back to the Future. It just occurred to me while I was going for a run. The revelation: the entire curriculum should be a series of projects. Instead of individual coding challenges, we'll just have projects, each with their own seamless series of tests. Each test gives you just enough information to figure out how to get it to pass. (And you can view hints if that isn't enough.) The entire curriculum should be a series of projects No more walls of explanatory text. No more walls of tests. Just one test at a time, as you build up a working project. Over the course of passing thousands of tests, you build up projects and your own understanding of coding fundamentals. There is no transition between lessons and projects, because the lessons themselves are baked into projects. And there's plenty of repetition to help you retain everything because - hey - building projects in real life has plenty of repetition. The main design challenge is taking what is currently paragraphs of explanation and instructions and packing them into a single test description text. Each project will involve dozens of tests like this. People will be coding the entire time, rather than switching back and forth from \"reading mode\" to \"coding mode\". Instead of a series of coding challenges, people will be in their code editor passing one test after another, quickly building up a project. People will get into a real flow state, similar to what they experience when they build the required projects at the end of each certification. They'll get that sense of forward progress right from the beginning. And freeCodeCamp will be a much smoother experience. A Brief History Of the Curriculum V1 - 2014 We launched freeCodeCamp with a simple list of 15 resources, including Harvard's CS50 and Stanford's Database Class. V2 - 2015 We added interactive algorithm challenges. V3 - 2015 We added our own HTML+CSS challenges (before we'd been relying on General Assembly's Dash course for these). V4 - 2016 We expanded the curriculum to 3 certifications, including Front End, Back End, and Data Visualization. They each had 10 required projects, but only the Front End section had its own challenges. For the other certs, we were still using external resources like Node School. V5 - 2017 We added the back end and data visualization challenges. V6 - 2018 We launched 6 new certifications to replace our old ones. This was the biggest curriculum improvement to date. The millions of people who are learning to code through freeCodeCamp will have an even better resource to help them learn these fundamentals. styles.css*, ::before, ::after { padding: 0; margin: 0; box-sizing: border-box; } html { font-size: 62.5%; } body { font-family: 'Baskervville', serif; color: linen; background-color: rgb(20, 30, 40); } h1 { font-family: 'Anton', sans-serif; } h2, h3, h4, h5, h6 { font-family: 'Raleway', sans-serif; } a { text-decoration: none; color: linen; } main { display: grid; grid-template-columns: minmax(2rem, 1fr) minmax(min-content, 94rem) minmax(2rem, 1fr); row-gap: 3rem; } img { width: 100%; object-fit: cover; } hr { margin: 1.5rem 0; border: 1px solid rgba(120, 120, 120, 0.6); } .heading { grid-column: 2 / 3; display: grid; grid-template-columns: repeat(2, 1fr); row-gap: 1.5rem; } .text { grid-column: 2 / 3; font-size: 1.8rem; letter-spacing: 0.6px; column-width: 25rem; text-align: justify; } .hero { grid-column: 1 / -1; position: relative; } .hero-title { text-align: center; color: orangered; font-size: 8rem; } .hero-subtitle { font-size: 2.4rem; color: orangered; text-align: center; } .author { font-size: 2rem; font-family: \"Raleway\", sans-serif; } .author-name a:hover { background-color: #306203; } .publish-date { color: rgba(255, 255, 255, 0.5); } .social-icons { display: grid; font-size: 3rem; grid-template-columns: repeat(5, 1fr); grid-auto-flow: column; grid-auto-columns: 1fr; align-items: center; } .first-paragraph::first-letter { font-size: 6rem; color: orangered; float: left; margin-right: 1rem; } .quote { color: #00beef; font-size: 2.4rem; text-align: center; font-family: \"Raleway\", sans-serif; } .quote::before { content: '\" '; } .quote::after { content: ' \"'; } .text-with-images { display: grid; grid-template-columns: 1fr 2fr; column-gap: 3rem; margin-bottom: 3rem; } .lists { list-style-type: none; margin-top: 2rem; } .lists li { margin-bottom: 1.5rem; } .list-title, .list-subtitle { color: #00beef; } .image-wrapper { display: grid; grid-template-columns: 2fr 1fr; grid-template-rows: repeat(3, min-content); gap: 2rem; place-items: center; } .image-1, .image-3 { grid-column: 1 / -1; } @media only screen and (max-width: 720px) { .image-wrapper { grid-template-columns: 1fr; } } @media only screen and (max-width: 600px) { .text-with-images { grid-template-columns: 1fr; } } @media only screen and (max-width: 550px) { .hero-title { font-size: 6rem; } .hero-subtitle, .author, .quote, .list-title { font-size: 1.8rem; } .social-icons { font-size: 2rem; } .text { font-size: 1.6rem; } } /* Extra Small Mobile (â‰¤420px) */ @media only screen and (max-width: 420px) { .hero-title { font-size: 4.5rem; /* Smaller but still impactful */ } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-17 "},"doc_web/ferris_wheel.html":{"url":"doc_web/ferris_wheel.html","title":"æ‘©å¤©è½®","keywords":"","body":" æ‘©å¤©è½® index.html styles.css æ‘©å¤©è½®index.html Ferris Wheel styles.css.wheel { border: 2px solid black; border-radius: 50%; margin-left: 50px; position: absolute; height: 55vw; width: 55vw; max-width: 500px; max-height: 500px; animation-name: wheel; animation-duration: 10s; animation-iteration-count: infinite; animation-timing-function: linear; } .line { background-color: black; width: 50%; height: 2px; position: absolute; top: 50%; left: 50%; transform-origin: 0% 0%; } .line:nth-of-type(2) { transform: rotate(60deg); } .line:nth-of-type(3) { transform: rotate(120deg); } .line:nth-of-type(4) { transform: rotate(180deg); } .line:nth-of-type(5) { transform: rotate(240deg); } .line:nth-of-type(6) { transform: rotate(300deg); } .cabin { background-color: red; width: 20%; height: 20%; position: absolute; border: 2px solid; transform-origin: 50% 0%; animation: cabins 10s ease-in-out infinite; } .cabin:nth-of-type(1) { right: -8.5%; top: 50%; } .cabin:nth-of-type(2) { right: 17%; top: 93.5%; } .cabin:nth-of-type(3) { right: 67%; top: 93.5%; } .cabin:nth-of-type(4) { left: -8.5%; top: 50%; } .cabin:nth-of-type(5) { left: 17%; top: 7%; } .cabin:nth-of-type(6) { right: 17%; top: 7%; } @keyframes wheel { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } @keyframes cabins { 0% { transform: rotate(0deg); } 25% { background-color: yellow; } 50% { background-color: purple; } 75% { background-color: yellow; } 100% { transform: rotate(-360deg); } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-17 "},"doc_web/penguin.html":{"url":"doc_web/penguin.html","title":"ä¼é¹…","keywords":"","body":" ä¼é¹… index.html styles.css ä¼é¹…index.html Penguin ğŸ’œ I CSS styles.css:root { --penguin-face: white; --penguin-picorna: orange; --penguin-skin: gray; } body { background: linear-gradient(45deg, rgb(118, 201, 255), rgb(247, 255, 222)); margin: 0; padding: 0; width: 100%; height: 100vh; overflow: hidden; } .left-mountain { width: 300px; height: 300px; background: linear-gradient(rgb(203, 241, 228), rgb(80, 183, 255)); position: absolute; transform: skew(0deg, 44deg); z-index: 2; margin-top: 100px; } .back-mountain { width: 300px; height: 300px; background: linear-gradient(rgb(203, 241, 228), rgb(47, 170, 255)); position: absolute; z-index: 1; transform: rotate(45deg); left: 110px; top: 225px; } .sun { width: 200px; height: 200px; background-color: yellow; position: absolute; border-radius: 50%; top: -75px; right: -75px; } .penguin { width: 300px; height: 300px; margin: auto; margin-top: 75px; z-index: 4; position: relative; transition: transform 1s ease-in-out 0ms; } .penguin * { position: absolute; } .penguin:active { transform: scale(1.5); cursor: not-allowed; } .penguin-head { width: 50%; height: 45%; background: linear-gradient(45deg, var(--penguin-skin), rgb(239, 240, 228)); border-radius: 70% 70% 65% 65%; top: 10%; left: 25%; z-index: 1; } .face { width: 60%; height: 70%; background-color: var(--penguin-face); border-radius: 70% 70% 60% 60%; top: 15%; } .face.left { left: 5%; } .face.right { right: 5%; } .chin { width: 90%; height: 70%; background-color: var(--penguin-face); top: 25%; left: 5%; border-radius: 70% 70% 100% 100%; } .eye { width: 15%; height: 17%; background-color: black; top: 45%; border-radius: 50%; } .eye.left { left: 25%; } .eye.right { right: 25%; } .eye-lid { width: 150%; height: 100%; background-color: var(--penguin-face); top: 25%; left: -23%; border-radius: 50%; } .blush { width: 15%; height: 10%; background-color: pink; top: 65%; border-radius: 50%; } .blush.left { left: 15%; } .blush.right { right: 15%; } .beak { height: 10%; background-color: var(--penguin-picorna); border-radius: 50%; } .beak.top { width: 20%; top: 60%; left: 40%; } .beak.bottom { width: 16%; top: 65%; left: 42%; } .shirt { font: bold 25px Helvetica, sans-serif; top: 165px; left: 127.5px; z-index: 1; color: #6a6969; } .shirt div { font-weight: initial; top: 22.5px; left: 12px; } .penguin-body { width: 53%; height: 45%; background: linear-gradient(45deg, rgb(134, 133, 133) 0%, rgb(234, 231, 231) 25%, white 67%); border-radius: 80% 80% 100% 100%; top: 40%; left: 23.5%; } .penguin-body::before { content: \"\"; position: absolute; width: 50%; height: 45%; background-color: var(--penguin-skin); top: 10%; left: 25%; border-radius: 0% 0% 100% 100%; opacity: 70%; } .arm { width: 30%; height: 60%; background: linear-gradient(90deg, var(--penguin-skin), rgb(209, 210, 199)); border-radius: 30% 30% 30% 120%; z-index: -1; } .arm.left { top: 35%; left: 5%; transform-origin: top left; transform: rotate(130deg) scaleX(-1); animation: 3s linear infinite wave; } .arm.right { top: 0%; right: -5%; transform: rotate(-45deg); } @keyframes wave { 10% { transform: rotate(110deg) scaleX(-1); } 20% { transform: rotate(130deg) scaleX(-1); } 30% { transform: rotate(110deg) scaleX(-1); } 40% { transform: rotate(130deg) scaleX(-1); } } .foot { width: 15%; height: 30%; background-color: var(--penguin-picorna); top: 85%; border-radius: 50%; z-index: -1; } .foot.left { left: 25%; transform: rotate(80deg); } .foot.right { right: 25%; transform: rotate(-80deg); } .ground { width: 100vw; background: linear-gradient(90deg, rgb(88, 175, 236), rgb(182, 255, 255)); z-index: 3; position: absolute; margin-top: -58px; height: calc(100vh - 300px); } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-17 "},"doc_influxdb/":{"url":"doc_influxdb/","title":"InfluxDB","keywords":"","body":" InfluxDB v1.11 æ–‡æ¡£å­¦ä¹ ç¬”è®° ä¸»è¦ç‰¹ç‚¹ å‚è€ƒèµ„æ–™ InfluxDB v1.11 æ–‡æ¡£å­¦ä¹ ç¬”è®°ä¸»è¦ç‰¹ç‚¹ä¸“ä¸ºæ—¶é—´åºåˆ—æ•°æ®ç¼–å†™çš„é«˜æ€§èƒ½æ•°æ®å­˜å‚¨ã€‚é«˜é€Ÿè¯»å–å’Œæ•°æ®å‹ç¼©ã€‚ ä¸ºæ‚¨çš„é›†ç¾¤æä¾›é«˜å¯ç”¨æ€§å¹¶æ¶ˆé™¤å•ç‚¹æ•…éšœã€‚ å®Œå…¨ç”¨ Go ç¼–å†™ã€‚ç¼–è¯‘ä¸ºå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ— ä»»ä½•å¤–éƒ¨ä¾èµ–ã€‚ ç®€å•ã€é«˜æ€§èƒ½çš„å†™å…¥å’ŒæŸ¥è¯¢ HTTP APIã€‚ æ’ä»¶æ”¯æŒå…¶ä»–æ•°æ®æå–åè®®ï¼Œä¾‹å¦‚ Graphiteã€collectd å’Œ OpenTSDBã€‚ å¯Œæœ‰è¡¨ç°åŠ›çš„ç±»ä¼¼ SQL çš„æŸ¥è¯¢è¯­è¨€ï¼Œç”¨äºè½»æ¾æŸ¥è¯¢èšåˆæ•°æ®ã€‚ è¿ç»­æŸ¥è¯¢ä¼šè‡ªåŠ¨è®¡ç®—èšåˆæ•°æ®ï¼Œä½¿é¢‘ç¹æŸ¥è¯¢æ›´åŠ é«˜æ•ˆã€‚ æ ‡ç­¾è®©æ‚¨å¯ä»¥ç´¢å¼•ç³»åˆ—ä»¥å®ç°å¿«é€Ÿé«˜æ•ˆçš„æŸ¥è¯¢ã€‚ ä¿ç•™ç­–ç•¥å¯ä»¥æœ‰æ•ˆåœ°è‡ªåŠ¨ä½¿é™ˆæ—§æ•°æ®è¿‡æœŸã€‚ å‚è€ƒèµ„æ–™https://docs.influxdata.com/enterprise_influxdb/v1/ Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-17 "},"doc_influxdb/concepts.html":{"url":"doc_influxdb/concepts.html","title":"æ¦‚å¿µ","keywords":"","body":"æ¦‚å¿µCopyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-18 "},"doc_influxdb/concepts_clustering.html":{"url":"doc_influxdb/concepts_clustering.html","title":"é›†ç¾¤","keywords":"","body":" InfluxDB é›†ç¾¤ æ¶æ„æ¦‚è¿° æ•°æ®å½’å± Meta èŠ‚ç‚¹ Data èŠ‚ç‚¹ æœ€ä½³æœåŠ¡å™¨æ•°é‡ Chronograf é›†ç¾¤ä¸­çš„å†™å…¥ åˆ†ç‰‡ç»„ å†™å…¥ä¸€è‡´æ€§ ç¼“å­˜é˜Ÿåˆ—ï¼ˆHinted handoffï¼‰ é›†ç¾¤ä¸­çš„æŸ¥è¯¢ InfluxDB é›†ç¾¤æ¶æ„æ¦‚è¿°InfluxDB Enterprise å®‰è£…åŒ…å«ä¸¤ç»„è½¯ä»¶è¿›ç¨‹ï¼šæ•°æ®èŠ‚ç‚¹å’Œå…ƒèŠ‚ç‚¹ã€‚é›†ç¾¤å†…çš„é€šä¿¡å¦‚ä¸‹æ‰€ç¤ºï¼š Meta æ•°æ®èŠ‚ç‚¹ä¹‹é—´é€šè¿‡ TCP åè®®å’Œ Raft å…±è¯†åè®®è¿›è¡Œé€šä¿¡ï¼Œé»˜è®¤ç«¯å£ 8089 Meta èŠ‚ç‚¹å…¬å¼€ 8091 ç«¯å£ç»™ influxd-ctl è°ƒç”¨ HTTP API Data èŠ‚ç‚¹é€šè¿‡TCP åè®®ç›¸äº’é€šä¿¡ï¼Œé»˜è®¤ç«¯å£ 8088 Data èŠ‚ç‚¹é€šè¿‡ Meta èŠ‚ç‚¹çš„ 8091 ç«¯å£çš„ HTTP API ä¸å…¶é€šä¿¡ åœ¨é›†ç¾¤å†…ï¼Œæ‰€æœ‰ Meta èŠ‚ç‚¹éƒ½å¿…é¡»ä¸æ‰€æœ‰å…¶å®ƒ Meta èŠ‚ç‚¹é€šä¿¡ã€‚æ‰€æœ‰ Data èŠ‚ç‚¹å¿…é¡»ä¸æ‰€æœ‰å…¶å®ƒ Data èŠ‚ç‚¹å’Œæ‰€æœ‰ Meta èŠ‚ç‚¹é€šä¿¡ æ•°æ®å½’å±Meta èŠ‚ç‚¹å…ƒèŠ‚ç‚¹ä¿å­˜ä»¥ä¸‹æ‰€æœ‰å…ƒæ•°æ®ï¼šé›†ç¾¤ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹åŠå…¶è§’è‰² é›†ç¾¤ä¸­å­˜åœ¨çš„æ‰€æœ‰æ•°æ®åº“å’Œä¿ç•™ç­–ç•¥ æ‰€æœ‰åˆ†ç‰‡å’Œåˆ†ç‰‡ç»„ï¼Œä»¥åŠå®ƒä»¬å­˜åœ¨äºå“ªäº›èŠ‚ç‚¹ä¸Š é›†ç¾¤ç”¨æˆ·åŠå…¶æƒé™ æ‰€æœ‰è¿ç»­æŸ¥è¯¢ å…ƒèŠ‚ç‚¹å°†è¿™äº›æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸Šçš„ Raft æ•°æ®åº“ä¸­ï¼Œè¯¥æ•°æ®åº“ç”± BoltDB æ”¯æŒã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒRaft æ•°æ®åº“æ˜¯ /var/lib/influxdb/meta/raft.dbã€‚å…ƒèŠ‚ç‚¹éœ€è¦/metaç›®å½•ã€‚Data èŠ‚ç‚¹æ•°æ®èŠ‚ç‚¹ä¿å­˜æ‰€æœ‰åŸå§‹æ—¶é—´åºåˆ—æ•°æ®å’Œå…ƒæ•°æ®ï¼ŒåŒ…æ‹¬ï¼šæµ‹é‡ æ ‡ç­¾é”®å’Œå€¼ å­—æ®µé”®å’Œå€¼ åœ¨ç£ç›˜ä¸Šï¼Œæ•°æ®å§‹ç»ˆæŒ‰// æ¥å­˜å‚¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œçˆ¶ç›®å½•æ˜¯ /var/lib/influxdb/dataã€‚ æ•°æ®èŠ‚ç‚¹éœ€è¦çš„æ‰€æœ‰å››ä¸ªå­ç›®å½• /var/lib/influxdb/ï¼ŒåŒ…æ‹¬/metaï¼ˆå…·ä½“æ¥è¯´ï¼Œclients.json æ–‡ä»¶ï¼‰/dataã€/walå’Œ/hhã€‚æœ€ä½³æœåŠ¡å™¨æ•°é‡åˆ›å»ºé›†ç¾¤æ—¶ï¼Œæ‚¨éœ€è¦ç¡®å®šè¦é…ç½®å’Œè¿æ¥å¤šå°‘ä¸ªå…ƒèŠ‚ç‚¹å’Œæ•°æ®èŠ‚ç‚¹ã€‚æ‚¨å¯ä»¥å°† InfluxDB Enterprise è§†ä¸ºä¸¤ä¸ªç›¸äº’é€šä¿¡çš„ç‹¬ç«‹é›†ç¾¤ï¼šä¸€ä¸ªå…ƒèŠ‚ç‚¹é›†ç¾¤å’Œä¸€ä¸ªæ•°æ®èŠ‚ç‚¹é›†ç¾¤ã€‚å…ƒèŠ‚ç‚¹çš„æ•°é‡å–å†³äºå®ƒä»¬éœ€è¦å¤„ç†çš„å…ƒèŠ‚ç‚¹æ•…éšœæ•°é‡ï¼Œè€Œæ•°æ®èŠ‚ç‚¹çš„æ•°é‡åˆ™æ ¹æ®æ‚¨çš„å­˜å‚¨å’ŒæŸ¥è¯¢éœ€æ±‚è¿›è¡Œæ‰©å±•ã€‚Raft å…±è¯†åè®®è¦æ±‚è¾¾åˆ°æ³•å®šäººæ•°æ‰èƒ½æ‰§è¡Œä»»ä½•æ“ä½œï¼Œå› æ­¤å…ƒèŠ‚ç‚¹æ•°é‡åº”å§‹ç»ˆä¸ºå¥‡æ•°ã€‚å¯¹äºå‡ ä¹æ‰€æœ‰åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œ3 ä¸ªå…ƒèŠ‚ç‚¹éƒ½æ˜¯ç†æƒ³çš„é€‰æ‹©ã€‚è¿™æ ·å¯ä»¥ä¿è¯å…ƒèŠ‚ç‚¹æ•°é‡ä¸ºå¥‡æ•°ï¼Œä»è€Œè¾¾åˆ°æ³•å®šäººæ•°ã€‚æ­¤å¤–ï¼Œå³ä½¿ä¸€ä¸ªå…ƒèŠ‚ç‚¹ä¸¢å¤±ï¼Œé›†ç¾¤ä»å¯ä½¿ç”¨å‰©ä½™çš„ä¸¤ä¸ªå…ƒèŠ‚ç‚¹è¿è¡Œï¼Œç›´åˆ°ç¬¬ä¸‰ä¸ªå…ƒèŠ‚ç‚¹è¢«æ›¿æ¢ã€‚é¢å¤–çš„å…ƒèŠ‚ç‚¹ä¼šæˆå€å¢åŠ é€šä¿¡å¼€é”€ï¼Œé™¤éæ‚¨é¢„è®¡é›†ç¾¤ä¼šé¢‘ç¹ä¸¢å¤±å…ƒèŠ‚ç‚¹ï¼Œå¦åˆ™ä¸å»ºè®®è¿™æ ·åšã€‚æ•°æ®èŠ‚ç‚¹ä¿å­˜å®é™…çš„æ—¶é—´åºåˆ—æ•°æ®ã€‚è¿è¡Œçš„æ•°æ®èŠ‚ç‚¹æ•°é‡è‡³å°‘ä¸º 1ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šæ‰©å±•ã€‚é€šå¸¸ï¼Œæ‚¨éœ€è¦è¿è¡Œçš„æ•°æ®èŠ‚ç‚¹æ•°é‡åº”èƒ½è¢«æ‚¨çš„å¤åˆ¶å› å­æ•´é™¤ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„å¤åˆ¶å› å­ä¸º 2ï¼Œåˆ™æ‚¨éœ€è¦è¿è¡Œ 2ã€4ã€6ã€8ã€10 ç­‰ä¸ªæ•°æ®èŠ‚ç‚¹ã€‚ChronografChronografæ˜¯ InfluxData TICK å †æ ˆçš„ç”¨æˆ·ç•Œé¢ç»„ä»¶ã€‚å®ƒä½¿æ‚¨èƒ½å¤Ÿè½»æ¾è®¾ç½®å’Œç»´æŠ¤åŸºç¡€æ¶æ„çš„ç›‘æ§å’Œè­¦æŠ¥ã€‚å®ƒé€šè¿‡ HTTP åè®®ç›´æ¥ä¸æ•°æ®èŠ‚ç‚¹å’Œå…ƒèŠ‚ç‚¹é€šä¿¡ï¼Œè¿™äº›åè®®é»˜è®¤ç»‘å®šåˆ°8086æ•°æ®èŠ‚ç‚¹çš„ç«¯å£å’Œå…ƒèŠ‚ç‚¹çš„ç«¯å£8091ã€‚é›†ç¾¤ä¸­çš„å†™å…¥æœ¬èŠ‚ä»‹ç»é›†ç¾¤ä¸­çš„å†™å…¥æ“ä½œã€‚æˆ‘ä»¬å°†ä½¿ç”¨åŒ…å«å››ä¸ªæ•°æ®èŠ‚ç‚¹ Aã€Bã€Cã€D çš„é›†ç¾¤è¿›è¡Œä¸€äº›ç¤ºä¾‹ã€‚å‡è®¾æˆ‘ä»¬çš„ä¿ç•™ç­–ç•¥ä¸ºå¤åˆ¶å› å­ 2ï¼Œåˆ†ç‰‡æŒç»­æ—¶é—´ä¸º 1 å¤©ã€‚åˆ†ç‰‡ç»„é›†ç¾¤ä¼šåœ¨åˆ†ç‰‡ç»„ä¸­åˆ›å»ºåˆ†ç‰‡ï¼Œä»¥æœ€å¤§åŒ–åˆ©ç”¨æ•°æ®èŠ‚ç‚¹çš„æ•°é‡ã€‚å¦‚æœé›†ç¾¤ä¸­æœ‰ N ä¸ªæ•°æ®èŠ‚ç‚¹ï¼Œä¸”å¤åˆ¶å› å­ä¸º Xï¼Œåˆ™æ¯ä¸ªåˆ†ç‰‡ç»„ä¸­ä¼šåˆ›å»º N/X ä¸ªåˆ†ç‰‡ï¼Œå¹¶ä¸¢å¼ƒå°æ•°éƒ¨åˆ†ã€‚è¿™æ„å‘³ç€æ¯å¤©å†™å…¥çš„æ•°æ®éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†ç‰‡ç»„ã€‚æ¯ä¸ªåˆ†ç‰‡ç»„å†…ä¼šåˆ›å»º 2 ä¸ªåˆ†ç‰‡ã€‚ç”±äºå¤åˆ¶å› å­ä¸º 2ï¼Œè¿™ä¸¤ä¸ªåˆ†ç‰‡ä¼šåˆ†åˆ«å¤åˆ¶åˆ° 2 å°æœåŠ¡å™¨ä¸Šã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª 2016-09-19 çš„åˆ†ç‰‡ç»„ï¼Œå…¶ä¸­åŒ…å« 1 å’Œ 2 ä¸¤ä¸ªåˆ†ç‰‡ã€‚åˆ†ç‰‡ 1 ä¼šå¤åˆ¶åˆ°æœåŠ¡å™¨ A å’Œ B ä¸Šï¼Œè€Œåˆ†ç‰‡ 2 ä¼šå¤åˆ¶åˆ°æœåŠ¡å™¨ C å’Œ Dä¸Šã€‚å½“ä¸€ä¸ªå¸¦æœ‰æ—¶é—´æˆ³çš„å†™å…¥å€¼ä¼ å…¥é›†ç¾¤æ—¶ï¼Œé›†ç¾¤å¿…é¡»é¦–å…ˆç¡®å®šåˆ†ç‰‡ç»„ä¸­çš„å“ªä¸ªåˆ†ç‰‡åº”è¯¥æ¥æ”¶è¯¥å†™å…¥ã€‚å…·ä½“æ–¹æ³•æ˜¯å¯¹ measurement + sorted tagset (the metaseries) è¿›è¡Œå“ˆå¸Œå¤„ç†ï¼Œç„¶åå°†å…¶åˆ†æ¡¶åˆ°æ­£ç¡®çš„åˆ†ç‰‡ä¸­ã€‚åœ¨ Go è¯­è¨€ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š// key is measurement + tagset // shardGroup is the group for the values based on timestamp // hash with fnv and then bucket shard := shardGroup.shards[fnv.New64a(key) % len(shardGroup.Shards)] è¿™ç§æ–¹æ¡ˆå¯¹äºç¡®å®šæ•°æ®åœ¨é›†ç¾¤ä¸­çš„ä½ç½®æœ‰å¤šé‡å«ä¹‰ã€‚é¦–å…ˆï¼Œå¯¹äºä»»ä½•ç»™å®šçš„å…ƒç³»åˆ—ï¼Œä»»ä½•ç»™å®šæ—¥æœŸçš„æ‰€æœ‰æ•°æ®éƒ½å­˜åœ¨äºå•ä¸ªåˆ†ç‰‡ä¸­ï¼Œå› æ­¤ä»…å­˜åœ¨äºæ‰˜ç®¡è¯¥åˆ†ç‰‡å‰¯æœ¬çš„æœåŠ¡å™¨ä¸Šã€‚å…¶æ¬¡ï¼Œä¸€æ—¦åˆ›å»ºäº†åˆ†ç‰‡ç»„ï¼Œå‘é›†ç¾¤æ·»åŠ æ–°æœåŠ¡å™¨å°†ä¸ä¼šæ‰©å±•è¯¥åˆ†ç‰‡ç»„çš„å†™å…¥å®¹é‡ã€‚åˆ†ç‰‡ç»„çš„å¤åˆ¶åœ¨åˆ›å»ºæ—¶å°±å·²å›ºå®šã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥åœ¨é›†ç¾¤æ‰©å±•æ—¶æ‰©å±•å½“å‰åˆ†ç‰‡ç»„ï¼ˆå³å½“å‰ï¼‰çš„å†™å…¥æ“ä½œã€‚å¯ä»¥ä½¿ç”¨ æˆªæ–­å½“å‰åˆ†ç‰‡ç»„ï¼Œä½¿å…¶åœ¨å½“å‰æ—¶é—´åœæ­¢ influxd-ctl truncate-shardsã€‚è¿™ä¼šç«‹å³å…³é—­å½“å‰åˆ†ç‰‡ç»„ï¼Œå¹¶å¼ºåˆ¶åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ†ç‰‡ç»„ã€‚æ–°çš„åˆ†ç‰‡ç»„ä¼šç»§æ‰¿æœ€æ–°çš„ä¿ç•™ç­–ç•¥å’Œæ•°æ®èŠ‚ç‚¹æ›´æ”¹ï¼Œç„¶åå°†è‡ªèº«é€‚å½“åœ°å¤åˆ¶åˆ°æ–°çš„å¯ç”¨æ•°æ®èŠ‚ç‚¹ã€‚è¿è¡Œinfluxd-ctl truncate-shards helpä»¥è·å–æœ‰å…³è¯¥å‘½ä»¤çš„æ›´å¤šä¿¡æ¯ã€‚å†™å…¥ä¸€è‡´æ€§æ¯ä¸ª HTTP API è¯·æ±‚éƒ½å¯ä»¥é€šè¿‡ consistency å‚æ•°æŒ‡å®šä¸€è‡´æ€§çº§åˆ«ï¼Œè¯¥å‚æ•°å½±å“æœ¬æ¬¡å†™å…¥å¤šå°‘å‰¯æœ¬æˆåŠŸåå°±ç«‹åˆ»è¿”å›æˆåŠŸã€‚ä¸ Bucket çš„å‰¯æœ¬å­˜å‚¨æ•°é‡é…ç½®ä¸å†²çªã€‚æ”¯æŒ 4 ç§çº§åˆ«:any one quorum all ç¼“å­˜é˜Ÿåˆ—ï¼ˆHinted handoffï¼‰Hinted handoff æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸºäºç£ç›˜çš„æŒä¹…é˜Ÿåˆ—ã€‚ä¸€ä¸ªå†™å¾€å¤šä¸ªå‰¯æœ¬çš„è¯·æ±‚ï¼Œå¦‚æœæŸä¸ªå‰¯æœ¬å®•æœºï¼Œåˆ™æ•°æ®ä¼šè¿›å…¥ç¼“å­˜é˜Ÿåˆ—ã€‚æ¥æ”¶èŠ‚ç‚¹ä¼šä¸ºæ¯ä¸ªæ— æ³•è®¿é—®çš„æ•°æ®èŠ‚ç‚¹ï¼ˆå’Œåˆ†ç‰‡ï¼‰åœ¨ç£ç›˜ä¸Šåˆ›å»ºä¸€ä¸ªå•ç‹¬çš„é˜Ÿåˆ—ã€‚å¯ä»¥ä½¿ç”¨ influx å®¢æˆ·ç«¯çš„ SHOW DIAGNOSTICS å‘½ä»¤æ¥æŸ¥çœ‹å½“å‰ç›¸å…³é…ç½®ã€‚é»˜è®¤æœ€å¤šå­˜7å¤©10Gçš„æ•°æ®ã€‚å¦‚æœæ•°æ®èŠ‚ç‚¹é‡å¯ï¼Œå®ƒä¼šæ£€æŸ¥ç¼“å­˜é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰å¾…å¤„ç†çš„å†™å…¥æ“ä½œï¼Œå¹¶æ¢å¤å¤åˆ¶ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¼“å­˜é˜Ÿåˆ—æ˜¯æŒä¹…åŒ–çš„ï¼Œå³ä½¿è¿›ç¨‹é‡å¯ä¹Ÿèƒ½ç»§ç»­æ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œåœ¨å‡çº§æˆ–ç»´æŠ¤æœŸé—´é‡å¯æ´»åŠ¨é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ—¶ï¼Œé›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ä¼šç¼“å­˜æœ¬åº”å†™åˆ°ç¦»çº¿èŠ‚ç‚¹çš„æ•°æ®ï¼Œå¹¶åœ¨è¯¥èŠ‚ç‚¹æ¢å¤å¯ç”¨åè¿›è¡Œå¤åˆ¶ã€‚å› æ­¤ï¼Œå¥åº·çš„é›†ç¾¤åº”è¯¥åœ¨æ¯ä¸ªæ•°æ®èŠ‚ç‚¹ä¸Šéƒ½ç•™æœ‰è¶³å¤Ÿçš„èµ„æºä½™é‡ï¼Œä»¥åº”å¯¹èŠ‚ç‚¹å®•æœºåå‡ºç°çš„çªå‘ç¼“å­˜å†™å…¥ã€‚æ¢å¤çš„èŠ‚ç‚¹éœ€è¦åŒæ—¶å¤„ç†ç¨³å®šçŠ¶æ€çš„æµé‡ä»¥åŠæ¥è‡ªå…¶ä»–èŠ‚ç‚¹çš„æ’é˜Ÿçš„ç¼“å­˜å†™å…¥ï¼Œè¿™æ„å‘³ç€åœ¨ä»»ä½•è¶…è¿‡å‡ ç§’é’Ÿçš„å®•æœºä¹‹åï¼Œå…¶å†™å…¥æµé‡éƒ½ä¼šå‡ºç°æ˜¾è‘—çš„å³°å€¼ï¼Œç›´åˆ°æç¤ºç¼“å­˜é˜Ÿåˆ—è€—å°½ä¸ºæ­¢ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æœ‰å¾…å¤„ç†çš„æŒ‡å‘å¦ä¸€ä¸ªæ•°æ®èŠ‚ç‚¹çš„ç¼“å­˜å†™å…¥æ“ä½œï¼Œå¹¶æ”¶åˆ°å‘å¾€è¯¥èŠ‚ç‚¹çš„å†™å…¥è¯·æ±‚ï¼Œå®ƒä¼šå°†è¯¥å†™å…¥æ“ä½œæ·»åŠ åˆ°æç¤ºåˆ‡æ¢é˜Ÿåˆ—çš„æœ«å°¾ï¼Œè€Œä¸æ˜¯å°è¯•ç›´æ¥å†™å…¥ã€‚è¿™ç¡®ä¿äº†æ•°æ®èŠ‚ç‚¹åŸºæœ¬æŒ‰æ—¶é—´é¡ºåºæ¥æ”¶æ•°æ®ï¼Œå¹¶é¿å…äº†åœ¨å…¶ä»–èŠ‚ç‚¹ç¦»çº¿æ—¶è¿›è¡Œä¸å¿…è¦çš„è¿æ¥å°è¯•ã€‚é›†ç¾¤ä¸­çš„æŸ¥è¯¢é›†ç¾¤ä¸­çš„æŸ¥è¯¢ä¼šæ ¹æ®æŸ¥è¯¢çš„æ—¶é—´èŒƒå›´å’Œæ•°æ®çš„å¤åˆ¶å› å­è¿›è¡Œåˆ†å¸ƒã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¿ç•™ç­–ç•¥çš„å¤åˆ¶å› å­ä¸º 4ï¼Œåˆ™æ¥æ”¶æŸ¥è¯¢çš„åè°ƒæ•°æ®èŠ‚ç‚¹ä¼šä»å­˜å‚¨åˆ†ç‰‡å‰¯æœ¬çš„ 4 ä¸ªæ•°æ®èŠ‚ç‚¹ä¸­éšæœºé€‰æ‹©ä»»æ„ä¸€ä¸ªæ¥æ¥æ”¶æŸ¥è¯¢ã€‚å‡è®¾ç³»ç»Ÿçš„åˆ†ç‰‡æŒç»­æ—¶é—´ä¸ºä¸€å¤©ï¼Œé‚£ä¹ˆå¯¹äºæŸ¥è¯¢è¦†ç›–çš„æ¯ä¸€å¤©ï¼Œåè°ƒèŠ‚ç‚¹éƒ½ä¼šé€‰æ‹©ä¸€ä¸ªæ•°æ®èŠ‚ç‚¹æ¥æ¥æ”¶å½“å¤©çš„æŸ¥è¯¢ã€‚åè°ƒèŠ‚ç‚¹å°½å¯èƒ½åœ¨æœ¬åœ°æ‰§è¡Œå¹¶å®ŒæˆæŸ¥è¯¢ã€‚å¦‚æœæŸ¥è¯¢å¿…é¡»æ‰«æå¤šä¸ªåˆ†ç‰‡ç»„ï¼ˆåœ¨ä¸Šä¾‹ä¸­ä¸ºå¤šå¤©ï¼‰ï¼Œåè°ƒèŠ‚ç‚¹ä¼šå°†æŸ¥è¯¢è½¬å‘åˆ°å…¶ä»–èŠ‚ç‚¹ï¼Œä»¥æŸ¥æ‰¾å…¶æœ¬åœ°æ²¡æœ‰çš„åˆ†ç‰‡ã€‚æŸ¥è¯¢çš„è½¬å‘ä¸æ‰«æå…¶æœ¬åœ°æ•°æ®å¹¶è¡Œè¿›è¡Œã€‚æŸ¥è¯¢ä¼šåˆ†å‘åˆ°å°½å¯èƒ½å¤šçš„èŠ‚ç‚¹ï¼Œä»¥ä¾¿å¯¹æ¯ä¸ªåˆ†ç‰‡ç»„è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢ã€‚å½“æ¯ä¸ªæ•°æ®èŠ‚ç‚¹è¿”å›ç»“æœæ—¶ï¼Œåè°ƒæ•°æ®èŠ‚ç‚¹ä¼šå°†å®ƒä»¬åˆå¹¶ä¸ºæœ€ç»ˆç»“æœå¹¶è¿”å›ç»™ç”¨æˆ·ã€‚Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-17 "},"doc_influxdb/concepts_key_concepts.html":{"url":"doc_influxdb/concepts_key_concepts.html","title":"å…³é”®æ¦‚å¿µ","keywords":"","body":" InfluxDB å…³é”®æ¦‚å¿µ ç¤ºä¾‹æ•°æ® è®¨è®º InfluxDB å…³é”®æ¦‚å¿µåœ¨æ·±å…¥ç ”ç©¶ InfluxDB ä¹‹å‰ï¼Œæœ€å¥½å…ˆäº†è§£ä¸€äº›æ•°æ®åº“çš„å…³é”®æ¦‚å¿µã€‚æœ¬æ–‡æ¡£ä»‹ç»äº† InfluxDB çš„ä¸€äº›å…³é”®æ¦‚å¿µå’Œå…ƒç´ ã€‚ä¸ºäº†ä»‹ç»è¿™äº›å…³é”®æ¦‚å¿µï¼Œæˆ‘ä»¬å°†ä»‹ç»ä»¥ä¸‹å…ƒç´ åœ¨ InfluxDB ä¸­å¦‚ä½•ååŒå·¥ä½œï¼šæ•°æ®åº“ (database) å­—æ®µé”® (field key) å­—æ®µé›† (field set) å­—æ®µå€¼ (field value) æµ‹é‡ (measurement) æ•°æ®ç‚¹ (point) ä¿ç•™ç­–ç•¥ (retention policy) ç³»åˆ— (series) æ ‡ç­¾é”® (tag key) æ ‡ç­¾é›† (tag set) æ ‡ç­¾å€¼ (tag value) æ—¶é—´æˆ³ (timestamp) ç¤ºä¾‹æ•°æ®ä¸‹ä¸€èŠ‚å°†å¼•ç”¨æ‰“å°å‡ºæ¥çš„æ•°æ®ã€‚è¿™äº›æ•°æ®æ˜¯è™šæ„çš„ï¼Œä½†ä»£è¡¨äº† InfluxDB ä¸­å¯ä¿¡çš„è®¾ç½®ã€‚å®ƒä»¬æ˜¾ç¤ºäº†ä¸¤ä½ç§‘å­¦å®¶ï¼ˆlangstrothå’Œperpetuaï¼‰åœ¨ä¸¤ä¸ªåœ°ç‚¹ï¼ˆä½ç½®1å’Œä½ç½®2ï¼‰ä» 2015 å¹´ 8 æœˆ 18 æ—¥åˆå¤œåˆ° 2015 å¹´ 8 æœˆ 18 æ—¥å‡Œæ™¨ 6:12 ç»Ÿè®¡çš„è´è¶å’Œèœœèœ‚æ•°é‡ã€‚å‡è®¾è¿™äº›æ•°æ®å­˜å‚¨åœ¨åä¸ºçš„æ•°æ®åº“ä¸­my_databaseï¼Œå¹¶å— autogen ä¿ç•™ç­–ç•¥çš„çº¦æŸï¼ˆæ›´å¤šå…³äºæ•°æ®åº“å’Œä¿ç•™ç­–ç•¥çš„å†…å®¹å°†åœ¨åé¢ä»‹ç»ï¼‰ã€‚å§“åï¼š census(measurement) time (timestamp) keybutterflies (field key) keyhoneybees keylocation (tag key) keyscientist 2015-08-18T00:00:00Z 12 (field value) 23 1 (tag value) langstroth 2015-08-18T00:00:00Z 1 30 1 perpetua 2015-08-18T00:06:00Z 11 28 1 langstroth 2015-08-18T00:06:00Z 3 28 1 perpetua 2015-08-18T05:54:00Z 2 11 2 langstroth 2015-08-18T06:00:00Z 1 10 2 langstroth 2015-08-18T06:06:00Z 8 23 2 perpetua 2015-08-18T06:12:00Z 7 22 2 perpetua è®¨è®ºç°åœ¨æ‚¨å·²ç»çœ‹åˆ°äº† InfluxDB ä¸­çš„ä¸€äº›ç¤ºä¾‹æ•°æ®ï¼Œæœ¬èŠ‚å°†ä»‹ç»è¿™äº›æ•°æ®çš„å«ä¹‰ã€‚InfluxDB æ˜¯ä¸€ä¸ªæ—¶é—´åºåˆ—æ•°æ®åº“ï¼Œå› æ­¤ä»æˆ‘ä»¬æ‰€æœ‰å·¥ä½œçš„æ ¹æºå¼€å§‹ï¼šæ—¶é—´ã€‚ä¸Šé¢çš„æ•°æ®ä¸­æœ‰ä¸€åˆ—åä¸ºtimeâ€”â€”InfluxDB ä¸­çš„æ‰€æœ‰æ•°æ®éƒ½æœ‰è¿™ä¸ªåˆ—ã€‚ time å­˜å‚¨æ—¶é—´æˆ³ï¼Œå¹¶ä¸”æ—¶é—´æˆ³æ˜¾ç¤ºä¸ç‰¹å®šæ•°æ®ç›¸å…³çš„æ—¥æœŸå’Œæ—¶é—´ï¼ˆä»¥RFC3339 UTC è¡¨ç¤ºï¼‰ã€‚æ¥ä¸‹æ¥çš„ä¸¤åˆ—ç§°ä¸º butterflies å’Œ honeybeesï¼Œæ˜¯å­—æ®µã€‚å­—æ®µç”±å­—æ®µé”®å’Œå­—æ®µå€¼ç»„æˆã€‚ å­—æ®µé”®ï¼ˆbutterflieså’Œhoneybeesï¼‰æ˜¯å­—ç¬¦ä¸²ï¼›å­—æ®µé”®butterflieså‘Šè¯‰æˆ‘ä»¬å­—æ®µå€¼12-7æŒ‡çš„æ˜¯è´è¶ï¼Œè€Œå­—æ®µé”®honeybeeså‘Šè¯‰æˆ‘ä»¬å­—æ®µå€¼23-22æŒ‡çš„æ˜¯èœœèœ‚ã€‚å­—æ®µå€¼å°±æ˜¯æ‚¨çš„æ•°æ®ï¼›å®ƒä»¬å¯ä»¥æ˜¯å­—ç¬¦ä¸²ã€æµ®ç‚¹æ•°ã€æ•´æ•°æˆ–å¸ƒå°”å€¼ã€‚ç”±äº InfluxDB æ˜¯ä¸€ä¸ªæ—¶é—´åºåˆ—æ•°æ®åº“ï¼Œå› æ­¤å­—æ®µå€¼å§‹ç»ˆä¸æ—¶é—´æˆ³ç›¸å…³è”ã€‚ç¤ºä¾‹æ•°æ®ä¸­çš„å­—æ®µå€¼ä¸ºï¼š12 23 1 30 11 28 3 28 2 11 1 10 8 23 7 22 åœ¨ä¸Šè¿°æ•°æ®ä¸­ï¼Œå­—æ®µé”®å’Œå­—æ®µå€¼å¯¹çš„é›†åˆæ„æˆäº†ä¸€ä¸ªå­—æ®µé›†ã€‚ä»¥ä¸‹æ˜¯ç¤ºä¾‹æ•°æ®ä¸­çš„æ‰€æœ‰å…«ä¸ªå­—æ®µé›†ï¼šbutterflies = 12 honeybees = 23 butterflies = 1 honeybees = 30 butterflies = 11 honeybees = 28 butterflies = 3 honeybees = 28 butterflies = 2 honeybees = 11 butterflies = 1 honeybees = 10 butterflies = 8 honeybees = 23 butterflies = 7 honeybees = 22 å­—æ®µæ˜¯ InfluxDB æ•°æ®ç»“æ„çš„å¿…éœ€éƒ¨åˆ†â€”â€”InfluxDB ä¸­çš„æ•°æ®ä¸èƒ½æ²¡æœ‰å­—æ®µã€‚åŒæ ·éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå­—æ®µä¸ä¼šè¢«ç´¢å¼•ã€‚ ä½¿ç”¨å­—æ®µå€¼ä½œä¸ºè¿‡æ»¤å™¨çš„æŸ¥è¯¢å¿…é¡»æ‰«ææ‰€æœ‰ç¬¦åˆæŸ¥è¯¢ä¸­å…¶ä»–æ¡ä»¶çš„å€¼ã€‚å› æ­¤ï¼Œè¿™äº›æŸ¥è¯¢çš„æ€§èƒ½ä¸å¦‚åŸºäºæ ‡ç­¾çš„æŸ¥è¯¢ï¼ˆä¸‹æ–‡å°†è¯¦ç»†ä»‹ç»æ ‡ç­¾ï¼‰ã€‚é€šå¸¸ï¼Œå­—æ®µä¸åº”åŒ…å«å¸¸ç”¨çš„å…ƒæ•°æ®ã€‚ç¤ºä¾‹æ•°æ®ä¸­çš„æœ€åä¸¤åˆ—ç§°ä¸ºlocationå’Œscientistï¼Œæ˜¯æ ‡ç­¾ã€‚æ ‡ç­¾ç”±æ ‡ç­¾é”®å’Œæ ‡ç­¾å€¼ç»„æˆã€‚ä¸¤è€…æ ‡ç­¾é”®å’Œæ ‡ç­¾å€¼ä»¥å­—ç¬¦ä¸²å½¢å¼å­˜å‚¨ï¼Œå¹¶è®°å½•å…ƒæ•°æ®ã€‚æ ·æœ¬æ•°æ®ä¸­çš„æ ‡ç­¾é”®ä¸ºlocationå’Œscientistã€‚æ ‡ç­¾é”®locationæœ‰ä¸¤ä¸ªæ ‡ç­¾å€¼ï¼š1å’Œ2ã€‚æ ‡ç­¾é”®scientistä¹Ÿæœ‰ä¸¤ä¸ªæ ‡ç­¾å€¼ï¼šlangstrothå’Œperpetuaã€‚åœ¨ä¸Šè¿°æ•°æ®ä¸­ï¼Œæ ‡ç­¾é›†æ˜¯æ‰€æœ‰æ ‡ç­¾é”®å€¼å¯¹çš„ä¸åŒç»„åˆã€‚æ ·æœ¬æ•°æ®ä¸­çš„å››ä¸ªæ ‡ç­¾é›†åˆ†åˆ«ä¸ºï¼šlocation = 1ï¼Œscientist = langstroth location = 2ï¼Œscientist = langstroth location = 1ï¼Œscientist = perpetua location = 2ï¼Œscientist = perpetua æ ‡ç­¾æ˜¯å¯é€‰çš„ã€‚æ‚¨çš„æ•°æ®ç»“æ„ä¸­å¹¶éå¿…é¡»åŒ…å«æ ‡ç­¾ï¼Œä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œä½¿ç”¨æ ‡ç­¾æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºä¸å­—æ®µä¸åŒï¼Œæ ‡ç­¾æ˜¯è¢«ç´¢å¼•çš„ã€‚è¿™æ„å‘³ç€å¯¹æ ‡ç­¾çš„æŸ¥è¯¢é€Ÿåº¦æ›´å¿«ï¼Œå¹¶ä¸”æ ‡ç­¾éå¸¸é€‚åˆå­˜å‚¨å¸¸ç”¨çš„å…ƒæ•°æ®ã€‚é¿å…ä½¿ç”¨ä»¥ä¸‹ä¿ç•™é”®ï¼š_field _measurement time å¦‚æœä¿ç•™é”®ä½œä¸ºæ ‡ç­¾æˆ–å­—æ®µé”®åŒ…å«åœ¨å†…ï¼Œåˆ™ç›¸å…³ç‚¹å°†è¢«ä¸¢å¼ƒã€‚æµ‹é‡(measurement)æ˜¯æŒæœ‰æ ‡ç­¾ã€å­—æ®µå’Œæ—¶é—´åˆ—çš„å®¹å™¨ï¼Œæµ‹é‡åç§°æ˜¯å¯¹å­˜å‚¨åœ¨å…³è”å­—æ®µä¸­çš„æ•°æ®çš„æè¿°ã€‚æµ‹é‡åç§°æ˜¯å­—ç¬¦ä¸²ï¼Œå¯¹äºä»»ä½• SQL ç”¨æˆ·æ¥è¯´ï¼Œæµ‹é‡åœ¨æ¦‚å¿µä¸Šç±»ä¼¼äºè¡¨ã€‚ç¤ºä¾‹æ•°æ®ä¸­æµ‹é‡åç§°æ˜¯censusã€‚å•ä¸ªæµ‹é‡å¯ä»¥å±äºä¸åŒçš„ä¿ç•™ç­–ç•¥ã€‚ä¿ç•™ç­–ç•¥æè¿°äº† InfluxDB ä¿ç•™æ•°æ®çš„æ—¶é—´ï¼ˆDURATIONï¼‰ä»¥åŠé›†ç¾¤ä¸­å­˜å‚¨çš„æ•°æ®å‰¯æœ¬æ•°é‡ï¼ˆREPLICATIONï¼‰ã€‚å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äºä¿ç•™ç­–ç•¥çš„ä¿¡æ¯ï¼Œè¯·å‚é˜…æ•°æ®åº“ç®¡ç†ã€‚å¤åˆ¶å› å­å¯¹äºå•èŠ‚ç‚¹å®ä¾‹ä¸èµ·ä½œç”¨ç°åœ¨æ¥è®¨è®ºä¸€ä¸‹ç³»åˆ—(series)ã€‚åœ¨ InfluxDB ä¸­ï¼Œç³»åˆ—æ˜¯å…±äº«æµ‹é‡ã€æ ‡ç­¾é›†å’Œå­—æ®µé”®çš„ç‚¹çš„é›†åˆã€‚ä¸Šé¢çš„æ•°æ®ç”±å…«ä¸ªç³»åˆ—ç»„æˆï¼š Series Measurement Tag set Field key 1 census location=1, scientist=langstroth butterflies 2 census location=2, scientist=langstroth butterflies 3 census location=1, scientist=perpetua butterflies 4 census location=2, scientist=perpetua butterflies 5 census location=1, scientist=langstroth honeybees 6 census location=2, scientist=langstroth honeybees 7 census location=1, scientist=perpetua honeybees 8 census location=2, scientist=perpetua honeybees ä¸€ä¸ªç‚¹è¡¨ç¤ºä¸€æ¡åŒ…å«å››ä¸ªç»„æˆéƒ¨åˆ†çš„æ•°æ®è®°å½•ï¼šæµ‹é‡ã€æ ‡ç­¾é›†ã€å­—æ®µé›†å’Œæ—¶é—´æˆ³ã€‚ä¸€ä¸ªç‚¹ç”±å…¶åºåˆ—å’Œæ—¶é—´æˆ³å”¯ä¸€æ ‡è¯†ã€‚ ä¾‹å¦‚ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç‚¹ï¼šname: census ----------------- time butterflies honeybees location scientist 2015-08-18T00:00:00Z 1 30 1 perpetua æ­¤ç¤ºä¾‹ä¸­çš„ç‚¹æ˜¯ç³»åˆ— 3 å’Œ 7 çš„ä¸€éƒ¨åˆ†ï¼Œç”±æµ‹é‡ï¼ˆcensusï¼‰ã€æ ‡ç­¾é›†ï¼ˆlocation = 1ã€scientist = perpetuaï¼‰ã€å­—æ®µé›†ï¼ˆbutterflies = 1ã€honeybees = 30ï¼‰å’Œæ—¶é—´æˆ³ 2015-08-18T00:00:00Z å®šä¹‰ã€‚æˆ‘ä»¬åˆšåˆšä»‹ç»çš„æ‰€æœ‰å†…å®¹éƒ½å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ - ç¤ºä¾‹æ•°æ®å°±åœ¨æ•°æ®åº“ä¸­my_databaseã€‚InfluxDBæ•°æ®åº“ç±»ä¼¼äºä¼ ç»Ÿçš„å…³ç³»æ•°æ®åº“ï¼Œå®ƒå……å½“ç”¨æˆ·ã€ä¿ç•™ç­–ç•¥ã€æŒç»­æŸ¥è¯¢ä»¥åŠæ—¶é—´åºåˆ—æ•°æ®çš„é€»è¾‘å®¹å™¨ã€‚æœ‰å…³è¿™äº›ä¸»é¢˜çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…èº«ä»½éªŒè¯å’Œæˆæƒä»¥åŠæŒç»­æŸ¥è¯¢ã€‚æ•°æ®åº“å¯ä»¥æ”¯æŒå¤šä¸ªç”¨æˆ·ã€è¿ç»­æŸ¥è¯¢ã€ä¿ç•™ç­–ç•¥å’Œæµ‹é‡ã€‚InfluxDB æ˜¯ä¸€ä¸ªæ— æ¨¡å¼æ•°æ®åº“ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥éšæ—¶è½»æ¾æ·»åŠ æ–°çš„æµ‹é‡ã€æ ‡ç­¾å’Œå­—æ®µã€‚å®ƒæ—¨åœ¨è®©æ—¶é—´åºåˆ—æ•°æ®å¤„ç†å˜å¾—æ— æ¯”ä¾¿æ·ã€‚Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-18 "},"doc_influxdb/concepts_startup_process.html":{"url":"doc_influxdb/concepts_startup_process.html","title":"å¯åŠ¨è¿‡ç¨‹","keywords":"","body":" InfluxDB å¯åŠ¨è¿‡ç¨‹ å­ç³»ç»Ÿå’ŒæœåŠ¡ TSDBStore: TSDBå­˜å‚¨ Monitor: ç›‘æ§ Cluster: é›†ç¾¤ Precreator: é¢„åˆ›å»º Snapshotter: å¿«ç…§ Continuous Query: è¿ç»­æŸ¥è¯¢ Announcer: å¹¿æ’­ Retention: ä¿ç•™ Stats: ç»Ÿè®¡ Anti-entropy: åç†µ HTTP API: HTTP æ¥å£ InfluxDB å¯åŠ¨è¿‡ç¨‹å¯åŠ¨æ—¶ï¼ŒInfluxDB Enterprise æŒ‰ä»¥ä¸‹é¡ºåºå¯åŠ¨æ‰€æœ‰å­ç³»ç»Ÿå’ŒæœåŠ¡ï¼šTSDBStore: TSDBå­˜å‚¨ Monitor: ç›‘æ§ Cluster: é›†ç¾¤ Precreator: é¢„åˆ›å»º Snapshotter: å¿«ç…§ Continuous Query: è¿ç»­æŸ¥è¯¢ Announcer: å¹¿æ’­ Retention: ä¿ç•™ Stats: ç»Ÿè®¡ Anti-entropy: åç†µ HTTP API: HTTP æ¥å£ å­ç³»ç»Ÿæ˜¯ä¸€ç³»åˆ—ç›¸å…³æœåŠ¡çš„é›†åˆï¼Œå®ƒä»¬ä½œä¸ºæ›´å¤§æ•´ä½“çš„ä¸€éƒ¨åˆ†è¿›è¡Œç®¡ç†ã€‚æœåŠ¡æ˜¯æä¾›ç‰¹å®šåŠŸèƒ½çš„è¿›ç¨‹ã€‚å­ç³»ç»Ÿå’ŒæœåŠ¡TSDBStore: TSDBå­˜å‚¨TSDBStore å­ç³»ç»Ÿå¯åŠ¨å¹¶ç®¡ç† TSM å­˜å‚¨å¼•æ“ã€‚è¿™åŒ…æ‹¬ç‚¹å†™å…¥ï¼ˆå†™å…¥ï¼‰ã€è¯»å–ï¼ˆæŸ¥è¯¢ï¼‰å’Œç¼“å­˜é˜Ÿåˆ— (HH) ç­‰æœåŠ¡ã€‚TSDBSTore é¦–å…ˆæ‰“å¼€æ‰€æœ‰åˆ†ç‰‡ï¼Œå¹¶å°†é¢„å†™æ—¥å¿— (WAL) æ•°æ®åŠ è½½åˆ°å†…å­˜å†™ç¼“å­˜ä¸­ã€‚å¦‚æœinfluxdä¹‹å‰å·²å®Œå…¨å…³é—­ï¼Œåˆ™ä¸ä¼šæœ‰ä»»ä½• WAL æ•°æ®ã€‚ç„¶åï¼Œå®ƒä¼šåŠ è½½æ¯ä¸ªåˆ†ç‰‡ç´¢å¼•çš„ä¸€éƒ¨åˆ†ã€‚ç´¢å¼•ç‰ˆæœ¬å’Œå¯åŠ¨æ—¶é—´ å¦‚æœä½¿ç”¨inmemç´¢å¼•ï¼ŒInfluxDB ä¼šå°†æ‰€æœ‰åˆ†ç‰‡ç´¢å¼•åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ï¼Œå…·ä½“å–å†³äºæ•°æ®åº“ä¸­çš„ç³»åˆ—æ•°é‡ã€‚å¦‚æœä½¿ç”¨tsi1ç´¢å¼•ï¼ŒInfluxDB åªä¼šå°†çƒ­åˆ†ç‰‡ç´¢å¼•ï¼ˆæœ€è¿‘çš„åˆ†ç‰‡æˆ–å½“å‰æ­£åœ¨å†™å…¥çš„åˆ†ç‰‡ï¼‰åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å°†å†·åˆ†ç‰‡ç´¢å¼•å­˜å‚¨åœ¨ç£ç›˜ä¸Šã€‚ä½¿ç”¨tsi1ç´¢å¼•å¯ä»¥ç¼©çŸ­å¯åŠ¨æ—¶é—´ã€‚ InfluxDB 1.8+ é»˜è®¤ä½¿ç”¨ tsi1 ç´¢å¼•Monitor: ç›‘æ§ç›‘æ§æœåŠ¡å‘ InfluxDB æä¾›æœ‰å…³å…¶è‡ªèº«çš„ç»Ÿè®¡å’Œè¯Šæ–­ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯æœ‰åŠ©äºæ•°æ®åº“æ•…éšœæ’é™¤å’Œæ€§èƒ½åˆ†æã€‚Cluster: é›†ç¾¤é›†ç¾¤æœåŠ¡æä¾›åœ¨ InfluxDB Enterprise v1.8 é›†ç¾¤ä¸Šè¿è¡Œçš„ InfluxDB OSS v1.8 æ¥å£çš„å®ç°ã€‚Precreator: é¢„åˆ›å»ºé¢„åˆ›å»ºæœåŠ¡ä¼šåœ¨éœ€è¦åˆ†ç‰‡ä¹‹å‰åˆ›å»ºå®ƒä»¬ã€‚è¿™ç¡®ä¿äº†åœ¨æ–°çš„æ—¶é—´åºåˆ—æ•°æ®åˆ°è¾¾ä¹‹å‰ï¼Œå¿…è¦çš„åˆ†ç‰‡å·²ç»å­˜åœ¨ï¼Œå¹¶ä¸”å†™å…¥ååé‡ä¸ä¼šå—åˆ°æ–°åˆ†ç‰‡åˆ›å»ºçš„å½±å“ã€‚Snapshotter: å¿«ç…§å¿«ç…§æœåŠ¡ä¼šå®šæœŸåˆ›å»º InfluxDB Enterprise å…ƒæ•°æ®çš„å¿«ç…§ã€‚Continuous Query: è¿ç»­æŸ¥è¯¢è¿ç»­æŸ¥è¯¢ (CQ) å­ç³»ç»Ÿç®¡ç†æ‰€æœ‰ InfluxDB CQã€‚Announcer: å¹¿æ’­æœåŠ¡å‘ Meta èŠ‚ç‚¹å¹¿æ’­æ•°æ®èŠ‚ç‚¹çš„çŠ¶æ€ã€‚Retention: ä¿ç•™ä¿ç•™æœåŠ¡å¼ºåˆ¶æ‰§è¡Œä¿ç•™ç­–ç•¥ å¹¶åœ¨æ•°æ®è¿‡æœŸæ—¶åˆ é™¤æ•°æ®ã€‚Stats: ç»Ÿè®¡ç»Ÿè®¡æœåŠ¡ç›‘æ§é›†ç¾¤çº§åˆ«çš„ç»Ÿè®¡æ•°æ®ã€‚Anti-entropy: åç†µåç†µ (AE) å­ç³»ç»Ÿè´Ÿè´£åè°ƒåˆ†ç‰‡ä¹‹é—´çš„å·®å¼‚ã€‚HTTP API: HTTP æ¥å£InfluxDB HTTP API æœåŠ¡æä¾›é¢å‘å…¬ä¼—çš„æ¥å£ï¼Œç”¨äºä¸ InfluxDB Enterprise ä»¥åŠ InfluxDB Enterprise é›†ç¾¤å†…ä½¿ç”¨çš„å†…éƒ¨æ¥å£è¿›è¡Œäº¤äº’ã€‚Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-18 "},"doc_influxdb/administration.html":{"url":"doc_influxdb/administration.html","title":"è¿ç»´ç®¡ç†","keywords":"","body":"è¿ç»´ç®¡ç†Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-18 "},"doc_influxdb/administration_configure.html":{"url":"doc_influxdb/administration_configure.html","title":"é…ç½®ç®¡ç†","keywords":"","body":"é…ç½®ç®¡ç†Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-18 "},"doc_influxdb/administration_configure_clusters.html":{"url":"doc_influxdb/administration_configure_clusters.html","title":"é…ç½®é›†ç¾¤","keywords":"","body":" é…ç½®é›†ç¾¤ ä½¿ç”¨é…ç½®æ–‡ä»¶ åˆ›å»ºé…ç½®æ–‡ä»¶ ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨è¿›ç¨‹ ç¯å¢ƒå˜é‡ GOMAXPROCSç¯å¢ƒå˜é‡ é…ç½®é›†ç¾¤æœ¬é¡µåŒ…å«æœ‰å…³é…ç½® InfluxDB Enterprise é›†ç¾¤çš„å¸¸è§„ä¿¡æ¯ã€‚æœ‰å…³é…ç½®è®¾ç½®çš„å®Œæ•´åˆ—è¡¨å’Œè¯´æ˜ï¼Œè¯·å‚é˜…ï¼šé…ç½® Data èŠ‚ç‚¹ é…ç½® Meta èŠ‚ç‚¹ ä½¿ç”¨é…ç½®æ–‡ä»¶æ˜¾ç¤ºé»˜è®¤é…ç½® ä»¥ä¸‹å‘½ä»¤æ‰“å°å‡º TOML æ ¼å¼çš„é…ç½®ï¼Œå…¶ä¸­æ‰€æœ‰å¯ç”¨é€‰é¡¹å‡è®¾ç½®ä¸ºå…¶é»˜è®¤å€¼ã€‚Meta èŠ‚ç‚¹é…ç½®influxd-meta config Data èŠ‚ç‚¹é…ç½®influxd config åˆ›å»ºé…ç½®æ–‡ä»¶åœ¨ POSIX ç³»ç»Ÿä¸Šï¼Œé€šè¿‡å°†å‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶æ¥ç”Ÿæˆæ–°çš„é…ç½®æ–‡ä»¶ã€‚æ–°çš„å…ƒèŠ‚ç‚¹é…ç½®æ–‡ä»¶ï¼šinfluxd-meta config > /etc/influxdb/influxdb-meta-generated.conf æ–°çš„æ•°æ®èŠ‚ç‚¹é…ç½®æ–‡ä»¶ï¼šinfluxd config > /etc/influxdb/influxdb-generated.conf ä½¿ç”¨è¯¥é€‰é¡¹ç”Ÿæˆæ–°é…ç½®æ–‡ä»¶æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ -config å‚æ•°æ¥ä¿ç•™æ—§é…ç½®æ–‡ä»¶ä¸­çš„è‡ªå®šä¹‰è®¾ç½®ã€‚influxd config -config /etc/influxdb/influxdb.conf.old > /etc/influxdb/influxdb.conf.new ä½¿ç”¨é…ç½®æ–‡ä»¶å¯åŠ¨è¿›ç¨‹æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰é…ç½®æ–‡ä»¶å¯åŠ¨å…ƒæˆ–æ•°æ®è¿›ç¨‹ã€‚ä½¿ç”¨ -config å°†è¿›ç¨‹æŒ‡å‘æ‰€éœ€çš„é…ç½®æ–‡ä»¶ã€‚ è¦å¯åŠ¨å…ƒèŠ‚ç‚¹è¿›ç¨‹ï¼Œè¯·ä½¿ç”¨/etc/influxdb/influxdb-meta-generate.confï¼šinfluxd-meta -config /etc/influxdb/influxdb-meta-generate.conf è¦å¯åŠ¨æ•°æ®èŠ‚ç‚¹è¿›ç¨‹ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤/etc/influxdb/influxdb-generated.confï¼šinfluxd -config /etc/influxdb/influxdb-generated.conf å°†ç¯å¢ƒå˜é‡è®¾ç½® INFLUXDB_CONFIG_PATH ä¸ºé…ç½®æ–‡ä»¶çš„è·¯å¾„å¹¶å¯åŠ¨è¯¥è¿›ç¨‹ã€‚ è¦è®¾ç½®ç¯å¢ƒå˜é‡å¹¶ä½¿ç”¨é…ç½®æ–‡ä»¶è·¯å¾„ INFLUXDB_CONFIG_PATH å¯åŠ¨æ•°æ®è¿›ç¨‹ï¼šINFLUXDB_CONFIG_PATHexport INFLUXDB_CONFIG_PATH=/root/influxdb.generated.conf echo $INFLUXDB_CONFIG_PATH /root/influxdb.generated.conf influxd å¦‚æœè®¾ç½®ï¼Œ-config å‘½ä»¤è¡Œè·¯å¾„å°†è¦†ç›–ä»»ä½•ç¯å¢ƒå˜é‡è·¯å¾„ã€‚å¦‚æœæ‚¨æœªæä¾›é…ç½®æ–‡ä»¶ï¼ŒInfluxDB å°†ä½¿ç”¨å†…éƒ¨é»˜è®¤é…ç½®(ç›¸å½“äºä½¿ç”¨ influxd configå’Œinfluxd-meta configçš„è¾“å‡º)ä½¿ç”¨é…ç½®æ–‡ä»¶ (influxdb.conf) å’Œç¯å¢ƒå˜é‡é…ç½® InfluxDBã€‚æ¯ä¸ªé…ç½®è®¾ç½®çš„é»˜è®¤å€¼å‡æ˜¾ç¤ºåœ¨æ–‡æ¡£ä¸­ã€‚æ³¨é‡Šæ‰çš„é…ç½®é€‰é¡¹å°†ä½¿ç”¨é»˜è®¤å€¼ã€‚å…·æœ‰æŒç»­æ—¶é—´å€¼çš„é…ç½®è®¾ç½®æ”¯æŒä»¥ä¸‹æŒç»­æ—¶é—´å•ä½ï¼šns ï¼ˆçº³ç§’ï¼‰ usæˆ–Âµs ï¼ˆå¾®ç§’ï¼‰ ms ï¼ˆæ¯«ç§’ï¼‰ s ï¼ˆç§’ï¼‰ m ï¼ˆåˆ†é’Ÿï¼‰ h ï¼ˆå°æ—¶ï¼‰ d ï¼ˆå¤©ï¼‰ w ï¼ˆå‘¨ï¼‰ ç¯å¢ƒå˜é‡æ‰€æœ‰é…ç½®é€‰é¡¹éƒ½å¯ä»¥åœ¨é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ä¸­æŒ‡å®šã€‚ç¯å¢ƒå˜é‡ä¼šè¦†ç›–é…ç½®æ–‡ä»¶ä¸­çš„ç­‰æ•ˆé€‰é¡¹ã€‚å¦‚æœé…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡ä¸­å‡æœªæŒ‡å®šæŸä¸ªé…ç½®é€‰é¡¹ï¼ŒInfluxDB å°†ä½¿ç”¨å…¶å†…éƒ¨é»˜è®¤é…ç½®ã€‚åœ¨ä»¥ä¸‹éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†åœ¨é…ç½®è®¾ç½®çš„æè¿°ä¸­å‘½åç›¸å…³çš„ç¯å¢ƒå˜é‡ã€‚ç¯å¢ƒå˜é‡å¯ä»¥åœ¨/etc/default/influxdb-metaå’Œ/etc/default/influxdbè®¾ç½®ã€‚æ³¨æ„ï¼š è¦è®¾ç½®æˆ–è¦†ç›–å…è®¸å¤šç§é…ç½®çš„é…ç½®èŠ‚ä¸­çš„è®¾ç½®ï¼ˆä»»ä½•[[...]]åœ¨æ ‡é¢˜ä¸­å¸¦æœ‰åŒæ‹¬å· ( ) çš„èŠ‚éƒ½æ”¯æŒå¤šç§é…ç½®ï¼‰ï¼Œæ‰€éœ€çš„é…ç½®å¿…é¡»æŒ‰åºå·æŒ‡å®šã€‚ä¾‹å¦‚ï¼Œå¯¹äºç¬¬ä¸€ç»„[[graphite]]ç¯å¢ƒå˜é‡ï¼Œåœ¨ç¯å¢ƒå˜é‡ä¸­ï¼Œåœ¨é…ç½®è®¾ç½®åç§°å‰åŠ ä¸Šç›¸åº”çš„ä½ç½®ç¼–å·ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸ºï¼š0ï¼‰INFLUXDB_GRAPHITE_0_BATCH_PENDING INFLUXDB_GRAPHITE_0_BATCH_SIZE INFLUXDB_GRAPHITE_0_BATCH_TIMEOUT INFLUXDB_GRAPHITE_0_BIND_ADDRESS INFLUXDB_GRAPHITE_0_CONSISTENCY_LEVEL INFLUXDB_GRAPHITE_0_DATABASE INFLUXDB_GRAPHITE_0_ENABLED INFLUXDB_GRAPHITE_0_PROTOCOL INFLUXDB_GRAPHITE_0_RETENTION_POLICY INFLUXDB_GRAPHITE_0_SEPARATOR INFLUXDB_GRAPHITE_0_TAGS INFLUXDB_GRAPHITE_0_TEMPLATES INFLUXDB_GRAPHITE_0_UDP_READ_BUFFER å¯¹äºé…ç½®æ–‡ä»¶ä¸­çš„ç¬¬ N ä¸ª Graphite é…ç½®ï¼Œç›¸å…³çš„ç¯å¢ƒå˜é‡å°†é‡‡ç”¨ä»¥ä¸‹å½¢å¼INFLUXDBGRAPHITE(N-1)_BATCH_PENDINGã€‚å¯¹äºé…ç½®æ–‡ä»¶çš„æ¯ä¸ªéƒ¨åˆ†ï¼Œç¼–å·ä»é›¶é‡æ–°å¼€å§‹ã€‚GOMAXPROCSç¯å¢ƒå˜é‡GOMAXPROCSæ— æ³•ä½¿ç”¨ InfluxDB é…ç½®æ–‡ä»¶è¿›è¡Œè®¾ç½®ã€‚åªèƒ½å°†å…¶è®¾ç½®ä¸ºç¯å¢ƒå˜é‡ã€‚ GOMAXPROCS Goè¯­è¨€ç¯å¢ƒå˜é‡å¯ä»¥ ç”¨æ¥è®¾ç½®å¯ä»¥åŒæ—¶æ‰§è¡Œçš„æœ€å¤§CPUæ•°é‡ã€‚GOMAXPROCS çš„é»˜è®¤å€¼æ˜¯ç¨‹åºå¯åŠ¨æ—¶å¯è§çš„ CPU æ•°é‡ ï¼ˆåŸºäºæ“ä½œç³»ç»Ÿå¯¹ CPU çš„å®šä¹‰ï¼‰ã€‚å¯¹äº 32 æ ¸çš„æœºå™¨ï¼Œè¯¥å€¼ä¸º 32ã€‚æ‚¨å¯ä»¥è¦†ç›–æ­¤å€¼ï¼Œä½¿å…¶å°äºæœ€å¤§å€¼ã€‚å¦‚æœæ‚¨åœ¨åŒä¸€å°æœºå™¨ä¸ŠåŒæ—¶è¿è¡Œ InfluxDB å’Œå…¶ä»–è¿›ç¨‹ï¼Œå¹¶ä¸”å¸Œæœ›ç¡®ä¿æ•°æ®åº“ä¸ä¼šå¯¹è¿™äº›è¿›ç¨‹äº§ç”Ÿè´Ÿé¢å½±å“ï¼Œé‚£ä¹ˆæ­¤åŠŸèƒ½éå¸¸æœ‰ç”¨ã€‚è®¾ç½®GOMAXPROCS=1ä¼šæ¶ˆé™¤æ‰€æœ‰å¹¶è¡ŒåŒ–ã€‚Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-18 "},"doc_influxdb/administration_configure_data_nodes.html":{"url":"doc_influxdb/administration_configure_data_nodes.html","title":"é…ç½® Data èŠ‚ç‚¹","keywords":"","body":" é…ç½® Data èŠ‚ç‚¹ Data èŠ‚ç‚¹é…ç½®è®¾ç½® Global å…¨å±€è®¾ç½® reporting-disabled bind-address hostname gossip-frequency compact-series-file v1.11.4+ Enterprise license ä¼ä¸šè®¸å¯è¯ license-key license-path Meta node MetaèŠ‚ç‚¹è®¾ç½® dir meta-tls-enabled meta-insecure-tls meta-auth-enabled meta-internal-shared-secret retention-autocreate logging-enabled password-hash ensure-fips Data æ•°æ® dir wal-dir trace-logging-enabled query-log-enabled query-log-path wal-fsync-delay ingress-metric-by-measurement-enabled ingress-metric-by-login-enabled TSMå¼•æ“çš„æ•°æ®è®¾ç½® cache-max-memory-size cache-snapshot-memory-size cache-snapshot-write-cold-duration max-concurrent-compactions compact-throughput compact-throughput-burst compact-full-write-cold-duration index-version inmem ç´¢å¼•è®¾ç½® max-series-per-database max-values-per-tag TSIï¼ˆtsi1ï¼‰æŒ‡æ•°è®¾ç½® max-index-log-file-size series-id-set-cache-size Cluster é›†ç¾¤ dial-timeout pool-max-idle-time pool-max-idle-streams allow-out-of-order-writes shard-reader-timeout https-enabled https-certificate https-private-key https-insecure-tls cluster-tracing write-timeout max-concurrent-queries max-concurrent-deletes query-timeout log-queries-after log-timedout-queries max-select-point max-select-series max-select-buckets termination-query-log Retention ä¿ç•™ç­–ç•¥ enabled check-interval Hinted Handoff ç¼“å­˜é˜Ÿåˆ— batch-size max-writes-pending dir enabled max-size max-age retry-concurrency retry-rate-limit retry-interval retry-max-interval purge-interval Anti-Entropy åç†µ enabled check-interval max-fetch max-sync auto-repair-missing Shard precreation åˆ†ç‰‡é¢„åˆ›å»º enabled check-interval advance-period Monitor ç›‘æ§ store-enabled store-database store-interval remote-collect-interval HTTP endpoints HTTPç«¯ç‚¹ enabled flux-enabled bind-address auth-enabled realm log-enabled suppress-write-log access-log-path access-log-status-filters write-tracing pprof-enabled https-enabled https-certificate https-private-key shared-secret max-body-size max-row-limit max-connection-limit unix-socket-enabled bind-socket max-concurrent-write-limit max-enqueued-write-limit enqueued-write-timeout Logging æ—¥å¿— format level suppress-logo Subscriber è®¢é˜… enabled http-timeout insecure-skip-verify ca-certs write-concurrency write-buffer-size total-buffer-bytes Graphite Graphiteåè®® Collectd CollectDåè®® OpenTSDB OpenTSDBåè®® UDP UDPåè®® Continuous queries è¿ç»­æŸ¥è¯¢ enabled log-enabled query-stats-enabled run-interval TLS TLSåŠ å¯† min-version max-version Flux Query controls FluxæŸ¥è¯¢ query-concurrency query-initial-memory-bytes query-max-memory-bytes total-max-memory-bytes query-queue-size é…ç½® Data èŠ‚ç‚¹Data èŠ‚ç‚¹é…ç½®è®¾ç½® Global Enterprise license [enterprise] Meta node [meta] Data [data] Cluster [cluster] (includes InfluxQL query controls) Retention [retention] Hinted Handoff [hinted-handoff] Anti-Entropy [anti-entropy] Shard precreation [shard-precreation] Monitor [monitor] HTTP endpoints [http] Logging [logging] Subscriber [subscriber] Graphite [graphite] Collectd [collectd] OpenTSDB [opentsdb] UDP [udp] Continuous queries [continuous-queries] TLS [tls] Flux Query controls [flux-controller] Data èŠ‚ç‚¹é…ç½®è®¾ç½®ç³»ç»Ÿä¸ºæ¯ä¸ªé…ç½®æ–‡ä»¶è®¾ç½®éƒ½è®¾ç½®äº†å†…éƒ¨é»˜è®¤å€¼ã€‚ä½¿ç”¨influxd configå‘½ä»¤æŸ¥çœ‹é»˜è®¤è®¾ç½®ã€‚æœ¬åœ°é…ç½®æ–‡ä»¶ ( /etc/influxdb/influxdb.conf) ä¼šè¦†ç›–æ‰€æœ‰å†…éƒ¨é»˜è®¤å€¼ï¼Œä½†é…ç½®æ–‡ä»¶æ— éœ€åŒ…å«æ‰€æœ‰é…ç½®è®¾ç½®ã€‚ä» 1.0.1 ç‰ˆæœ¬å¼€å§‹ï¼Œæœ¬åœ°é…ç½®æ–‡ä»¶ä¸­çš„å¤§å¤šæ•°è®¾ç½®å‡å·²è¢«æ³¨é‡Šæ‰ã€‚æ‰€æœ‰æ³¨é‡Šæ‰çš„è®¾ç½®å°†ç”±å†…éƒ¨é»˜è®¤å€¼å†³å®šã€‚Global å…¨å±€è®¾ç½®reporting-disabledæ¯ 24 å°æ—¶ä¼šå°†ä½¿ç”¨æƒ…å†µæ•°æ®æŠ¥å‘Šè‡³ usage.influxdata.comã€‚æŠ¥å‘Šæ•°æ®åŒ…å«éšæœº IDã€æ“ä½œç³»ç»Ÿã€æ¶æ„ã€ç‰ˆæœ¬ã€ç³»åˆ—æ•°é‡ä»¥åŠå…¶ä»–ä½¿ç”¨æƒ…å†µæ•°æ®ã€‚ç”¨æˆ·æ•°æ®åº“çš„æ•°æ®ä¸ä¼šä¼ è¾“ã€‚å°†æ­¤é€‰é¡¹æ›´æ”¹ä¸º true å¯ç¦ç”¨æŠ¥å‘ŠåŠŸèƒ½ã€‚é»˜è®¤å€¼: false bind-addressRPCæœåŠ¡ç”¨äºèŠ‚ç‚¹é—´é€šä¿¡å’Œå¤‡ä»½ä¸æ¢å¤çš„TCPç»‘å®šåœ°å€ã€‚é»˜è®¤å€¼: \":8088\" ç¯å¢ƒå˜é‡: INFLUXDB_BIND_ADDRESS hostnameæ•°æ®èŠ‚ç‚¹çš„ä¸»æœºåã€‚è¯¥ä¸»æœºåå¿…é¡»èƒ½å¤Ÿè¢«é›†ç¾¤ä¸­çš„æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹è§£æã€‚é»˜è®¤å€¼: \"localhost\" ç¯å¢ƒå˜é‡: INFLUXDB_HOSTNAME gossip-frequencyèŠ‚ç‚¹çš„å†…éƒ¨çŠ¶æ€æ›´æ–°è‡³é›†ç¾¤çš„é¢‘ç‡ã€‚é»˜è®¤å€¼: \"3s\" ç¯å¢ƒå˜é‡: INFLUXDB_GOSSIP_FREQUENCY compact-series-file v1.11.4+ç¡®å®šæ˜¯å¦åº”åœ¨å¯åŠ¨æ—¶å‹ç¼© series-fileã€‚å¦‚æœæ˜¯trueï¼Œåˆ™ InfluxDB ä¼šåœ¨ influxd æœåŠ¡å¯åŠ¨ä¹‹å‰è¿è¡Œ influxd_inspect -compact-series-fileã€‚é»˜è®¤å€¼: false ç³»åˆ—æ–‡ä»¶å‹ç¼© ç³»åˆ—æ–‡ä»¶å­˜å‚¨åœ¨InfluxDB æ•°æ®ç›®å½•_serieså†…çš„ç›®å½• ä¸­ã€‚é»˜è®¤å€¼ï¼šã€‚/var/lib/data//_series åœ¨å¯åŠ¨æ—¶å‹ç¼©ç³»åˆ—æ–‡ä»¶æ—¶ï¼š å¦‚æœä»»ä½•ç³»åˆ—æ–‡ä»¶æŸåï¼Œæ•°æ®èŠ‚ç‚¹ä¸Šçš„influx_inspectæˆ–influxdè¿›ç¨‹å¯èƒ½æ— æ³•å¯åŠ¨ã€‚åœ¨è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œè¯·åœ¨é‡å¯æ•°æ®åº“ä¹‹å‰åˆ é™¤ç³»åˆ—æ–‡ä»¶ç›®å½•ã€‚InfluxDB ä¼šåœ¨é‡å¯æ—¶è‡ªåŠ¨é‡æ–°ç”Ÿæˆå¿…è¦çš„ç³»åˆ—ç›®å½•å’Œæ–‡ä»¶ã€‚ è¦åœ¨å¯åŠ¨æ•°æ®åº“ä¹‹å‰æ£€æŸ¥ç³»åˆ—æ–‡ä»¶æ˜¯å¦æŸåï¼Œè¯· åœ¨æ•°æ®åº“ç¦»çº¿æ—¶è¿è¡Œ influx_inspect verify-seriesfile å‘½ä»¤ã€‚ å¦‚æœç³»åˆ—æ–‡ä»¶å¾ˆå¤§ï¼ˆ20+ GBï¼‰ï¼Œåˆ™åœ¨å¯åŠ¨æ•°æ®åº“ä¹‹å‰åˆ é™¤ç³»åˆ—æ–‡ä»¶ç›®å½•å¯èƒ½ä¼šæ›´å¿«ã€‚Enterprise license ä¼ä¸šè®¸å¯è¯[enterprise] é…ç½®åŒ…å«äº† Meta èŠ‚ç‚¹ä½¿ç”¨ InfluxDB ä¼ä¸šæˆæƒæ³¨å†Œçš„é…ç½®license-keyåœ¨InfluxPortalä¸Šä¸ºæ‚¨åˆ›å»ºçš„è®¸å¯è¯å¯†é’¥ã€‚å…ƒèŠ‚ç‚¹é€šè¿‡ç«¯å£ 80 æˆ– 443 å°†è®¸å¯è¯å¯†é’¥ä¼ è¾“è‡³portal.influxdata.comï¼Œå¹¶æ¥æ”¶ä¸€ä¸ªä¸´æ—¶çš„ JSON è®¸å¯è¯æ–‡ä»¶ã€‚æœåŠ¡å™¨ä¼šåœ¨æœ¬åœ°ç¼“å­˜è¯¥è®¸å¯è¯æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰æœ‰æ•ˆçš„è®¸å¯è¯æ–‡ä»¶ï¼Œæ•°æ®è¿›ç¨‹å°†åªèƒ½è¿è¡Œæœ‰é™æ—¶é—´ã€‚å¦‚æœæ‚¨çš„æœåŠ¡å™¨æ— æ³•ä¸https://portal.influxdata.comé€šä¿¡ï¼Œåˆ™å¿…é¡»ä½¿ç”¨license-pathè®¾ç½®ç¦»çº¿æˆæƒã€‚é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_ENTERPRISE_LICENSE_KEY license-pathæ‚¨ä» InfluxData æ”¶åˆ°çš„æ°¸ä¹… JSON è®¸å¯è¯æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„ï¼Œé€‚ç”¨äºæ— æ³•è®¿é—®äº’è”ç½‘çš„å®ä¾‹ã€‚å¦‚æœæ²¡æœ‰æœ‰æ•ˆçš„è®¸å¯è¯æ–‡ä»¶ï¼Œæ•°æ®å¤„ç†å°†åªèƒ½è¿è¡Œæœ‰é™çš„æ—¶é—´ã€‚å¦‚æœéœ€è¦è®¸å¯è¯æ–‡ä»¶ï¼Œè¯·è”ç³»sales@influxdb.com ã€‚è®¸å¯è¯æ–‡ä»¶åº”ä¿å­˜åœ¨é›†ç¾¤ä¸­çš„æ¯å°æœåŠ¡å™¨ä¸Šï¼ŒåŒ…æ‹¬å…ƒèŠ‚ç‚¹ã€æ•°æ®èŠ‚ç‚¹å’Œä¼ä¸šèŠ‚ç‚¹ã€‚è¯¥æ–‡ä»¶åŒ…å« JSON æ ¼å¼çš„è®¸å¯è¯ï¼Œå¹¶ä¸”å¿…é¡»å¯ä¾›influxdbç”¨æˆ·è¯»å–ã€‚é›†ç¾¤ä¸­çš„æ¯å°æœåŠ¡å™¨éƒ½ä¼šç‹¬ç«‹éªŒè¯å…¶è®¸å¯è¯ã€‚é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_ENTERPRISE_LICENSE_PATH Meta node MetaèŠ‚ç‚¹è®¾ç½®[meta] Data èŠ‚ç‚¹å¦‚ä½• Meta èŠ‚ç‚¹äº¤äº’ç›¸å…³çš„è®¾ç½®ã€‚dirå­˜å‚¨é›†ç¾¤å…ƒæ•°æ®çš„ç›®å½•ã€‚é»˜è®¤å€¼: \"/var/lib/influxdb/meta\" ç¯å¢ƒå˜é‡: INFLUXDB_META_DIR meta-tls-enabledè¿æ¥å…ƒèŠ‚ç‚¹æ—¶æ˜¯å¦ä½¿ç”¨ TLSé»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_META_TLS_ENABLED meta-insecure-tlså…è®¸ä¸å…ƒèŠ‚ç‚¹å»ºç«‹ä¸å®‰å…¨çš„ TLS è¿æ¥ã€‚è¿™åœ¨ä½¿ç”¨è‡ªç­¾åè¯ä¹¦è¿›è¡Œæµ‹è¯•æ—¶å¾ˆæœ‰ç”¨ã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_META_INSECURE_TLS meta-auth-enabledè¯¥é…ç½®å¿…é¡»ä¸ Meta èŠ‚ç‚¹çš„ç›¸åŒé…ç½®è®¾ç½®ä¸€æ ·çš„å€¼ã€‚ å¼€å¯ JWT è®¤è¯ï¼Œè¯¦è§å‚æ•° meta-internal-shared-secreté»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_META_AUTH_ENABLED meta-internal-shared-secretè¯¥é…ç½®å¿…é¡»ä¸ Meta èŠ‚ç‚¹çš„ç›¸åŒé…ç½®è®¾ç½®ä¸€æ ·çš„å€¼ã€‚ InfluxDB èŠ‚ç‚¹ä¹‹é—´ JWT èº«ä»½éªŒè¯çš„å†…éƒ¨ API ä½¿ç”¨çš„å…±äº«å¯†é’¥ã€‚é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_META_META_INTERNAL_SHARED_SECRET retention-autocreateè‡ªåŠ¨åˆ›å»ºä¿ç­–ç•¥ï¼Œé»˜è®¤ RP æŒç»­æ—¶é—´æ— é™ï¼Œåˆ†ç‰‡ç»„æŒç»­æ—¶é—´7å¤©ï¼Œå¤åˆ¶å› å­ä¸ºé›†ç¾¤ä¸­çš„æ•°æ®èŠ‚ç‚¹æ•°é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_META_RETENTION_AUTOCREATE logging-enabledæ˜¯å¦æ‰“å° Meta æœåŠ¡çš„æ—¥å¿—é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_META_LOGGING_ENABLED password-hashè¯¥é…ç½®å¿…é¡»ä¸ Meta èŠ‚ç‚¹çš„ç›¸åŒé…ç½®è®¾ç½®ä¸€æ ·çš„å€¼ã€‚ é…ç½®å¯†ç å“ˆå¸Œç®—æ³•ã€‚æ”¯æŒçš„é€‰é¡¹æœ‰ï¼šï¼ˆbcrypté»˜è®¤ï¼‰ã€pbkdf2-sha256ã€ å’Œpbkdf2-sha512ã€‚ æœ‰å…³è¯¦ç»†é…ç½®ä¿¡æ¯ï¼Œè¯·å‚é˜… meta.password-hashã€‚é»˜è®¤å€¼: bcrypt ç¯å¢ƒå˜é‡: INFLUXDB_META_PASSWORD_HASH ensure-fipså¯åŠ¨æ—¶æ˜¯å¦æ£€æŸ¥ Influx æ•°æ®å¹³å°æ˜¯å¦ç¬¦åˆ FIPS å®‰å…¨æ ‡å‡†é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_ENSURE_FIPS Data æ•°æ®[data] æ§åˆ¶ InfluxDB å®é™…åˆ†ç‰‡æ•°æ®çš„ä½ç½®ä»¥åŠå¦‚ä½•ä» WAL å‹ç¼©æ•°æ®ã€‚dirTSM å­˜å‚¨å¼•æ“å­˜å‚¨ TSMï¼ˆè¯»ä¼˜åŒ–ï¼‰æ–‡ä»¶çš„ç›®å½•ã€‚é»˜è®¤å€¼: \"/var/lib/influxdb/data\" ç¯å¢ƒå˜é‡: INFLUXDB_DATA_DIR wal-dirTSM å­˜å‚¨å¼•æ“å­˜å‚¨ WALï¼ˆå†™ä¼˜åŒ–ï¼‰æ–‡ä»¶çš„ç›®å½•ã€‚é»˜è®¤å€¼: \"/var/lib/influxdb/wal\" ç¯å¢ƒå˜é‡: INFLUXDB_DATA_WAL_DIR trace-logging-enabledè·Ÿè¸ªæ—¥å¿—è®°å½•æä¾›æœ‰å…³ TSM å¼•æ“çš„æ›´è¯¦ç»†è¾“å‡ºã€‚å¯ç”¨æ­¤åŠŸèƒ½å¯ä»¥ä¸ºè°ƒè¯• TSM å¼•æ“é—®é¢˜æä¾›æ›´æœ‰ç”¨çš„è¾“å‡ºã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_DATA_TRACE_LOGGING_ENABLED query-log-enabledæ˜¯å¦åº”åœ¨æ‰§è¡Œå‰è®°å½•æŸ¥è¯¢ã€‚è¿™å¯¹äºæ•…éšœæ’é™¤éå¸¸æœ‰ç”¨ï¼Œä½†ä¼šè®°å½•æŸ¥è¯¢ä¸­åŒ…å«çš„ä»»ä½•æ•æ„Ÿæ•°æ®ã€‚é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_DATA_QUERY_LOG_ENABLED query-log-pathæŸ¥è¯¢æ—¥å¿—æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚é»˜è®¤å€¼ä¸º\"\"ï¼ˆæŸ¥è¯¢ä¸ä¼šè®°å½•åˆ°æ–‡ä»¶ä¸­ï¼‰ã€‚ æŸ¥è¯¢æ—¥å¿—è®°å½•æ”¯æŒåŸºäº SIGHUP çš„æ—¥å¿—è½®æ¢ã€‚ ä¸‹é¢æ˜¯ä¸€ä¸ª logrotate é…ç½®ç¤ºä¾‹:/var/log/influxdb/queries.log { rotate 5 daily compress missingok notifempty create 644 root root postrotate /bin/kill -HUP `pgrep -x influxd` endscript } é»˜è®¤å€¼: \"\" wal-fsync-delayå†™å…¥æ“ä½œåœ¨ fsync ä¹‹å‰ç­‰å¾…çš„æ—¶é—´ã€‚ä½¿ç”¨å¤§äº 0 çš„æŒç»­æ—¶é—´å¯ä»¥æ‰¹é‡æ‰§è¡Œå¤šä¸ª fsync è°ƒç”¨ã€‚è¿™å¯¹äºé€Ÿåº¦è¾ƒæ…¢çš„ç£ç›˜æˆ–é‡åˆ° WAL å†™å…¥äº‰ç”¨æ—¶éå¸¸æœ‰ç”¨ã€‚å€¼ä¸º 0s æ—¶ï¼Œæ¯æ¬¡å†™å…¥ WAL æ—¶éƒ½ä¼šè¿›è¡Œ fsyncã€‚å¯¹äºé SSD ç£ç›˜ï¼ŒInfluxData å»ºè®®ä½¿ç”¨ä»‹äº 0ms åˆ° 100ms ä¹‹é—´çš„å€¼ã€‚é»˜è®¤å€¼: \"0s\" ç¯å¢ƒå˜é‡: INFLUXDB_DATA_WAL_FSYNC_DELAY ingress-metric-by-measurement-enabledæ”¶é›†æ¯æ¬¡æµ‹é‡çš„ç‚¹ã€å€¼å’Œæ–°å†™å…¥åºåˆ—çš„ç»Ÿè®¡ä¿¡æ¯ã€‚æŒ‡æ ‡æŒ‰æ•°æ®èŠ‚ç‚¹æ”¶é›†ã€‚è¿™äº›æŒ‡æ ‡å¯ä»¥é€šè¿‡/debug/varsç«¯ç‚¹è®¿é—®ï¼Œå¦‚æœå¯ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨_internalæ•°æ®åº“ä¸­è®¿é—®ã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_DATA_INGRESS_METRIC_BY_MEASUREMENT_ENABLED ingress-metric-by-login-enabledæ”¶é›†æ¯æ¬¡ç™»å½•æ—¶ç‚¹ã€å€¼å’Œæ–°å†™å…¥åºåˆ—çš„ç»Ÿè®¡ä¿¡æ¯ã€‚æŒ‡æ ‡æŒ‰æ•°æ®èŠ‚ç‚¹æ”¶é›†ã€‚è¿™äº›æŒ‡æ ‡å¯ä»¥é€šè¿‡/debug/varsç«¯ç‚¹è®¿é—®ï¼Œ_internalå¦‚æœå¯ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨æ•°æ®åº“ä¸­è®¿é—®ã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_DATA_INGRESS_METRIC_BY_LOGIN_ENABLED TSMå¼•æ“çš„æ•°æ®è®¾ç½®cache-max-memory-sizeåˆ†ç‰‡ç¼“å­˜åœ¨å¼€å§‹æ‹’ç»å†™å…¥ä¹‹å‰å¯ä»¥è¾¾åˆ°çš„æœ€å¤§å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚ å¦‚æœé‡åˆ° cache maximum memory size exceeded é”™è¯¯ï¼Œè¯·è€ƒè™‘å¢åŠ æ­¤å€¼ã€‚é»˜è®¤å€¼: 1000000000 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_CACHE_MAX_MEMORY_SIZE cache-snapshot-memory-sizeTSM å¼•æ“å°†å¯¹ç¼“å­˜è¿›è¡Œå¿«ç…§å¹¶å°†å…¶å†™å…¥ TSM æ–‡ä»¶ä»¥é‡Šæ”¾å†…å­˜çš„å­—èŠ‚å¤§å°ã€‚é»˜è®¤å€¼: 26214400 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_CACHE_SNAPSHOT_MEMORY_SIZE cache-snapshot-write-cold-durationå¦‚æœåˆ†ç‰‡å°šæœªæ”¶åˆ°å†™å…¥æˆ–åˆ é™¤ï¼ŒTSM å¼•æ“å°†å¯¹ç¼“å­˜è¿›è¡Œå¿«ç…§å¹¶å°†å…¶å†™å…¥æ–°çš„ TSM æ–‡ä»¶çš„æ—¶é—´é•¿åº¦ã€‚é»˜è®¤å€¼: \"10m\" ç¯å¢ƒå˜é‡: INFLUXDB_DATA_CACHE_SNAPSHOT_WRITE_COLD_DURATION max-concurrent-compactionsä¸€æ¬¡å¯è¿è¡Œçš„æœ€å¤§å¹¶å‘å®Œæ•´å‹ç¼©å’Œå±‚çº§å‹ç¼©æ•°é‡ã€‚è®¾ç½®ä¸º 0 æ—¶ä½¿ç”¨ 50% çš„ runtime.GOMAXPROCS(0)ï¼Œå³ 50% CPUã€‚æ­¤è®¾ç½®ä¸é€‚ç”¨äºç¼“å­˜å¿«ç…§ã€‚é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_CACHE_MAX_CONCURRENT_COMPACTIONS compact-throughputTSM å‹ç¼©æ¯ç§’å†™å…¥ç£ç›˜çš„æœ€å¤§å­—èŠ‚æ•°ã€‚è¯·æ³¨æ„ï¼Œå…è®¸çŸ­æ—¶é—´çªå‘å†™å…¥ï¼Œä½†å¯èƒ½å­˜åœ¨æ›´å¤§çš„å€¼ï¼Œå…·ä½“å€¼ç”± compact-throughput-burst è®¾å®šã€‚é»˜è®¤å€¼: 50331648 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_COMPACT_THROUGHPUT compact-throughput-burstTSM å‹ç¼©åœ¨çŸ­æš‚çªå‘æƒ…å†µä¸‹æ¯ç§’å†™å…¥ç£ç›˜çš„æœ€å¤§å­—èŠ‚æ•°ã€‚é»˜è®¤å€¼: 50331648 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_COMPACT_THROUGHPUT_BURST compact-full-write-cold-durationå¦‚æœå°šæœªæ”¶åˆ°å†™å…¥æˆ–åˆ é™¤ï¼Œåˆ™å‹ç¼©åˆ†ç‰‡ä¸­æ‰€æœ‰ TSM å’Œ TSI æ–‡ä»¶çš„æŒç»­æ—¶é—´ã€‚é»˜è®¤å€¼: \"4h\" ç¯å¢ƒå˜é‡: INFLUXDB_DATA_COMPACT_FULL_WRITE_COLD_DURATION index-versionç”¨äºæ–°åˆ†ç‰‡çš„åˆ†ç‰‡ç´¢å¼•ç±»å‹ã€‚é»˜è®¤å€¼ (inmem) è¡¨ç¤ºå¯åŠ¨é‡æ–°åˆ›å»º in-memory ç´¢å¼•ã€‚å€¼ä¸º tsi1 æ—¶ï¼Œå°†ä½¿ç”¨æ”¯æŒé«˜åŸºæ•°æ•°æ®é›†çš„ç£ç›˜ç´¢å¼•ã€‚é»˜è®¤å€¼: \"inmem\" ç¯å¢ƒå˜é‡: INFLUXDB_DATA_INDEX_VERSION inmem ç´¢å¼•è®¾ç½®max-series-per-databaseæ¯ä¸ªæ•°æ®åº“çš„ series æœ€å¤§æ•°é‡ï¼Œ0 ä¸ºä¸é™åˆ¶ã€‚ å¦‚æœæŸä¸ªç‚¹å¯¼è‡´æ•°æ®åº“ä¸­çš„ç³»åˆ—æ•°é‡è¶…è¿‡ max-series-per-databaseï¼Œåˆ™ InfluxDB å°†ä¸ä¼šå†™å…¥è¯¥ç‚¹ï¼Œå¹¶è¿”å› 500ä»¥ä¸‹é”™è¯¯ï¼š{\"error\":\"max series per database exceeded: \"} å¯¹äºæ•°é‡è¶…è¿‡æ­¤é™åˆ¶çš„ç°æœ‰æ•°æ®åº“å°†ç»§ç»­æ¥å—å¯¹ç°æœ‰ series çš„å†™å…¥ï¼Œä½†ä¼šåˆ›å»ºæ–° series çš„å†™å…¥å°†å¤±è´¥ã€‚é»˜è®¤å€¼: 1000000 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_MAX_SERIES_PER_DATABASE max-values-per-tagæ¯ä¸ªæ ‡ç­¾é”®å…è®¸çš„æœ€å¤§æ ‡ç­¾å€¼æ•°é‡ï¼Œ0 ä¸ºä¸é™åˆ¶ã€‚ ä»»ä½•æ ‡ç­¾å€¼è¶…å‡ºæ­¤é™åˆ¶æ—¶å°†ç»§ç»­æ¥å—å†™å…¥ï¼Œä½†åˆ›å»ºæ–°æ ‡ç­¾å€¼çš„å†™å…¥å°†å¤±è´¥ã€‚é»˜è®¤å€¼: 10000 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_MAX_VALUES_PER_TAG TSIï¼ˆtsi1ï¼‰æŒ‡æ•°è®¾ç½®max-index-log-file-sizeç´¢å¼•é¢„å†™æ—¥å¿— (WAL) æ–‡ä»¶å‹ç¼©æˆç´¢å¼•æ–‡ä»¶çš„é˜ˆå€¼ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚è¾ƒå°çš„å¤§å°å°†å¯¼è‡´æ—¥å¿—æ–‡ä»¶å‹ç¼©å¾—æ›´å¿«ï¼Œä»è€Œé™ä½å †ä½¿ç”¨ç‡ï¼Œä½†ä¼šé™ä½å†™å…¥ååé‡ã€‚è¾ƒå¤§çš„å¤§å°å°†å‡å°‘å‹ç¼©é¢‘ç‡ï¼Œåœ¨å†…å­˜ä¸­å­˜å‚¨æ›´å¤šåºåˆ—ï¼Œå¹¶æä¾›æ›´é«˜çš„å†™å…¥ååé‡ã€‚æœ‰æ•ˆçš„å¤§å°åç¼€ä¸ºkã€mã€ æˆ–gï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼Œ1024 = 1kï¼‰ã€‚æ²¡æœ‰å¤§å°åç¼€çš„å€¼ä»¥å­—èŠ‚ä¸ºå•ä½ã€‚é»˜è®¤å€¼: 1048576 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_MAX_INDEX_LOG_FILE_SIZE series-id-set-cache-sizeTSI ç´¢å¼•ä¸­ç”¨äºå­˜å‚¨å…ˆå‰è®¡ç®—çš„åºåˆ—ç»“æœçš„å†…éƒ¨ç¼“å­˜å¤§å°ã€‚ç¼“å­˜ç»“æœå°†ä»ç¼“å­˜ä¸­å¿«é€Ÿè¿”å›ï¼Œè€Œæ— éœ€åœ¨æ‰§è¡Œåç»­æŸ¥è¯¢æ—¶é‡æ–°è®¡ç®—ã€‚å°†æ­¤å€¼è®¾ç½®ä¸º0å°†ç¦ç”¨ç¼“å­˜ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æŸ¥è¯¢æ€§èƒ½é—®é¢˜ã€‚ä»…å½“å·²çŸ¥æ•°æ®åº“æ‰€æœ‰æµ‹é‡ä¸­å¸¸ç”¨çš„æ ‡ç­¾é”®å€¼è°“è¯é›†åˆå¤§äº 100 æ—¶ï¼Œæ‰åº”å¢åŠ æ­¤å€¼ã€‚å¢åŠ ç¼“å­˜å¤§å°å¯èƒ½ä¼šå¯¼è‡´å †ä½¿ç”¨ç‡å¢åŠ ã€‚é»˜è®¤å€¼: 100 ç¯å¢ƒå˜é‡: INFLUXDB_DATA_SERIES_ID_SET_CACHE_SIZE Cluster é›†ç¾¤[cluster] æ•°æ®èŠ‚ç‚¹å¦‚ä½•ç›¸äº’é€šä¿¡ã€å¦‚ä½•è·¨åˆ†ç‰‡å…±äº«æ•°æ®ä»¥åŠå¦‚ä½•ç®¡ç† InfluxQL æŸ¥è¯¢ç›¸å…³çš„è®¾ç½®ã€‚ InfluxDB Enterprise é›†ç¾¤ä½¿ç”¨è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ (RPC) è¿›è¡ŒèŠ‚ç‚¹é—´é€šä¿¡ã€‚RPC è¿æ¥æ± ç®¡ç†æµè¿æ¥å¹¶é«˜æ•ˆåˆ©ç”¨ç³»ç»Ÿèµ„æºã€‚InfluxDB æ•°æ®èŠ‚ç‚¹é€šè¿‡å•ä¸ª TCP è¿æ¥å¤šè·¯å¤ç”¨ RPC æµï¼Œä»¥é¿å…é¢‘ç¹å»ºç«‹å’Œé”€æ¯ TCP è¿æ¥ä»¥åŠè€—å°½ä¸´æ—¶ç«¯å£çš„å¼€é”€ã€‚é€šå¸¸ï¼Œä¸€ä¸ªæ•°æ®èŠ‚ç‚¹ä¼šä¸å…¶ä»–æ¯ä¸ªæ•°æ®èŠ‚ç‚¹å»ºç«‹å•ä¸ªæŒä¹… TCP è¿æ¥æ¥æ‰§è¡Œå¤§å¤šæ•° RPC è¯·æ±‚ã€‚åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œä¾‹å¦‚å¤åˆ¶åˆ†ç‰‡æ—¶ï¼Œå¯èƒ½ä¼šä½¿ç”¨ä¸€æ¬¡æ€§ TCP è¿æ¥ã€‚dial-timeoutMeta èŠ‚ç‚¹åœ¨å°è¯•è¿æ¥åˆ°ä¸€ä¸ª Data èŠ‚ç‚¹çš„è¶…æ—¶ã€‚æ­¤è®¾ç½®ä»…é€‚ç”¨äºæŸ¥è¯¢ã€‚é»˜è®¤å€¼: \"1s\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_DIAL_TIMEOUT pool-max-idle-timeè¿æ¥åˆ°å…¶ä»–æ•°æ®èŠ‚ç‚¹çš„ TCP è¿æ¥åœ¨è¿æ¥æ± ä¸­ä¿æŒç©ºé—²çš„æœ€é•¿æ—¶é—´ã€‚å½“è¿æ¥ç©ºé—²æ—¶é—´è¶…è¿‡æŒ‡å®šæ—¶é•¿æ—¶ï¼Œç³»ç»Ÿä¼šå›æ”¶ï¼ˆé€€å½¹æˆ–å›æ”¶ï¼‰éæ´»åŠ¨è¿æ¥ï¼Œä»¥é˜²æ­¢è¿æ¥æ± ä¸­å……æ»¡éæ´»åŠ¨è¿æ¥ã€‚å›æ”¶ç©ºâ€‹â€‹é—²è¿æ¥å¯ä»¥æœ€å¤§é™åº¦åœ°å‡å°‘éæ´»åŠ¨è¿æ¥æ•°é‡ï¼Œé™ä½ç³»ç»Ÿè´Ÿè½½ï¼Œå¹¶é˜²æ­¢ç³»ç»Ÿæ•…éšœã€‚é»˜è®¤å€¼: \"60s\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_POOL_MAX_IDLE_TIME pool-max-idle-streamsä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´ç©ºé—²æ± ä¸­ä¿ç•™çš„æœ€å¤§ç©ºé—² RPC æµè¿æ¥æ•°ã€‚å‘å‡ºæ–°çš„ RPC è¯·æ±‚æ—¶ï¼Œç³»ç»Ÿä¼šä¸´æ—¶ä»ç©ºé—²æ± ä¸­æ‹‰å–ä¸€ä¸ªè¿æ¥ï¼Œä½¿ç”¨åå†å½’è¿˜ã€‚å¦‚æœç©ºé—²æ± å·²æ»¡ï¼Œä¸”ä¸å†éœ€è¦æŸä¸ªæµè¿æ¥ï¼Œç³»ç»Ÿå°†å…³é—­è¯¥æµè¿æ¥ï¼Œå¹¶å°†èµ„æºé‡Šæ”¾ã€‚æ´»åŠ¨æµçš„æ•°é‡å¯ä»¥è¶…è¿‡æœ€å¤§ç©ºé—²æ± è¿æ¥æ•°ï¼Œä½†åœ¨é‡Šæ”¾åä¸ä¼šå½’è¿˜åˆ°ç©ºé—²æ± ä¸­ã€‚åˆ›å»ºæµçš„æ“ä½œç›¸å¯¹æ¥è¯´æˆæœ¬è¾ƒä½ï¼Œå› æ­¤æ›´æ”¹æ­¤å€¼ä¸å¤ªå¯èƒ½æ˜¾è‘—æå‡ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„æ€§èƒ½ã€‚é»˜è®¤å€¼: 100 ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_POOL_MAX_IDLE_STREAMS allow-out-of-order-writeså†™å…¥æ“ä½œå°†æŒ‰æ¥æ”¶é¡ºåºå¤„ç†ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæŸä¸ªåˆ†ç‰‡çš„æç¤ºåˆ‡æ¢ (HH) é˜Ÿåˆ—ä¸­å­˜åœ¨ä»»ä½•æ•°æ®ç‚¹ï¼Œåˆ™æ‰€æœ‰ä¼ å…¥çš„æ•°æ®ç‚¹éƒ½å¿…é¡»è¿›å…¥ HH é˜Ÿåˆ—ã€‚ å¦‚æœä¸º trueï¼Œå†™å…¥æ“ä½œçš„å¤„ç†é¡ºåºå¯èƒ½ä¸æ¥æ”¶é¡ºåºä¸åŒã€‚è¿™å¯ä»¥å‡å°‘æ¸…ç©º HH é˜Ÿåˆ—æ‰€éœ€çš„æ—¶é—´ï¼Œå¹¶æé«˜æ¢å¤æœŸé—´çš„ååé‡ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´ç‚¹è¢«è¦†ç›–ã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_ALLOW_OUT_OF_ORDER shard-reader-timeoutåˆ†ç‰‡è¯»å–å™¨ä¸Šè®¾ç½®çš„é»˜è®¤è¶…æ—¶æ—¶é—´ã€‚æŸ¥è¯¢è¿æ¥å¿…é¡»åœ¨æ­¤æ—¶é—´åè¿”å›å“åº”ï¼Œå¦åˆ™ç³»ç»Ÿå°†è¿”å›é”™è¯¯ã€‚é»˜è®¤å€¼: \"0\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_SHARD_READER_TIMEOUT https-enabledData èŠ‚ç‚¹é—´é€šä¿¡å¯ç”¨ httpsé»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_HTTPS_ENABLED https-certificatehttps è¯ä¹¦ä½ç½®é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_HTTPS_CERTIFICATE https-private-keyhttps ç§é’¥ä½ç½®é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_HTTPS_PRIVATE_KEY https-insecure-tlsæ•°æ®èŠ‚ç‚¹é€šè¿‡ HTTPS ç›¸äº’é€šä¿¡æ—¶æ˜¯å¦è·³è¿‡è¯ä¹¦éªŒè¯ã€‚è¿™åœ¨ä½¿ç”¨è‡ªç­¾åè¯ä¹¦è¿›è¡Œæµ‹è¯•æ—¶å¾ˆæœ‰ç”¨ã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_HTTPS_INSECURE_TLS cluster-tracingå¯ç”¨é›†ç¾¤è·Ÿè¸ªæ—¥å¿—è®°å½•ã€‚è®¾ç½®ä¸ºtrueå¯å¯ç”¨é›†ç¾¤é€šä¿¡æ—¥å¿—è®°å½•ã€‚å¯ç”¨æ­¤è®¾ç½®å¯éªŒè¯æ•°æ®èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥é—®é¢˜ã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_CLUSTER_TRACING write-timeoutå†™å…¥è¶…æ—¶é»˜è®¤å€¼: \"10s\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_WRITE_TIMEOUT max-concurrent-queriesæœ€å¤§æŸ¥è¯¢å¹¶å‘é»˜è®¤å€¼: \"0\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_MAX_CONCURRENT_QUERIES max-concurrent-deletesæœ€å¤§åˆ é™¤å¹¶å‘é»˜è®¤å€¼: 1 ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_MAX_CONCURRENT_DELETES query-timeoutæŸ¥è¯¢è¶…æ—¶é»˜è®¤å€¼: \"0s\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_QUERY_TIMEOUT log-queries-afteræŸ¥è¯¢è¢«è®°å½•ä¸ºæ…¢æŸ¥è¯¢çš„æ—¶é—´é˜ˆå€¼ã€‚é»˜è®¤å€¼: \"0s\" ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_LOG_QUERIES_AFTER log-timedout-queriesè®°å½•è¶…æ—¶è¢«ç»ˆæ­¢çš„æŸ¥è¯¢é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_LOG_TIMEDOUT_QUERIES max-select-pointæœ€å¤§æŸ¥è¯¢ç‚¹æ•°é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_MAX_SELECT_POINT max-select-seriesæœ€å¤§æŸ¥è¯¢ç³»åˆ—æ•°é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_MAX_SELECT_SERIES max-select-bucketsæœ€å¤§ç”¨äºèšåˆçš„æ¡¶æ•°é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_MAX_SELECT_BUCKETS termination-query-logç»ˆæ­¢æœåŠ¡æ—¶æ‰“å°å½“å‰æ­£åœ¨è¿è¡Œçš„æŸ¥è¯¢é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_CLUSTER_TERMINATION_QUERY_LOG Retention ä¿ç•™ç­–ç•¥[retention] æ§åˆ¶æ—§æ•°æ®æ¸…ç†çš„ä¿ç•™ç­–ç•¥çš„æ‰§è¡Œenabledæ˜¯å¦å¯ç”¨é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_RETENTION_ENABLED check-intervalæ£€æŸ¥é—´éš”é»˜è®¤å€¼: \"30m0s\" ç¯å¢ƒå˜é‡: INFLUXDB_RETENTION_CHECK_INTERVAL Hinted Handoff ç¼“å­˜é˜Ÿåˆ—[hinted-handoff] æ§åˆ¶ç¼“å­˜é˜Ÿåˆ—ï¼Œå½“æ•°æ®èŠ‚ç‚¹æ— æ³•è®¿é—®æ—¶ï¼Œè¯¥é˜Ÿåˆ—å…è®¸æ•°æ®èŠ‚ç‚¹ä¸´æ—¶ç¼“å­˜å‘å¾€å¦ä¸€ä¸ªæ•°æ®èŠ‚ç‚¹çš„å†™å…¥batch-sizeå•ä¸ªè¯·æ±‚ä¸­å†™å…¥åˆ†ç‰‡çš„æœ€å¤§å­—èŠ‚æ•°ã€‚é»˜è®¤å€¼: 512000 ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_BATCH_SIZE max-writes-pendingç¼“å­˜é˜Ÿåˆ—å…è®¸çš„æœ€å¤§å¾…å¤„ç†æ•°é»˜è®¤å€¼: 1024 ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_MAX_WRITES_PENDING dirç¼“å­˜é˜Ÿåˆ—å­˜å‚¨è·¯å¾„é»˜è®¤å€¼: \"/var/lib/influxdb/hh\" ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_DIR enabledæ˜¯å¦å¯ç”¨ç¼“å­˜é˜Ÿåˆ—é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_ENABLED max-sizeæœ€å¤§å®¹é‡é»˜è®¤å€¼: 10737418240 ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_MAX_SIZE max-ageæœ€å¤§å¹´é¾„é»˜è®¤å€¼: \"168h0m0s\" ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_MAX_AGE retry-concurrencyå¾€ä¸€ä¸ªèŠ‚ç‚¹å†™å…¥å—çš„å¹¶å‘æ•°é»˜è®¤å€¼: 20 ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_RETRY_CONCURRENCY retry-rate-limité‡è¯•é€Ÿç‡é™åˆ¶é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_RETRY_RATE_LIMIT retry-intervalé‡è¯•é—´éš”ï¼Œå­˜åœ¨æŒ‡æ•°é€€é¿ï¼Œä¸€ç›´å¢åŠ è‡³ retry-max-intervalé»˜è®¤å€¼: \"1s\" ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_RETRY_INTERVAL retry-max-intervalé‡è¯•å¤±è´¥æŒ‡æ•°é€€é¿æœ€å¤§é—´éš”é»˜è®¤å€¼: \"200s\" ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_RETRY_MAX_INTERVAL purge-intervalç¼“å­˜é˜Ÿåˆ—è¿‡æœŸæ¸…ç†é—´éš”é»˜è®¤å€¼: \"1m0s\" ç¯å¢ƒå˜é‡: INFLUXDB_HINTED_HANDOFF_PURGE_INTERVAL Anti-Entropy åç†µ[anti-entropy] æ§åˆ¶åˆ†ç‰‡çš„å¤åˆ¶å’Œä¿®å¤ï¼Œä»¥ç¡®ä¿æ•°æ®èŠ‚ç‚¹åŒ…å«åº”æœ‰çš„åˆ†ç‰‡æ•°æ®enabledæ˜¯å¦å¯ç”¨é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_ANTI_ENTROPY_ENABLED check-intervalæ£€æŸ¥é—´éš”é»˜è®¤å€¼: \"5m\" ç¯å¢ƒå˜é‡: INFLUXDB_ANTI_ENTROPY_CHECK_INTERVAL max-fetchå•ä¸ªæ•°æ®èŠ‚ç‚¹å¯ä»¥å¹¶è¡Œå¤åˆ¶æˆ–ä¿®å¤çš„æœ€å¤§åˆ†ç‰‡æ•°é»˜è®¤å€¼: 10 ç¯å¢ƒå˜é‡: INFLUXDB_ANTI_ENTROPY_MAX_FETCH max-syncæœ€å¤§åŒæ­¥å¹¶å‘æ•°é»˜è®¤å€¼: 1 ç¯å¢ƒå˜é‡: INFLUXDB_ANTI_ENTROPY_MAX_SYNC auto-repair-missingè‡ªåŠ¨ä¿®å¤ç¼ºå¤±åˆ†ç‰‡é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_ANTI_ENTROPY_AUTO_REPAIR_MISSING Shard precreation åˆ†ç‰‡é¢„åˆ›å»º[shard-precreation] æ§åˆ¶åˆ†ç‰‡çš„é¢„åˆ›å»ºï¼Œä½¿å…¶åœ¨æ•°æ®åˆ°è¾¾ä¹‹å‰å¯ç”¨ã€‚åªæœ‰åˆ›å»ºåå¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´éƒ½åœ¨æœªæ¥æ—¶é—´çš„åˆ†ç‰‡æ‰ä¼šè¢«åˆ›å»ºã€‚æ°¸è¿œä¸ä¼šé¢„å…ˆåˆ›å»ºå®Œå…¨æˆ–éƒ¨åˆ†å¤„äºè¿‡å»æ—¶é—´çš„åˆ†ç‰‡ã€‚enabledæ˜¯å¦å¯ç”¨é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_SHARD_PRECREATION_ENABLED check-intervalæ£€æŸ¥é—´éš”é»˜è®¤å€¼: \"10m\" ç¯å¢ƒå˜é‡: INFLUXDB_SHARD_PRECREATION_CHECK_INTERVAL advance-periodåœ¨åˆ†ç‰‡ç»„ç»“æŸæ—¶é—´ä¹‹å‰åˆ›å»ºå…¶åç»§ç»„çš„æå‰æ—¶é—´æ®µã€‚é»˜è®¤å€¼: \"30m\" ç¯å¢ƒå˜é‡: INFLUXDB_SHARD_PRECREATION_ADVANCE_PERIOD Monitor ç›‘æ§[monitor] é»˜è®¤æƒ…å†µä¸‹ï¼ŒInfluxDB ä¼šå°†ç³»ç»Ÿç›‘æ§æ•°æ®å†™å…¥ _internal æ•°æ®åº“ã€‚å¦‚æœè¯¥æ•°æ®åº“ä¸å­˜åœ¨ï¼ŒInfluxDB ä¼šè‡ªåŠ¨åˆ›å»ºã€‚_internal æ•°æ®åº“çš„ä¿ç•™ç­–ç•¥ä¸º 7 å¤©ã€‚è¦æ›´æ”¹é»˜è®¤çš„ 7 å¤©ä¿ç•™ç­–ç•¥ï¼Œæ‚¨å¿…é¡»åˆ›å»ºè¯¥æ•°æ®åº“ã€‚å¯¹äº InfluxDB Enterprise ç”Ÿäº§ç³»ç»Ÿï¼ŒInfluxData å»ºè®®åŒ…å«ä¸€ä¸ªä¸“ç”¨çš„ InfluxDB (OSS) ç›‘æ§å®ä¾‹æ¥ç›‘æ§ InfluxDB Enterprise é›†ç¾¤èŠ‚ç‚¹ã€‚åœ¨ä¸“ç”¨çš„ InfluxDB ç›‘æ§å®ä¾‹ä¸Šè¿›è¡Œè®¾ç½®store-enabled = falseä»¥é¿å…æ½œåœ¨çš„æ€§èƒ½å’Œå­˜å‚¨é—®é¢˜ã€‚ åœ¨æ¯ä¸ª InfluxDB é›†ç¾¤èŠ‚ç‚¹ä¸Šï¼Œå®‰è£…ä¸€ä¸ª Telegraf è¾“å…¥æ’ä»¶å’Œ Telegraf è¾“å‡ºæ’ä»¶ï¼Œé…ç½®ä¸ºå°†æ•°æ®æŠ¥å‘Šç»™ä¸“ç”¨çš„ InfluxDB ç›‘æ§å®ä¾‹ã€‚ store-enabledæ˜¯å¦å­˜å‚¨ç›‘æ§æ•°æ®é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_MONITOR_STORE_ENABLED store-databaseå­˜å‚¨æ•°æ®åº“é»˜è®¤å€¼: \"_internal\" ç¯å¢ƒå˜é‡: INFLUXDB_MONITOR_STORE_DATABASE store-intervalå­˜å‚¨é—´éš”é»˜è®¤å€¼: \"10s\" ç¯å¢ƒå˜é‡: INFLUXDB_MONITOR_STORE_INTERVAL remote-collect-intervalæ”¶é›†é—´éš”é»˜è®¤å€¼: \"10s\" ç¯å¢ƒå˜é‡: INFLUXDB_MONITOR_REMOTE_COLLECT_INTERVAL HTTP endpoints HTTPç«¯ç‚¹[http] æ§åˆ¶å¦‚ä½•é…ç½® HTTP ç«¯ç‚¹ã€‚è¿™äº›æ˜¯å°†æ•°æ®ä¼ å…¥å’Œä¼ å‡º InfluxDB çš„ä¸»è¦æœºåˆ¶ã€‚enabledæ˜¯å¦å¯ç”¨é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_ENABLED flux-enabledæ˜¯å¦å¯ç”¨ flux è¯­æ³•æŸ¥è¯¢é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_FLUX_ENABLED bind-addressç›‘å¬åœ°å€é»˜è®¤å€¼: \":8086\" ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_BIND_ADDRESS auth-enabledæ˜¯å¦å¼€å¯è®¤è¯é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_AUTH_ENABLED realmå‘å‡ºåŸºæœ¬æˆæƒè´¨è¯¢æ—¶å‘å›çš„é»˜è®¤é¢†åŸŸé»˜è®¤å€¼: \"InfluxDB\" ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_REALM log-enabledæ˜¯å¦å¯ç”¨é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_LOG_ENABLED suppress-write-logæŠ‘åˆ¶å†™å…¥æ—¥å¿—ï¼Œé™ä½æ—¥å¿—è®°å½•é‡é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_SUPPRESS_WRITE_LOG access-log-pathæ—¥å¿—è·¯å¾„ï¼ŒæœªæŒ‡å®šæˆ–è€…æ— æ³•è®¿é—®æ—¶å†™å…¥ stderré»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_ACCESS_LOG_PATH access-log-status-filtersè®¿é—®æ—¥å¿—æ ¹æ®çŠ¶æ€ç è¿‡æ»¤ï¼Œç¤ºä¾‹ï¼š[200, 5xx]é»˜è®¤å€¼: [] ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_ACCESS_LOG_STATUS_FILTERS_0 INFLUXDB_HTTP_ACCESS_LOG_STATUS_FILTERS_1 write-tracingæ˜¯å¦å¼€å¯å†™å…¥è¯¦ç»†æ—¥å¿—é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_WRITE_TRACING pprof-enabledæ˜¯å¦å¼€å¯ pprofé»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_PPROF_ENABLED https-enabledæ˜¯å¦å¼€å¯ httpsé»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_HTTPS_ENABLED https-certificatehttps è¯ä¹¦é»˜è®¤å€¼: \"/etc/ssl/influxdb.pem\" ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_HTTPS_CERTIFICATE https-private-keyhttps ç§é’¥é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_HTTPS_PRIVATE_KEY shared-secretå…±äº«å¯†é’¥ï¼ŒJWT æˆæƒå…±äº«å¯†é’¥ç”¨äºä½¿ç”¨ JSON Web ä»¤ç‰Œ (JWT) éªŒè¯è¯·æ±‚ã€‚é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_SHARED_SECRET max-body-sizeå®¢æˆ·ç«¯è¯·æ±‚æ­£æ–‡çš„æœ€å¤§å¤§å°ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½ï¼‰ã€‚å½“ HTTP å®¢æˆ·ç«¯å‘é€çš„æ•°æ®è¶…è¿‡é…ç½®çš„æœ€å¤§å¤§å°æ—¶ï¼Œå°†è¿”å› 413 Request Entity Too Large HTTP å“åº”ã€‚è¦ç¦ç”¨æ­¤é™åˆ¶ï¼Œè¯·å°†å€¼è®¾ç½®ä¸º0ã€‚é»˜è®¤å€¼: 25000000 ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_MAX_BODY_SIZE max-row-limitæŸ¥è¯¢è¿”å›çš„æœ€å¤§è¡Œæ•°é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_MAX_ROW_LIMIT max-connection-limitæœ€å¤§è¿æ¥æ•°é™åˆ¶é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_MAX_CONNECTION_LIMIT unix-socket-enabledä½¿ç”¨ UNIX domain socket å¯ç”¨ http æœåŠ¡é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_UNIX_SOCKET_ENABLED bind-socketUNIX domain socket è·¯å¾„é»˜è®¤å€¼: \"/var/run/influxdb.sock\" ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_BIND_SOCKET max-concurrent-write-limitæœ€å¤§å¹¶å‘å†™å…¥é™åˆ¶é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_MAX_CONCURRENT_WRITE_LIMIT max-enqueued-write-limitæœ€å¤§å†™å…¥é˜Ÿåˆ—é™åˆ¶é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_MAX_ENQUEUED_WRITE_LIMIT enqueued-write-timeoutå†™å…¥ç­‰å¾…è¶…æ—¶é™åˆ¶é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_HTTP_ENQUEUED_WRITE_TIMEOUT Logging æ—¥å¿—[logging]formatç¡®å®šç”¨äºæ—¥å¿—çš„æ—¥å¿—ç¼–ç å™¨ã€‚æœ‰æ•ˆé€‰é¡¹ä¸º autoã€logfmt å’Œ jsonã€‚å¦‚æœè¾“å‡ºç»ˆç«¯æ˜¯ TTYï¼Œåˆ™è®¾ç½®ä¸º auto ä¼šä½¿ç”¨æ›´ç”¨æˆ·å‹å¥½çš„è¾“å‡ºæ ¼å¼ï¼Œä½†è¯¥æ ¼å¼ä¸æ˜“è¢«æœºå™¨è¯»å–ã€‚å½“è¾“å‡ºç»ˆç«¯ä¸ºé TTY æ—¶ï¼Œauto å°†ä½¿ç”¨logfmtã€‚é»˜è®¤å€¼: \"logfmt\" ç¯å¢ƒå˜é‡: INFLUXDB_LOGGING_FORMAT levelæ—¥å¿—ç­‰çº§é»˜è®¤å€¼: \"info\" ç¯å¢ƒå˜é‡: INFLUXDB_LOGGING_LEVEL suppress-logoå…³é—­ç¨‹åºå¯åŠ¨æ—¶çš„ logo æ‰“å°é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_LOGGING_SUPPRESS_LOGO Subscriber è®¢é˜…[subscriber] æ§åˆ¶è®¢é˜…ï¼Œå¯ç”¨äºåˆ†å‰ InfluxDB ä¸»æœºæ¥æ”¶çš„æ‰€æœ‰æ•°æ®çš„å‰¯æœ¬ã€‚enabledæ˜¯å¦å¯ç”¨é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_SUBSCRIBER_ENABLED http-timeouthttp è¶…æ—¶é»˜è®¤å€¼: \"30s\" ç¯å¢ƒå˜é‡: INFLUXDB_SUBSCRIBER_HTTP_TIMEOUT insecure-skip-verifyå…è®¸ä¸å®‰å…¨çš„ https è¿æ¥é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_SUBSCRIBER_INSECURE_SKIP_VERIFY ca-certsca è¯ä¹¦ï¼Œä¸è®¾ç½®æ—¶ä½¿ç”¨ç³»ç»Ÿé»˜è®¤è¯ä¹¦é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_SUBSCRIBER_CA_CERTS write-concurrencyå†™å¹¶å‘é»˜è®¤å€¼: 40 ç¯å¢ƒå˜é‡: INFLUXDB_SUBSCRIBER_WRITE_CONCURRENCY write-buffer-sizeå†™å…¥ç¼“å†²åŒºå¤§å°é»˜è®¤å€¼: 1000 ç¯å¢ƒå˜é‡: INFLUXDB_SUBSCRIBER_WRITE_BUFFER_SIZE total-buffer-bytesæ€»ç¼“å­˜å­—èŠ‚æ•°ï¼Œæ‰€æœ‰è®¢é˜…ä¸­åˆ†é…ç»™ç¼“å†²åŒºçš„æ€»å­—èŠ‚æ•°ã€‚æ¯ä¸ªå‘½åè®¢é˜…å‡ä¼šè·å¾—ç›¸ç­‰çš„ä»½é¢é»˜è®¤å€¼: 0 ç¯å¢ƒå˜é‡: INFLUXDB_SUBSCRIBER_TOTAL_BUFFER_BYTES Graphite Graphiteåè®®[[graphite]] Graphite ç›‘å¬å™¨æ§åˆ¶Collectd CollectDåè®®[[collectd]] Collectd ç›‘å¬å™¨æ§åˆ¶OpenTSDB OpenTSDBåè®®[[openTSDB]] OpenTSDB ç›‘å¬å™¨æ§åˆ¶UDP UDPåè®®[[udp]] UDP ç›‘å¬å™¨æ§åˆ¶Continuous queries è¿ç»­æŸ¥è¯¢[continuous_queries] æ§åˆ¶å¦‚ä½•åœ¨ InfluxDB ä¸­è¿è¡Œè¿ç»­æŸ¥è¯¢ã€‚enabledæ˜¯å¦å¯ç”¨é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_CONTINUOUS_QUERIES_ENABLED log-enabledæ˜¯å¦å¼€å¯æ—¥å¿—é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_CONTINUOUS_QUERIES_LOG_ENABLED query-stats-enabledæ˜¯å¦å¼€å¯æŸ¥è¯¢ç»Ÿè®¡é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_CONTINUOUS_QUERIES_QUERY_STATS_ENABLED run-intervalé»˜è®¤å€¼: \"1s\" ç¯å¢ƒå˜é‡: INFLUXDB_CONTINUOUS_QUERIES_RUN_INTERVAL TLS TLSåŠ å¯†[tls] InfluxDB ä¸­ä¼ è¾“å±‚å®‰å…¨æ€§ (TLS) çš„å…¨å±€é…ç½®è®¾ç½®ã€‚å¦‚æœæœªæŒ‡å®š TLS é…ç½®è®¾ç½®ï¼ŒInfluxDB å°†æ”¯æŒGocrypto/tlsåŒ…å¸¸é‡éƒ¨åˆ†åˆ—å‡ºçš„æ‰€æœ‰å¯†ç å¥—ä»¶ ID ä»¥åŠå®ç°çš„æ‰€æœ‰ TLS ç‰ˆæœ¬ï¼Œå…·ä½“å–å†³äºç”¨äºæ„å»º InfluxDB çš„ Go ç‰ˆæœ¬ã€‚ä½¿ç”¨SHOW DIAGNOSTICSå‘½ä»¤æŸ¥çœ‹ç”¨äºæ„å»º InfluxDB çš„ Go ç‰ˆæœ¬ã€‚æ¨èç‰ˆæœ¬ciphers = [ \"TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305\", \"TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305\", \"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\", \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\", \"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\" ] min-version = \"tls1.3\" max-version = \"tls1.3\" min-versionæœ€å°ç‰ˆæœ¬ï¼Œé»˜è®¤ä½¿ç”¨ go crypto/tls åŒ…ä¸­çš„æœ€å°ç‰ˆæœ¬ï¼Œæœ¬ä¾‹ä¸­æ˜¯ tls1.3é»˜è®¤å€¼: \"tls1.3\" ç¯å¢ƒå˜é‡: INFLUXDB_TLS_MIN_VERSION max-versionæœ€å¤§ç‰ˆæœ¬ï¼Œé»˜è®¤ä½¿ç”¨ go crypto/tls åŒ…ä¸­çš„æœ€å¤§ç‰ˆæœ¬ï¼Œæœ¬ä¾‹ä¸­æ˜¯ tls1.3é»˜è®¤å€¼: \"tls1.3\" ç¯å¢ƒå˜é‡: INFLUXDB_TLS_MAX_VERSION Flux Query controls FluxæŸ¥è¯¢[flux-controller] æœ¬èŠ‚åŒ…å« Flux æŸ¥è¯¢ç®¡ç†çš„é…ç½®è®¾ç½®ã€‚query-concurrencyæŸ¥è¯¢å¹¶å‘æ•°é™åˆ¶é»˜è®¤å€¼: 0 query-initial-memory-bytesæŸ¥è¯¢åˆå§‹å†…å­˜åˆ†é…é™åˆ¶é»˜è®¤å€¼: 0 query-max-memory-bytesæŸ¥è¯¢æœ€å¤§å†…å­˜æ€»æ•°é™åˆ¶é»˜è®¤å€¼: 0 total-max-memory-bytesæ€»æœ€å¤§å†…å­˜æ•°é™åˆ¶é»˜è®¤å€¼: 0 query-queue-sizeæŸ¥è¯¢é˜Ÿåˆ—å¤§å°é™åˆ¶é»˜è®¤å€¼: 0 Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-06-26 "},"doc_influxdb/administration_configure_meta_nodes.html":{"url":"doc_influxdb/administration_configure_meta_nodes.html","title":"é…ç½® Meta èŠ‚ç‚¹","keywords":"","body":" é…ç½® Meta èŠ‚ç‚¹ Global å…¨å±€é…ç½® reporting-disabled bind-address hostname Enterprise license ä¼ä¸šè®¸å¯è¯ license-key license-path Meta èŠ‚ç‚¹ dir bind-address http-bind-address https-enabled https-certificate https-private-key https-insecure-tls data-use-tls data-insecure-tls gossip-frequency announcement-expiration retention-autocreate election-timeout heartbeat-timeout leader-lease-timeout commit-timeout consensus-timeout cluster-tracing logging-enabled pprof-enabled lease-duration auth-enabled ldap-allowed internal-shared-secret password-hash ensure-fips TLS TLSåŠ å¯† é…ç½® Meta èŠ‚ç‚¹Meta èŠ‚ç‚¹é…ç½®è®¾ç½® Global options Enterprise license [enterprise] Meta node [meta] TLS [tls] Global å…¨å±€é…ç½®reporting-disabledæ¯ 24 å°æ—¶ä¼šå°†ä½¿ç”¨æƒ…å†µæ•°æ®æŠ¥å‘Šè‡³ usage.influxdata.comã€‚æŠ¥å‘Šæ•°æ®åŒ…å«éšæœº IDã€æ“ä½œç³»ç»Ÿã€æ¶æ„ã€ç‰ˆæœ¬ã€ç³»åˆ—æ•°é‡ä»¥åŠå…¶ä»–ä½¿ç”¨æƒ…å†µæ•°æ®ã€‚ç”¨æˆ·æ•°æ®åº“çš„æ•°æ®ä¸ä¼šä¼ è¾“ã€‚å°†æ­¤é€‰é¡¹æ›´æ”¹ä¸º true å¯ç¦ç”¨æŠ¥å‘ŠåŠŸèƒ½ã€‚é»˜è®¤å€¼: false bind-addressRPCæœåŠ¡ç”¨äºèŠ‚ç‚¹é—´é€šä¿¡å’Œå¤‡ä»½ä¸æ¢å¤çš„TCPç»‘å®šåœ°å€ã€‚é»˜è®¤å€¼: \":8088\" ç¯å¢ƒå˜é‡: INFLUXDB_BIND_ADDRESS hostnameä¸»æœºåé»˜è®¤å€¼: \"localhost\" ç¯å¢ƒå˜é‡: INFLUXDB_HOSTNAME Enterprise license ä¼ä¸šè®¸å¯è¯[enterprise]license-keyåœ¨InfluxPortalä¸Šä¸ºæ‚¨åˆ›å»ºçš„è®¸å¯è¯å¯†é’¥ã€‚å…ƒèŠ‚ç‚¹é€šè¿‡ç«¯å£ 80 æˆ– 443 å°†è®¸å¯è¯å¯†é’¥ä¼ è¾“è‡³portal.influxdata.comï¼Œå¹¶æ¥æ”¶ä¸€ä¸ªä¸´æ—¶çš„ JSON è®¸å¯è¯æ–‡ä»¶ã€‚æœåŠ¡å™¨ä¼šåœ¨æœ¬åœ°ç¼“å­˜è¯¥è®¸å¯è¯æ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰æœ‰æ•ˆçš„è®¸å¯è¯æ–‡ä»¶ï¼Œæ•°æ®è¿›ç¨‹å°†åªèƒ½è¿è¡Œæœ‰é™æ—¶é—´ã€‚å¦‚æœæ‚¨çš„æœåŠ¡å™¨æ— æ³•ä¸https://portal.influxdata.comé€šä¿¡ï¼Œåˆ™å¿…é¡»ä½¿ç”¨license-pathè®¾ç½®ç¦»çº¿æˆæƒã€‚é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_ENTERPRISE_LICENSE_KEY license-pathæ‚¨ä» InfluxData æ”¶åˆ°çš„æ°¸ä¹… JSON è®¸å¯è¯æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„ï¼Œé€‚ç”¨äºæ— æ³•è®¿é—®äº’è”ç½‘çš„å®ä¾‹ã€‚å¦‚æœæ²¡æœ‰æœ‰æ•ˆçš„è®¸å¯è¯æ–‡ä»¶ï¼Œæ•°æ®å¤„ç†å°†åªèƒ½è¿è¡Œæœ‰é™çš„æ—¶é—´ã€‚å¦‚æœéœ€è¦è®¸å¯è¯æ–‡ä»¶ï¼Œè¯·è”ç³»sales@influxdb.com ã€‚è®¸å¯è¯æ–‡ä»¶åº”ä¿å­˜åœ¨é›†ç¾¤ä¸­çš„æ¯å°æœåŠ¡å™¨ä¸Šï¼ŒåŒ…æ‹¬å…ƒèŠ‚ç‚¹ã€æ•°æ®èŠ‚ç‚¹å’Œä¼ä¸šèŠ‚ç‚¹ã€‚è¯¥æ–‡ä»¶åŒ…å« JSON æ ¼å¼çš„è®¸å¯è¯ï¼Œå¹¶ä¸”å¿…é¡»å¯ä¾›influxdbç”¨æˆ·è¯»å–ã€‚é›†ç¾¤ä¸­çš„æ¯å°æœåŠ¡å™¨éƒ½ä¼šç‹¬ç«‹éªŒè¯å…¶è®¸å¯è¯ã€‚é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_ENTERPRISE_LICENSE_PATH Meta èŠ‚ç‚¹[meta]dirå­˜å‚¨è·¯å¾„é»˜è®¤å€¼: \"/var/lib/influxdb/meta\" ç¯å¢ƒå˜é‡: INFLUXDB_META_DIR bind-addressç›‘å¬åœ°å€é»˜è®¤å€¼: \":8089\" ç¯å¢ƒå˜é‡: INFLUXDB_META_BIND_ADDRESS http-bind-addresshttp ç›‘å¬åœ°å€ ç›‘å¬åœ°å€é»˜è®¤å€¼: \":8091\" ç¯å¢ƒå˜é‡: INFLUXDB_META_HTTP_BIND_ADDRESS https-enabledæ˜¯å¦å¯ç”¨ httpsé»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_HTTPS_ENABLED https-certificatehttps è¯ä¹¦é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_META_HTTPS_CERTIFICATE https-private-keyhttps ç§é’¥é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_META_HTTPS_PRIVATE_KEY https-insecure-tlså…ƒèŠ‚ç‚¹æ˜¯å¦è·³è¿‡é€šè¿‡ HTTPS ç›¸äº’é€šä¿¡çš„è¯ä¹¦éªŒè¯ã€‚è¿™åœ¨ä½¿ç”¨è‡ªç­¾åè¯ä¹¦è¿›è¡Œæµ‹è¯•æ—¶å¾ˆæœ‰ç”¨ã€‚é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_HTTPS_INSECURE_TLS data-use-tlsä¸ Data èŠ‚ç‚¹é€šä¿¡æ˜¯å¦ä½¿ç”¨ tls åŠ å¯†é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_DATA_USE_TLS data-insecure-tlsä¸ Data èŠ‚ç‚¹é€šä¿¡æ˜¯å¦å…è®¸ä¸å®‰å…¨è¯ä¹¦é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_DATA_INSECURE_TLS gossip-frequencyå¹¿æ’­é¢‘ç‡é»˜è®¤å€¼: \"5s\" announcement-expirationå…¬å‘Šæœ‰æ•ˆæœŸé»˜è®¤å€¼: \"30s\" retention-autocreateåˆ›å»ºbucketæ—¶è‡ªåŠ¨åˆ›å»ºä¿ç•™ç­–ç•¥é»˜è®¤å€¼: true election-timeouté€‰ä¸¾è¶…æ—¶é»˜è®¤å€¼: \"1s\" heartbeat-timeoutå¿ƒè·³è¶…æ—¶é»˜è®¤å€¼: \"1s\" leader-lease-timeouté¢†å¯¼è€… lease è¶…æ—¶ï¼Œé¢†å¯¼è€…ç§Ÿçº¦è¶…æ—¶æ˜¯æŒ‡ Raft é¢†å¯¼è€…åœ¨æœªæ”¶åˆ°å¤§å¤šæ•°èŠ‚ç‚¹çš„å›å¤æ—¶ï¼Œä»èƒ½ä¿æŒé¢†å¯¼è€…åœ°ä½çš„æ—¶é—´ã€‚è¶…æ—¶åï¼Œé¢†å¯¼è€…å°†é™çº§ä¸ºè·Ÿéšè€…çŠ¶æ€ã€‚èŠ‚ç‚¹é—´å»¶è¿Ÿè¾ƒé«˜çš„é›†ç¾¤å¯èƒ½éœ€è¦å¢åŠ æ­¤å‚æ•°ï¼Œä»¥é¿å…ä¸å¿…è¦çš„ Raft é€‰ä¸¾ã€‚é»˜è®¤å€¼: \"500ms\" ç¯å¢ƒå˜é‡: INFLUXDB_META_LEADER_LEASE_TIMEOUT commit-timeoutæäº¤è¶…æ—¶æ˜¯æŒ‡é¢†å¯¼è€…å‘è¿½éšè€…å‘é€åŒ…å«é¢†å¯¼è€…æäº¤ç´¢å¼•çš„æ¶ˆæ¯ä¹‹é—´çš„æ—¶é—´é—´éš”ã€‚é»˜è®¤è®¾ç½®é€‚ç”¨äºå¤§å¤šæ•°ç³»ç»Ÿã€‚é»˜è®¤å€¼: \"50ms\" ç¯å¢ƒå˜é‡: INFLUXDB_META_COMMIT_TIMEOUT consensus-timeoutåœ¨è·å–æœ€æ–°çš„ Raft å¿«ç…§ä¹‹å‰ç­‰å¾…è¾¾æˆå…±è¯†çš„è¶…æ—¶ã€‚é»˜è®¤å€¼: \"30s\" ç¯å¢ƒå˜é‡: INFLUXDB_META_CONSENSUS_TIMEOUT cluster-tracingé›†ç¾¤è¯¦ç»†æ—¥å¿—é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_CLUSTER_TRACING logging-enabledæ˜¯å¦æ‰“å°æ—¥å¿—é»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_META_LOGGING_ENABLED pprof-enabledæ˜¯å¦å¼€å¯ pprofé»˜è®¤å€¼: true ç¯å¢ƒå˜é‡: INFLUXDB_META_PPROF_ENABLED lease-durationæ•°æ®èŠ‚ç‚¹ä»å…ƒèŠ‚ç‚¹è·å–çš„ç§Ÿçº¦çš„é»˜è®¤æœŸé™ã€‚ç§Ÿçº¦åœ¨æ»¡è¶³æœŸé™åè‡ªåŠ¨åˆ°æœŸã€‚ ç§Ÿçº¦å¯ç¡®ä¿åœ¨ç»™å®šæ—¶é—´å†…åªæœ‰ä¸€ä¸ªæ•°æ®èŠ‚ç‚¹åœ¨è¿è¡ŒæŸäº›ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œè¿ç»­æŸ¥è¯¢ (CQ) ä½¿ç”¨ç§Ÿçº¦ï¼Œè¿™æ ·æ‰€æœ‰æ•°æ®èŠ‚ç‚¹å°±ä¸ä¼šåŒæ—¶è¿è¡Œç›¸åŒçš„ CQã€‚é»˜è®¤å€¼: \"1m0s\" ç¯å¢ƒå˜é‡: INFLUXDB_META_LEASE_DURATION auth-enabledæ˜¯å¦å¼€å¯è®¤è¯é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_AUTH_ENABLED ldap-allowedæ˜¯å¦å¼€å¯ ldap è®¤è¯é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_SHARED_SECRET internal-shared-secretå†…éƒ¨å…±äº«å¯†é’¥é»˜è®¤å€¼: \"\" ç¯å¢ƒå˜é‡: INFLUXDB_META_INTERNAL_SHARED_SECRET password-hashå¯†ç å“ˆå¸Œé»˜è®¤å€¼: \"bcrypt\" ç¯å¢ƒå˜é‡: INFLUXDB_META_PASSWORD_HASH ensure-fipså¯åŠ¨æ—¶æ˜¯å¦æ£€æŸ¥ Influx æ•°æ®å¹³å°æ˜¯å¦ç¬¦åˆ FIPS å®‰å…¨æ ‡å‡†é»˜è®¤å€¼: false ç¯å¢ƒå˜é‡: INFLUXDB_META_ENSURE_FIPS TLS TLSåŠ å¯†[tls] å‚è€ƒ Data èŠ‚ç‚¹çš„ TLS è®¾ç½®Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-07-02 "},"doc_influxdb/practice.html":{"url":"doc_influxdb/practice.html","title":"å®è·µ","keywords":"","body":"å®è·µCopyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-07-03 "},"doc_influxdb/practice_cluster.html":{"url":"doc_influxdb/practice_cluster.html","title":"é›†ç¾¤ç‰ˆå®è·µ","keywords":"","body":" InfluxDB é›†ç¾¤ç‰ˆå®è·µ å¿«é€Ÿå¼€å§‹ å¯è§†åŒ–æ§åˆ¶å° é…ç½®ä¿®æ”¹ influxdb.conf å»ºè®®ä¿®æ”¹ å®Œæ•´é…ç½® influxdb-meta.conf å»ºè®®ä¿®æ”¹ å®Œæ•´é…ç½® é‡è¦åŠŸèƒ½/æœºåˆ¶ åŸºæœ¬æ¶æ„ æ•°æ®å­˜å‚¨ç»“æ„ ç¼“å­˜é˜Ÿåˆ—ï¼ˆhinted handoffï¼‰ åç†µï¼ˆanti-entropyï¼‰ã€æš‚ä¸æ”¯æŒã€‘ å¤‡ä»½è¿˜åŸ é›†ç¾¤ç®¡ç† èŠ‚ç‚¹æ•…éšœæµ‹è¯• èŠ‚ç‚¹æ•…éšœæœŸé—´ ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ ä¸åŒåœºæ™¯ 2K è®¾å¤‡ ï¼ˆ6K points/sï¼‰ 2K è®¾å¤‡ ~ 100K è®¾å¤‡ï¼ˆ6K points/s ~ 300K points/sï¼‰ 100K è®¾å¤‡ä»¥ä¸Š å…¶ä»–æ³¨æ„ç‚¹ å‚è€ƒèµ„æ–™ InfluxDB é›†ç¾¤ç‰ˆå®è·µå¿«é€Ÿå¼€å§‹ä½¿ç”¨ Docker-Compose å¿«é€Ÿéƒ¨ç½² http://gitlab.shuyilink.com/embeded-software/linkiiot/-/blob/develop/tool/influx/build/docker-compose.yml åŒ…å« Data èŠ‚ç‚¹ 3ï¼ŒMeta èŠ‚ç‚¹ 3 åˆå§‹åŒ–é›†ç¾¤ https://github.com/chengshiwen/influxdb-cluster/wiki https://developer.aliyun.com/article/1056240 å°† Data èŠ‚ç‚¹å’Œ Meta èŠ‚ç‚¹åŠ å…¥é›†ç¾¤å¿…é¡»å…ˆåŠ å…¥ Meta èŠ‚ç‚¹å¦åˆ™æŠ¥é”™influxd-ctl add-meta influxdb-meta-0:8091 influxd-ctl add-meta influxdb-meta-1:8091 influxd-ctl add-meta influxdb-meta-2:8091 influxd-ctl add-data influxdb-data-0:8088 influxd-ctl add-data influxdb-data-1:8088 influxd-ctl add-data influxdb-data-2:8088 # influxd-ctl show Data Nodes ========== ID TCP Address Version 4 influxdb-data-0:8088 1.8.11-c1.2.0 5 influxdb-data-1:8088 1.8.11-c1.2.0 6 influxdb-data-2:8088 1.8.11-c1.2.0 Meta Nodes ========== ID TCP Address Version 1 influxdb-meta-0:8091 1.8.11-c1.2.0 2 influxdb-meta-1:8091 1.8.11-c1.2.0 3 influxdb-meta-2:8091 1.8.11-c1.2.0 å¯è§†åŒ–æ§åˆ¶å°influx 1.8 æ²¡æœ‰å†…ç½®çš„ Consoleï¼Œæ¨èä½¿ç”¨å®˜æ–¹å·¥å…· chronografhttps://docs.influxdata.com/chronograf/v1/introduction/installation/ æ¯æ¬¡è¿è¡Œç¨‹åºçš„ç›®å½•ä¸è¦å˜ï¼Œé»˜è®¤ä¼šåœ¨è¿è¡Œç›®å½•ä¸‹åˆ›å»ºæ•°æ®åº“å­˜å‚¨é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™éœ€è¦é‡æ–°é…ç½® - backup # å®šæœŸå¤‡ä»½çš„é…ç½®ç›®å½• - chronograf-v1.db # é…ç½® é…ç½®ä¿®æ”¹influxdb.confå»ºè®®ä¿®æ”¹å…³é—­ influx è‡ªåŠ¨æ•°æ®æ”¶é›†ï¼Œé¿å…å¼€æºç‰ˆçº çº· 1. reporting-disabled = true å¼€å¯ flux æŸ¥è¯¢ï¼Œä¸ºäº†èƒ½ç›´æ¥å…¼å®¹ç°æœ‰ IoT åŠŸèƒ½ 1. [http] flux-enabled = true å¼€å¯è®¤è¯æé«˜å®‰å…¨æ€§ 1. [http] auth-enabled = true è®¾ç½® hinted-handoff å¤§å°ä¸º 50GBï¼Œè€ƒè™‘ IoT ç”Ÿäº§ç¯å¢ƒçš„éœ€æ±‚ï¼Œé€‚å½“å¢å¤§ 1. [hinted-handoff] max-size = 53687091200 è®¾ç½®æŸ¥è¯¢è¶…æ—¶ï¼Œé˜²æ­¢ InfluxDB è¢«æŸ¥çˆ†ï¼Œå¹¶å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿— 1. query-timeout = \"5m\" 2. log-queries-after = \"1m\" 3. log-timedout-queries = true å®Œæ•´é…ç½®bind-address = \":8088\" reporting-disabled = true [http] flux-enabled = true auth-enabled = true [coordinator] query-timeout = \"5m\" log-queries-after = \"1m\" log-timedout-queries = true [meta] dir = \"/var/lib/influxdb/meta\" [hinted-handoff] dir = \"/var/lib/influxdb/hh\" max-size = 53687091200 [data] dir = \"/var/lib/influxdb/data\" wal-dir = \"/var/lib/influxdb/wal\" influxdb-meta.confå»ºè®®ä¿®æ”¹å…³é—­ influx è‡ªåŠ¨æ•°æ®æ”¶é›†ï¼Œé¿å…å¼€æºç‰ˆçº çº· reporting-disabled = true å®Œæ•´é…ç½®bind-address = \":8091\" reporting-disabled = true [meta] dir = \"/var/lib/influxdb/meta\" é‡è¦åŠŸèƒ½/æœºåˆ¶åŸºæœ¬æ¶æ„â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Meta Nodes â”‚ â”‚ â”‚ â”‚ Meta1 Meta2 Meta3 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² | â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Data Nodes â”‚ â”‚ â”‚ â”‚ Data1 Data2 Data3 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æ•°æ®å­˜å‚¨ç»“æ„ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â” â”‚ Retention Policy â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ | +----------+---------+ | | â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”€â” â”‚ Shard Group 1 â”‚ â”‚ Shard Group 2 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ | +---+----------+--------------+ | | | â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Shard 1 â”‚ â”‚ Shard 2 â”‚ â”‚ Shard 3 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ | +------------------+ | | â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Data Node 1 â”‚ â”‚ Data Node 2 â”‚ â”‚ Data Node 3 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ä¿ç•™ç­–ç•¥ã€åˆ†ç‰‡ç»„ã€åˆ†ç‰‡ã€å¤åˆ¶å› å­ã€Data èŠ‚ç‚¹ å¯ä»¥ç”¨è¿‡ influx å®¢æˆ·ç«¯å·¥å…·æŸ¥çœ‹ show shard groupsï¼Œshow shards ç¼“å­˜é˜Ÿåˆ—ï¼ˆhinted handoffï¼‰é»˜è®¤7dï¼Œ10G éœ€è¦é¢„ç•™èµ„æºç»™ç¼“å­˜é˜Ÿåˆ—æ¢å¤æ•°æ®ä½¿ç”¨ åç†µï¼ˆanti-entropyï¼‰ã€æš‚ä¸æ”¯æŒã€‘èŠ‚ç‚¹å®•æœºæ¢å¤åï¼Œè‡ªåŠ¨åŒæ­¥æ•°æ®åˆ†ç‰‡ å¤‡ä»½è¿˜åŸæš‚ä¸æ”¯æŒå¤‡ä»½/è¿˜åŸï¼Œä»…æ”¯æŒå¯¼å…¥/å¯¼å‡ºï¼Œå¯ä»¥è‡ªå·±åšå†·å¤‡é›†ç¾¤ç®¡ç†å½“å‰æ”¯æŒ 13 ä¸ªé›†ç¾¤ç®¡ç†åŠŸèƒ½ï¼Œå‰©ä½™ 7 ä¸ªåŠŸèƒ½å°šæœªæ”¯æŒadd-dataï¼šæ·»åŠ  Data èŠ‚ç‚¹åˆ°é›†ç¾¤ add-metaï¼šæ·»åŠ  Meta èŠ‚ç‚¹åˆ°é›†ç¾¤ joinï¼šå½“å‰èŠ‚ç‚¹åŠ å…¥é›†ç¾¤ leaveï¼šå½“å‰èŠ‚ç‚¹ç¦»å¼€é›†ç¾¤ update-dataï¼šæ›´æ–° Data èŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹æ°¸ä¹…æ•…éšœæ—¶æ›¿æ¢ï¼‰ remove-dataï¼šåˆ é™¤ Data èŠ‚ç‚¹ï¼ˆä¼šæ°¸ä¹…åˆ é™¤æ•°æ®ï¼‰ remove-metaï¼šåˆ é™¤ Meta èŠ‚ç‚¹ï¼ˆä¼šæ°¸ä¹…åˆ é™¤èŠ‚ç‚¹ï¼‰ showï¼šæ˜¾ç¤ºé›†ç¾¤ä¸­çš„æ‰€æœ‰å…ƒå’Œ Data èŠ‚ç‚¹ show-shardsï¼šæ˜¾ç¤ºæ‰€æœ‰æ•°æ®åˆ†ç‰‡ tokenï¼šç”Ÿæˆä¸€ä¸ªè®¿é—® jwt token copy-shardï¼šæ‹·è´ä¸€ä¸ª Data èŠ‚ç‚¹çš„æ•°æ®åˆ†ç‰‡åˆ°å¦ä¸€ä¸ª Data èŠ‚ç‚¹ï¼ˆç”¨äºé‡æ–°å¹³è¡¡é›†ç¾¤ï¼‰ remove-shardï¼šåˆ é™¤ä¸€ä¸ªæ•°æ®åˆ†ç‰‡ï¼ˆç”¨äºé‡æ–°å¹³è¡¡é›†ç¾¤ï¼‰ truncate-shardsï¼šé˜¶æ®µçƒ­åˆ†ç‰‡ï¼ˆç”¨äºé‡æ–°å¹³è¡¡é›†ç¾¤ï¼‰ èŠ‚ç‚¹æ•…éšœæµ‹è¯•åœºæ™¯ï¼š3èŠ‚ç‚¹æ•…éšœ1ä¸ªï¼Œç¼“å­˜é˜Ÿåˆ—æµ‹è¯• æµ‹è¯•æ¡ä»¶ï¼š5000è®¾å¤‡*100ç‚¹/sèŠ‚ç‚¹æ•…éšœæœŸé—´èŠ‚ç‚¹1ï¼š9core 3G + 18G(SHR) 40åˆ†é’Ÿåhhç›®å½•åˆ°è¾¾11Gï¼Œåœæ­¢å¢é•¿ï¼Œæ­¤æ—¶èŠ‚ç‚¹2çš„hhç›®å½•å¤§å°4G èŠ‚ç‚¹2ï¼š9core 3G + 18G(SHR) 50åˆ†é’Ÿåhhç›®å½•åˆ°è¾¾11Gï¼Œåœæ­¢å¢é•¿ # ä¼šæœ‰ä¸‹åˆ—å‘Šè­¦æ—¥å¿— ts=2025-06-19T02:37:08.436105Z lvl=warn msg=\"Write failed\" log_id=0xAuTToW000 service=write node_id=6 shard_id=2 error=\"hinted handoff queue not empty\" ts=2025-06-19T02:37:35.392779Z lvl=warn msg=\"Write failed\" log_id=0xAuTToW000 service=write node_id=6 shard_id=2 error=\"queue is full\" ts=2025-06-19T02:37:35.398806Z lvl=warn msg=\"Write shard failed with hinted handoff\" log_id=0xAuTToW000 service=write node_id=6 shard_id=2 error=\"queue is full\" ç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µåªè€ƒè™‘å˜åŒ–ä¸ŠæŠ¥ï¼Œå‡å®šä¸ŠæŠ¥é€Ÿç‡ï¼š1æ¡/10s * 30ç‚¹ä½éœ€è¦æå‰ç¡®å®šå¥½ Data èŠ‚ç‚¹æ•°é‡ï¼Œå¦åˆ™åæœŸæ‰©å®¹è´¹æ—¶è´¹åŠ› Data èŠ‚ç‚¹æ•° â‰¥ 3ï¼Œå¤åˆ¶å› å­ 3ï¼Œç¼“å­˜é˜Ÿåˆ— 50 G ç£ç›˜åšå†—ä½™ï¼Œè‡³å°‘ raid5ã€‚å› ä¸º influx ä¸ºäº†å†™å…¥æ€§èƒ½ï¼Œé»˜è®¤é…ç½®ä¸­å†™å…¥ä¸€è‡´æ€§æ˜¯ oneï¼Œå³å…è®¸ 2 èŠ‚ç‚¹æ•…éšœã€‚ èµ„æºè¦ç»™å¤Ÿï¼Œæ¯ä¸ªèŠ‚ç‚¹éœ€è¦æŒ‰ç…§æ­£å¸¸å†™å…¥æ—¶ 2~3 å€åˆ†é… CPU å’Œ å†…å­˜ 1. æ•°æ®å‹ç¼©éœ€è¦é¢å¤–èµ„æºï¼šèµ„æºä¸è¶³ä¼šå¯¼è‡´æ•°æ®å‹ç¼©æ¥ä¸åŠï¼Œè¿è¡Œä¸€æ®µæ—¶é—´åç¼“å­˜é˜Ÿåˆ—æ»¡äº†å°±æ— æ³•å†™å…¥äº† 2. æ•…éšœæ¢å¤éœ€è¦é¢å¤–èµ„æºï¼šå¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ•…éšœä¸‹çº¿æ¢å¤åï¼Œæ¢å¤è¿‡ç¨‹ä¼šèµ„æºå ç”¨*2~3ï¼Œå¦åˆ™ä¼šå½±å“æ¢å¤ï¼Œå¯¼è‡´è¯¥èŠ‚ç‚¹å¯èƒ½æ°¸è¿œè¿½ä¸ä¸Šå…¶ä»–ä¸¤ä¸ªèŠ‚ç‚¹ å°½é‡åœ¨æœ€å¤§å…è®¸æ•…éšœæ—¶é—´å†…æ¢å¤èŠ‚ç‚¹ã€‚ 1. å¦‚æœ1èŠ‚ç‚¹æ•…éšœæ¢å¤è¶…æœŸå¯ä»¥ä¸ç®¡ï¼Œæ•°æ®è¿˜æœ‰2å‰¯æœ¬ 2. å¦‚æœ2èŠ‚ç‚¹æ•…éšœæ¢å¤ï¼Œéœ€è¦è§†æƒ…å†µè€Œå®š 1. æå°‘çš„æ•…éšœä¸”è¾ƒå¿«æ¢å¤æ—¶ï¼Œä¸å¤„ç†ã€‚ï¼ˆå¦‚1å¹´å†…å°±åäº†1æ¬¡ï¼ŒèŠ‚ç‚¹æ•…éšœæ¢å¤ç”¨äº†2å‘¨ï¼‰ 2. é¢‘ç¹çš„æ•…éšœå’Œè¾ƒä¹…çš„æ•…éšœæ¢å¤æ—¶ï¼Œéœ€è¦äººå·¥ä»‹å…¥å¹³è¡¡é›†ç¾¤ã€‚ ä¸åŒåœºæ™¯2K è®¾å¤‡ ï¼ˆ6K points/sï¼‰3 å‰¯æœ¬æ•°æ®éƒ½ä¸ä¸¢å¤±ï¼Œå•èŠ‚ç‚¹æœ€å¤§å…è®¸æ•…éšœæ—¶é—´ï¼š7.5 å¤©ã€‚ 2K è®¾å¤‡ ~ 100K è®¾å¤‡ï¼ˆ6K points/s ~ 300K points/sï¼‰æŒ‰éœ€éƒ¨ç½² InfluxDB Data èŠ‚ç‚¹ï¼ˆæ¯ä¸ªèŠ‚ç‚¹å®é™…è®¾å¤‡æ•° â‰ˆ è®¾å¤‡æ•°*å¤åˆ¶å› å­/èŠ‚ç‚¹æ•°ï¼‰ 1. å¦‚æœèµ„æºå……è¶³ï¼ŒæŒ‰ç…§ 2K è®¾å¤‡ 1ä¸ª Data èŠ‚ç‚¹ä¼°ç®—ï¼Œå•èŠ‚ç‚¹æœ€å¤§å…è®¸æ•…éšœæ—¶é—´ï¼š7.5 å¤© 2. å¦‚æœèµ„æºä¸è¶³ï¼ŒæŒ‰ç…§ 10K è®¾å¤‡ 1ä¸ª Data èŠ‚ç‚¹ä¼°ç®—ï¼Œå•èŠ‚ç‚¹æœ€å¤§å…è®¸æ•…éšœæ—¶é—´ï¼š1.5 å¤© èŠ‚ç‚¹æ•…éšœæ—¶é—´è¶…æœŸ 1. åŠŸèƒ½ä¸Šæ— å½±å“ï¼šæ•°æ®å†™å…¥ã€æŸ¥è¯¢ã€æ•…éšœæ¢å¤éƒ½æ²¡æœ‰é—®é¢˜ï¼Œinflux åªè¦æœ‰ 1 ä¸ªèŠ‚ç‚¹æœ‰æ•°æ®å°±èƒ½æŸ¥åˆ° 2. å¦‚æœæ•…éšœ 1 ä¸ªèŠ‚ç‚¹è¶…æœŸï¼šä¸€èˆ¬ä¸å¤„ç†ï¼Œæ•°æ®ä»æœ‰ 2 å‰¯æœ¬ 3. å¦‚æœæ•…éšœ 2 ä¸ªèŠ‚ç‚¹è¶…æœŸï¼šæ•…éšœæ¬¡æ•°å°‘ï¼Œæ—¶é—´çŸ­æ—¶ä¸€èˆ¬ä¸å¤„ç†ã€‚è¦æ±‚åšç£ç›˜å†—ä½™ï¼Œå³ä½¿1å‰¯æœ¬æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤± 4. è‹¥é•¿æœŸ&é¢‘ç¹çš„èŠ‚ç‚¹æ•…éšœï¼Œé›†ç¾¤çŠ¶æ€ä¼šå˜å¾—ä¸å¥åº·ï¼Œè¿™ä¼šå¯¼è‡´é›†ç¾¤æ•°æ®åˆ†å¸ƒä¸å‡åŒ€ï¼Œæ­¤æ—¶éœ€è¦äººå·¥ä»‹å…¥é‡æ–°å¹³è¡¡é›†ç¾¤ ç¼“å­˜é˜Ÿåˆ—å¤§å°ä¼°è®¡å…¬å¼ï¼šç‚¹ä½é€Ÿç‡ï¼ˆpoints/sï¼‰ æ—¶é—´ï¼ˆhï¼‰ 4e-05 1. ç¤ºä¾‹ï¼š100000 1 4e-05 = 4ï¼Œè¡¨ç¤º 100K points/s çš„å†™å…¥æŒç»­ 1 å°æ—¶ï¼Œç¼“å­˜é˜Ÿåˆ—é•¿åº¦ä¼šå˜æˆ 4 GBã€‚ æ•…éšœèŠ‚ç‚¹æ¢å¤ååœ¨ 300K/s çš„å†™å…¥å‹åŠ›ä¸‹ç¼“å­˜é˜Ÿåˆ—çš„æ•°æ®èƒ½å¤Ÿä»¥ 4G/h çš„é€Ÿåº¦æ¢å¤ï¼Œå†™å…¥å‹åŠ›é™ä½æ¢å¤é€Ÿåº¦ä¼šå˜å¿« åœ¨ 500K/s çš„å†™å…¥å‹åŠ›ä¸‹ç¼“å­˜é˜Ÿåˆ—åªå¢ä¸å‡ 100K è®¾å¤‡ä»¥ä¸Šä½¿ç”¨æ›´å¤šçš„ Data èŠ‚ç‚¹ éœ€è¦ä½¿ç”¨ influx-proxy ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•æ°´å¹³æ‰©å±• â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ writes & queries â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ InfluxDB Proxy â”‚ â”‚ (only http) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ db,measurement â”‚ â”‚ consistent hash â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ | | â”Œâ”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â–¼ â–¼ Circle 1 Circle 2 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ InfluxDB 1 â”‚ â”‚ InfluxDB 3 â”‚ â”‚ InfluxDB 2 â”‚ â”‚ InfluxDB 4 â”‚ â”‚ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å…¶ä»–æ³¨æ„ç‚¹æ€§èƒ½é”™è§‰ï¼šå¯èƒ½å†™å…¥æ¥å¾—åŠï¼Œä½†å…¶å®é›†ç¾¤ä¸å¥åº· 1. æ•°æ®å‹ç¼©æ¥ä¸åŠï¼ˆåå°å¼‚æ­¥å‹ç¼©çº¿ç¨‹ï¼Œä¸€ä¸ªå•æ¬¡å‹ç¼©ä»»åŠ¡å¯èƒ½å°±éœ€è¦å‡ ååˆ†é’Ÿï¼‰ï¼Œå¯¼è‡´é•¿æ—¶é—´è¿è¡Œåå¾…å‹ç¼©æ•°æ®è¿‡å¤šæ‹’ç»å†™å…¥ã€‚ 2. ç¼“å­˜é˜Ÿåˆ—é€æ¸å˜é•¿ï¼ˆåªæœ‰1å‰¯æœ¬æ­£å¸¸å†™å…¥ï¼Œä½†è¯¥èŠ‚ç‚¹çš„ç¼“å­˜é˜Ÿåˆ—åŒæ­¥ä¸åŠï¼Œä¼šé€æ¸å˜æˆç›´è‡³é›†ç¾¤ä¸å¥åº·ï¼‰ éƒ¨ç½²æ—¶éœ€è¦ä¿®æ”¹å®ä¾‹ä¿æ´»ç­–ç•¥ï¼Œå½“ä¸€ä¸ªèŠ‚ç‚¹é•¿æœŸä¸‹çº¿æ¢å¤åï¼Œå®ƒä¼šå…ˆè¿½æ•°æ®ï¼Œè¿™ä¸ªæ—¶å€™ä¸ä¼šå¯åŠ¨httpæœåŠ¡ï¼Œé»˜è®¤çš„å¥åº·æ£€æµ‹ä¼šå¯¼è‡´è¢«k8så¹²æ‰ï¼Œå½±å“æ•°æ®æ¢å¤ influx ä¸è¦å­˜å¤ªå¤šæ•°æ®ï¼Œæœ€ä½³å®è·µæ˜¯å†·çƒ­æ•°æ®åˆ†ç¦»ï¼Œinflux åªå­˜å°‘é‡çƒ­æ•°æ®ï¼Œé€šè¿‡å¯¼å‡ºå†·å¤‡åˆ°å¯¹è±¡å­˜å‚¨ å½“å‰ç‰ˆæœ¬ v1.8.11-c1.2.0 ä¸æ”¯æŒåç†µç›¸å…³åŠŸèƒ½ï¼Œè¿˜åœ¨é¡¹ç›®å¼€å‘è®¡åˆ’ä¸­ã€‚æ‰€ä»¥æ‰©å®¹é›†ç¾¤éœ€è¦æ‰‹åŠ¨å¤„ç†ï¼šhttps://docs.influxdata.com/enterprise_influxdb/v1/administration/manage/clusters/rebalance/ å‚è€ƒèµ„æ–™https://docs.influxdata.com/enterprise_influxdb/v1/ https://github.com/chengshiwen/influxdb-cluster/wiki#%E7%AE%A1%E7%90%86%E6%8C%87%E5%8D%97 https://github.com/chengshiwen/influx-proxy Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-07-03 "},"doc_golang/":{"url":"doc_golang/","title":"Golang","keywords":"","body":"ç®€ä»‹Golang å­¦ä¹ ç¬”è®°Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-07-09 "},"doc_golang/cobra.html":{"url":"doc_golang/cobra.html","title":"cobra","keywords":"","body":" Cobra ç¤ºä¾‹ Cobracobra æ˜¯ä¸€ä¸ªå¹¿å—å¥½è¯„çš„åˆ›å»ºå‘½ä»¤è¡Œå®¢æˆ·ç«¯çš„åº“ï¼šhttps://github.com/spf13/cobraç¤ºä¾‹var rootCmd = &cobra.Command{ Use: \"cmd\", Short: \"å‘½ä»¤è¡Œè¾…åŠ©å·¥å…·\", } var grafanaCmd = &cobra.Command{ Use: \"grafana\", Short: \"grafanaè¾…åŠ©åŠŸèƒ½\", } var reloadCfgCmd = &cobra.Command{ Use: \"reloadcfg\", Short: \"é‡æ–°è½½å…¥é…ç½®\", Run: func(cmd *cobra.Command, args []string) { // do something ... }, } func init() { // éœ€è¦é¢„å…ˆæ³¨å†Œï¼Œæ”¯æŒå¤šçº§å‘½ä»¤ grafanaCmd.AddCommand(reloadCfgCmd) rootCmd.AddCommand(grafanaCmd) } func main() { err := rootCmd.Execute() if err != nil { os.Exit(1) } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-27 "},"doc_golang/channel.html":{"url":"doc_golang/channel.html","title":"channel","keywords":"","body":" channel ä»£ç è§£è¯» go ç‰ˆæœ¬: 1.22.2 å…³é”®ç»“æ„ ä»£ç è§£è¯» chansend() chanrecv() closechan() channel ä»£ç è§£è¯»go ç‰ˆæœ¬: 1.22.2å…³é”®ç»“æ„type hchan struct { qcount uint // å½“å‰é˜Ÿåˆ—ä¸­å‰©ä½™çš„å…ƒç´ ä¸ªæ•° dataqsiz uint // ç¯å½¢é˜Ÿåˆ—çš„é•¿åº¦ï¼Œå³å¯ä»¥å­˜æ”¾çš„å…ƒç´ ä¸ªæ•° buf unsafe.Pointer // ç¯å½¢é˜Ÿåˆ—çš„æŒ‡é’ˆ elemsize uint16 // æ¯ä¸ªå…ƒç´ çš„å¤§å° closed uint32 // æ ‡è¯†channelæ˜¯å¦å·²å…³é—­ elemtype *_type // å…ƒç´ ç±»å‹ sendx uint // é˜Ÿåˆ—ä¸‹æ ‡ï¼ŒæŒ‡ç¤ºç”Ÿäº§è€…å†™å…¥æ—¶å­˜åˆ°å“ªé‡Œ recvx uint // é˜Ÿåˆ—ä¸‹æ ‡ï¼ŒæŒ‡ç¤ºæ¶ˆè´¹è€…ä»å“ªé‡Œå– recvq waitq // ç­‰å¾…è¯»æ¶ˆæ¯çš„Goroutineé˜Ÿåˆ—ï¼ˆsudogçš„é“¾è¡¨ï¼‰ sendq waitq // ç­‰å¾…å†™æ¶ˆæ¯çš„Goroutineé˜Ÿåˆ—ï¼ˆsudogçš„é“¾è¡¨ï¼‰ lock mutex // lockä¿æŠ¤hchanä¸­çš„æ‰€æœ‰å­—æ®µï¼Œä»¥åŠåœ¨æ­¤channelä¸Šé˜»å¡çš„sudogsä¸­çš„å¤šä¸ªå­—æ®µ } // waitq æ˜¯ä¸€ä¸ª sudog çš„åŒå‘é“¾è¡¨ï¼Œsudog æ˜¯å¯¹ G çš„å°è£…ï¼ŒåŒ…å«äº† Goroutine å’Œè¦å‘é€/æ¥æ”¶çš„æ•°æ®çš„æŒ‡é’ˆç­‰ä¿¡æ¯ã€‚ type waitq struct { first *sudog last *sudog } ä»£ç è§£è¯»chansend()å‘é€æ•°æ®ï¼Œch func chansend(c *hchan, ep unsafe.Pointer, block bool, callerpc uintptr) bool { // ... // 1.å…ˆè·å–é” lock(&c.lock) // 2.å¦‚æœ channel å·²å…³é—­ï¼Œåˆ™ panic if c.closed != 0 { unlock(&c.lock) panic(plainError(\"send on closed channel\")) } // 3.å¯»æ‰¾ç­‰å¾…çš„æ¥æ”¶è€…ï¼æœ€é«˜ä¼˜å…ˆçº§ï¼ // å¦‚æœæœ‰ä¸€ä¸ªGoroutineåœ¨recvqä¸­ç­‰å¾…ï¼Œè¯´æ˜ç¼“å†²åŒºæ˜¯ç©ºçš„ï¼Œæˆ–è€…æ ¹æœ¬æ²¡æœ‰ç¼“å†²åŒºã€‚ // æ­¤æ—¶æˆ‘ä»¬ç›´æ¥â€œç»•è¿‡ç¼“å†²åŒºâ€ï¼Œå°†æ•°æ®ç›´æ¥æ‹·è´ç»™è¿™ä¸ªæ¥æ”¶è€…ï¼Œå¹¶å”¤é†’å®ƒã€‚ if sg := c.recvq.dequeue(); sg != nil { send(c, sg, ep, func() { unlock(&c.lock) }, 3) return true } // 4.å¦‚æœç¼“å†²åŒºè¿˜æœ‰ç©ºé—´ï¼Œåˆ™å°†æ•°æ®æ‹·è´åˆ°ç¼“å†²åŒºä¸­ï¼Œæ›´æ–°ç´¢å¼•ã€‚ if c.qcount é”ï¼šè·å– hchan çš„é”ã€‚ éé˜»å¡æ£€æŸ¥ï¼šå¦‚æœæ˜¯éé˜»å¡æ¨¡å¼ä¸”æ— æ³•ç«‹å³å‘é€ï¼Œç›´æ¥è¿”å› falseã€‚ ç›´æ¥æŠ•é€’ï¼ˆæœ€é«˜æ•ˆï¼‰ï¼šå¦‚æœå‘ç°æœ‰æ¥æ”¶è€…æ­£åœ¨ç­‰å¾…ï¼ˆrecvq ä¸ä¸ºç©ºï¼‰ï¼Œåˆ™è·³è¿‡ç¼“å†²åŒºï¼Œç›´æ¥å°†æ•°æ®ä»å‘é€è€…æ‹·è´åˆ°æ¥æ”¶è€…ï¼Œå¹¶å”¤é†’æ¥æ”¶è€… Goroutineã€‚è¿™é¿å…äº†ä¸€æ¬¡é¢å¤–çš„å†…å­˜æ‹·è´ï¼ˆä»å‘é€è€…->ç¼“å†²åŒº->æ¥æ”¶è€…ï¼‰ã€‚ ç¼“å†²æŠ•é€’ï¼šå¦‚æœç¼“å†²åŒºæœªæ»¡ï¼Œåˆ™å°†æ•°æ®æ‹·è´åˆ°ç¼“å†²åŒºçš„ sendx ä½ç½®ï¼Œæ›´æ–°ç´¢å¼•ã€‚ é˜»å¡ç­‰å¾…ï¼šå¦‚æœå‰ä¸¤æ­¥éƒ½ä¸æˆç«‹ï¼ˆå³æ²¡æœ‰ç­‰å¾…çš„æ¥æ”¶è€…ä¸”ç¼“å†²åŒºå·²æ»¡ï¼‰ï¼Œåˆ™å°†å½“å‰ Goroutine åŒ…è£…æˆ sudog åŠ å…¥ sendqï¼Œå¹¶è°ƒç”¨ gopark å°†å…¶æŒ‚èµ·ã€‚å½“æœ‰æ¥æ”¶è€…åˆ°æ¥æˆ– Channel è¢«å…³é—­æ—¶ï¼Œå®ƒä¼šè¢«å”¤é†’ã€‚ chanrecv()æ¥æ”¶æ•°æ®ï¼Œx func chanrecv(c *hchan, ep unsafe.Pointer, block bool) (selected, received bool) { // ... lock(&c.lock) // 1.å¿«é€Ÿè·¯å¾„ï¼šéé˜»å¡ä¸”æ— æ³•ç«‹å³æ¥æ”¶ if !block && (c.qcount == 0 && c.sendq.first == nil || c.closed != 0) { // ... return false, false } // 2.Channelå·²å…³é—­ä¸”ç¼“å†²åŒºæ— æ•°æ®ï¼Œè¿”å›é›¶å€¼ if c.closed != 0 && c.qcount == 0 { // ... return true, false } // 3.å¯»æ‰¾ç­‰å¾…çš„å‘é€è€…ï¼æœ€é«˜ä¼˜å…ˆçº§ï¼ // å¦‚æœæœ‰ä¸€ä¸ªGoroutineåœ¨sendqä¸­ç­‰å¾…ï¼Œè¯´æ˜ç¼“å†²åŒºæ˜¯æ»¡çš„ï¼Œæˆ–è€…æ ¹æœ¬æ²¡æœ‰ç¼“å†²åŒºã€‚ // a. å¯¹äºæ— ç¼“å†²Channelï¼šç›´æ¥ä»å‘é€è€…æ‹·è´æ•°æ®ã€‚ // b. å¯¹äºæœ‰ç¼“å†²Channelï¼šå°†ç¼“å†²åŒºrecvxä½ç½®çš„æ•°æ®æ‹·è´ç»™æ¥æ”¶è€…ï¼Œå†å°†å‘é€è€…çš„æ•°æ®æ‹·è´åˆ°ç¼“å†²åŒºä¸­ï¼Œç„¶åæ›´æ–°ç¯å½¢é˜Ÿåˆ—ç´¢å¼• if sg := c.sendq.dequeue(); sg != nil { recv(c, sg, ep, func() { unlock(&c.lock) }, 3) return true, true } // 4.å¦‚æœç¼“å†²åŒºæœ‰æ•°æ®ï¼Œåˆ™ä»ç¼“å†²åŒºæ‹·è´æ•°æ®ã€‚ if c.qcount > 0 { qp := chanbuf(c, c.recvx) if ep != nil { typedmemmove(c.elemtype, ep, qp) // ä»ç¼“å†²åŒºæ‹·è´åˆ°æ¥æ”¶å˜é‡ } // ... æ¸…ç©ºç¼“å†²åŒºè¯¥ä½ç½®çš„æ•°æ®ï¼ˆæ ¹æ®ç±»å‹æ˜¯å¦éœ€è¦å†…å­˜æ¸…ç†ï¼‰ c.recvx++ if c.recvx == c.dataqsiz { c.recvx = 0 } c.qcount-- unlock(&c.lock) return true, true } // 5.é˜»å¡è·¯å¾„ï¼šç¼“å†²åŒºç©ºä¸”æ— ç­‰å¾…çš„å‘é€è€…ã€‚ // å°†å½“å‰Goroutineæ‰“åŒ…æˆsudogï¼Œæ”¾å…¥recvqé˜Ÿåˆ—ï¼Œå¹¶æŒ‚èµ·ã€‚ if !block { unlock(&c.lock) return false, false } gp := getg() mysg := acquireSudog() // ... c.recvq.enqueue(mysg) gp.parkingOnChan.Store(true) gopark(chanparkcommit, unsafe.Pointer(&c.lock), waitReasonChanReceive, traceBlockChanReceive, 2) // æŒ‚èµ· // è¢«å”¤é†’å... // ... return true, !closed } ç›´æ¥æ¥æ”¶ï¼šå¦‚æœå‘ç°æœ‰å‘é€è€…æ­£åœ¨ç­‰å¾…ï¼ˆsendq ä¸ä¸ºç©ºï¼‰ï¼Œåˆ™è°ƒç”¨ recv å‡½æ•°ã€‚è¿™é‡Œæœ‰ä¸¤ç§æƒ…å†µï¼šæ— ç¼“å†² Channelï¼šç›´æ¥ä»å‘é€è€…æ‹·è´æ•°æ®åˆ°æ¥æ”¶è€…ã€‚ æœ‰ç¼“å†² Channelï¼šè¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–ç‚¹ã€‚å®ƒå…ˆå°†ç¼“å†²åŒºå¤´éƒ¨çš„å…ƒç´ ï¼ˆrecvx ä½ç½®ï¼‰æ‹·è´ç»™æ¥æ”¶è€…ï¼Œç„¶åå†å°†é˜»å¡çš„å‘é€è€…çš„æ•°æ®ç›´æ¥æ‹·è´åˆ°ç¼“å†²åŒºåˆšåˆšç©ºå‡ºæ¥çš„ä½ç½®ï¼Œå¹¶æ›´æ–°ç´¢å¼•ã€‚è¿™é¿å…äº†å”¤é†’å‘é€è€…åï¼Œå‘é€è€…å†å»å†™ç¼“å†²åŒºçš„ä¸€æ¬¡é¢å¤–æ‹·è´å’Œé”ç«äº‰ã€‚ ç¼“å†²æ¥æ”¶ï¼šå¦‚æœç¼“å†²åŒºæœ‰æ•°æ®ï¼Œåˆ™ä»ç¼“å†²åŒºæ‹·è´æ•°æ®ã€‚ é˜»å¡ç­‰å¾…ï¼šå¦‚æœæ²¡æœ‰æ•°æ®ï¼Œåˆ™å°†å½“å‰ Goroutine åŠ å…¥ recvq å¹¶æŒ‚èµ·ã€‚ closechan()å…³é—­ channelï¼Œclose(ch)func closechan(c *hchan) { // 1.æ£€æŸ¥åˆæ³•æ€§ï¼ˆä¸èƒ½closeä¸€ä¸ªnil channelï¼‰ if c == nil { panic(plainError(\"close of nil channel\")) } lock(&c.lock) // 2.æ£€æŸ¥æ˜¯å¦å·²å…³é—­ï¼ˆä¸èƒ½é‡å¤closeï¼‰ if c.closed != 0 { unlock(&c.lock) panic(plainError(\"close of closed channel\")) } // 3.è®¾ç½®å…³é—­æ ‡å¿— c.closed = 1 // 4.å”¤é†’æ‰€æœ‰ç­‰å¾…çš„æ¥æ”¶è€…ï¼ˆrecvqï¼‰ // æ¥æ”¶è€…ä¼šè¢«å”¤é†’ï¼Œå¹¶è·å–åˆ°é›¶å€¼ã€‚ var glist gList for { sg := c.recvq.dequeue() if sg == nil { break } // ... å°†sgå…³è”çš„GåŠ å…¥åˆ°glist } // 5.å”¤é†’æ‰€æœ‰ç­‰å¾…çš„å‘é€è€…ï¼ˆsendqï¼‰ // å‘é€è€…ä¼šè¢«å”¤é†’ï¼Œç„¶åpanicï¼ˆå› ä¸ºä¸èƒ½å‘å·²å…³é—­çš„channelå‘é€æ•°æ®ï¼‰ã€‚ for { sg := c.sendq.dequeue() if sg == nil { break } // ... å°†sgå…³è”çš„GåŠ å…¥åˆ°glist } unlock(&c.lock) // 6.åœ¨é”å¤–å”¤é†’æ‰€æœ‰è¢«é˜»å¡çš„Goroutine for !glist.empty() { gp := glist.pop() gp.schedlink = 0 goready(gp, 3) // å°†Gçš„çŠ¶æ€ä»_Gwaitingæ”¹ä¸º_Grunnableï¼Œæ”¾å…¥è¿è¡Œé˜Ÿåˆ— } } è®¾ç½® closed æ ‡å¿—ã€‚ é‡Šæ”¾æ‰€æœ‰çš„æ¥æ”¶è€…ï¼ˆrecvqï¼‰ï¼Œå®ƒä»¬ä¼šæ”¶åˆ°è¯¥ç±»å‹çš„é›¶å€¼ï¼Œå¹¶ä¸” received è¿”å› falseã€‚ é‡Šæ”¾æ‰€æœ‰çš„å‘é€è€…ï¼ˆsendqï¼‰ï¼Œå®ƒä»¬ä¼šè§¦å‘ panicï¼ˆå› ä¸ºè¯•å›¾å‘å·²å…³é—­çš„ Channel å‘é€æ•°æ®ï¼‰ã€‚ Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-01 "},"doc_golang/pprof.html":{"url":"doc_golang/pprof.html","title":"pprof è°ƒè¯•","keywords":"","body":" pprof è°ƒè¯• 1.å¯ç”¨ pprof 2.å®‰è£…ä¾èµ– 3.æŸ¥çœ‹åˆ†æ ç¦»çº¿æ¨¡å¼ åœ¨çº¿æ¨¡å¼ pprof è°ƒè¯•1.å¯ç”¨ pprofimport ( \"net/http\" _ \"net/http/pprof\" ) go func() { http.ListenAndServe(\":8102\", nil) }() 2.å®‰è£…ä¾èµ–é…ç½®åå¯ä»¥æ›´æ–¹ä¾¿çš„åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹å›¾è¡¨1.éœ€è¦ graphviz ä¾èµ–ï¼Œwsl + ubuntu æ–¹å¼ç¤ºä¾‹ï¼šsudo apt install graphviz 2.éœ€è¦æŒ‡å®šæµè§ˆå™¨ï¼Œwsl + ubuntu + chrome æ–¹å¼ç¤ºä¾‹ï¼šsudo ln -s /mnt/c/Program\\ Files/Google/Chrome/Application/chrome.exe /usr/bin/mschrome sudo update-alternatives --install /usr/bin/x-www-browser x-www-browser /usr/bin/mschrome 200 3.éœ€è¦è®¾ç½®ç¯å¢ƒå˜é‡ï¼šexport BROWSER=/usr/bin/mschrome 3.æŸ¥çœ‹åˆ†æç¦»çº¿æ¨¡å¼curl -o profile http://localhost:8888/debug/pprof/profile go tool pprof -http=:8080 profile.data go tool pprof -http=:8889 heap.data go tool trace trace.data åœ¨çº¿æ¨¡å¼go tool pprof -http=:8000 http://192.168.129.130:8888/debug/pprof/heap Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-07-09 "},"doc_golang/slice.html":{"url":"doc_golang/slice.html","title":"slice","keywords":"","body":" slice ä»£ç è§£è¯» go ç‰ˆæœ¬: 1.22.2 å…³é”®ç»“æ„ ä»£ç è§£è¯» makeslice growslice slice ä»£ç è§£è¯»go ç‰ˆæœ¬: 1.22.2å…³é”®ç»“æ„// path: src/runtime/slice.go type slice struct { array unsafe.Pointer // æŒ‡å‘åº•å±‚æ•°ç»„çš„æŒ‡é’ˆ len int // å½“å‰åˆ‡ç‰‡çš„é•¿åº¦ï¼ˆå½“å‰ä½¿ç”¨çš„å…ƒç´ ä¸ªæ•°ï¼‰ cap int // å½“å‰åˆ‡ç‰‡çš„å®¹é‡ï¼ˆåº•å±‚æ•°ç»„çš„æ€»é•¿åº¦ï¼‰ } å½“ä½ ç¼–å†™ s := make([]int, 5, 10) æ—¶ï¼Œåœ¨å†…å­˜ä¸­ä¼šåˆ›å»ºè¿™æ ·ä¸€ä¸ªç»“æ„ï¼š s (slice header) +--------+--------+--------+ | array | len=5 | cap=10 | +--------+--------+--------+ | | (åº•å±‚æ•°ç»„) v +----+----+----+----+----+----+----+----+----+----+ | | | | | | | | | | | [10]int +----+----+----+----+----+----+----+----+----+----+ ^ ^ ^ | | | s[0] s[4] s[:9] çš„ç»ˆç‚¹ ä»£ç è§£è¯»makeslicemake([]T, len, cap) ä¼šè°ƒç”¨ runtime.makeslice// path: src/runtime/slice.go func makeslice(et *_type, len, cap int) unsafe.Pointer { // è®¡ç®—éœ€è¦åˆ†é…çš„æ€»å†…å­˜å¤§å° = å®¹é‡ * å…ƒç´ å¤§å° mem, overflow := math.MulUintptr(et.Size_, uintptr(cap)) if overflow || mem > maxAlloc || len cap { // å®‰å…¨æ£€æŸ¥ï¼š // 1. å†…å­˜è®¡ç®—æ˜¯å¦æº¢å‡º // 2. ç”³è¯·çš„å†…å­˜æ˜¯å¦è¶…è¿‡ç³»ç»Ÿé™åˆ¶ // 3. é•¿åº¦æ˜¯å¦å°äº0 // 4. é•¿åº¦æ˜¯å¦å¤§äºå®¹é‡ mem, overflow := math.MulUintptr(et.Size_, uintptr(len)) if overflow || mem > maxAlloc || len growsliceappend å®¹é‡ä¸è¶³æ—¶ä¼šè°ƒç”¨ runtime.growslice// path: src/runtime/slice.go // old = æ—§slice, cap = æ‰€éœ€çš„æœ€å°å®¹é‡ï¼ˆé€šå¸¸æ˜¯ old.cap + æ–°å¢å…ƒç´ ä¸ªæ•°ï¼‰ func growslice(et *_type, old slice, cap int) slice { // ... (çœç•¥ä¸€äº›è¾¹ç•Œæ£€æŸ¥å’Œç‰¹æ®Šæƒ…å†µå¤„ç†) // æ ¸å¿ƒç­–ç•¥ï¼šè®¡ç®—æ–°çš„å®¹é‡ newcap := old.cap doublecap := newcap + newcap if cap > doublecap { // æƒ…å†µ1ï¼šå¦‚æœæ‰€éœ€å®¹é‡è¶…è¿‡æ—§å®¹é‡çš„2å€ï¼Œåˆ™ç›´æ¥ä½¿ç”¨æ‰€éœ€å®¹é‡ã€‚ newcap = cap } else { const threshold = 256 if old.cap = 256ï¼Œé‡‡ç”¨ä¸€ç§å¹³æ»‘çš„å¢é•¿å› å­ï¼Œé¿å…å†…å­˜æµªè´¹ã€‚ // å¾ªç¯æ¯æ¬¡å¢åŠ  (newcap + 3*threshold) / 4ï¼Œç›´åˆ° newcap >= cap for 0 Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-02 "},"doc_golang/map.html":{"url":"doc_golang/map.html","title":"sync.map","keywords":"","body":" sync.Mutex ä»£ç è§£è¯» go ç‰ˆæœ¬: 1.22.2 è®¾è®¡æ€æƒ³ å…³é”®ç»“æ„ ä»£ç è§£è¯» sync.Mutex ä»£ç è§£è¯»go ç‰ˆæœ¬: 1.22.2è®¾è®¡æ€æƒ³sync.map åº•å±‚å…¶å®æ˜¯ä¸¤ä¸ª mapï¼Œä¸€ä¸ª read mapï¼Œä¸€ä¸ª dirty mapï¼Œread map å¹¶å‘è¯»å®‰å…¨ï¼Œæ‰€æœ‰è¯»æ“ä½œä¼˜å…ˆread mapï¼Œæ‰€æœ‰å†™ç›´æ¥æ“ä½œ dirty mapï¼Œread map å’Œ dirty map åœ¨éœ€è¦æ—¶é—´ä¼šè¿›è¡Œæ•°æ®åŒæ­¥ æ ‡è®°åˆ é™¤ï¼Œå¦‚æœ dirty map æå‡æˆ read map åæ²¡æœ‰æ–°å…ƒç´ å†™å…¥ï¼Œåˆ™åˆ é™¤åªæ˜¯å¢åŠ æ ‡è®°ï¼Œç„¶åç›´åˆ° dirty map æå‡æ—¶åˆ é™¤ï¼Œå…³æ³¨ missLocked å’Œ dirtyLocked å‡½æ•° å…³é”®ç»“æ„type Map struct { mu Mutex // read mapï¼Œè¯»å¹¶å‘å®‰å…¨ï¼Œæ›´æ–°æ—¶éœ€è¦å¯¹ mu åŠ é” read atomic.Pointer[readOnly] // dirty map dirty map[any]*entry // read map æœ€åä¸€æ¬¡æ›´æ–°åï¼Œload ç¼“å­˜å¤±æ•ˆæ¬¡æ•°ï¼Œæ¬¡æ•°å¤Ÿå¤šæ—¶å°† dirty map æå‡ä¸º read map misses int } // readOnly æ˜¯å­˜åœ¨ Map.read ä¸­æ°¸è¿œä¸ä¼šè¢«ä¿®æ”¹çš„ç»“æ„ type readOnly struct { m map[any]*entry amended bool // å¦‚æœ dirty map åŒ…å« read map ä¸­ä¸å­˜åœ¨çš„å…ƒç´ åˆ™ä¸º true } // expunged æ˜¯ä¸€ä¸ªå›ºå®šçš„æ ‡è®°ï¼Œè¡¨ç¤ºä¸€ä¸ªå…ƒç´ å·²ç»è¢«é€»è¾‘åˆ é™¤ var expunged = new(any) // entry æ¡ç›®æ˜¯æ˜ å°„ä¸­ä¸ç‰¹å®šé”®ç›¸å¯¹åº”çš„æ§½ type entry struct { // p æ˜¯æŒ‡å‘ä¸€ä¸ªå€¼çš„æŒ‡é’ˆ // // å¦‚æœ p == nil, åˆ™ entry å·²ç»è¢«åˆ é™¤ï¼Œæ­¤æ—¶ m.dirty == nil æˆ–è€… m.dirty[key] æ˜¯ entry // å¦‚æœ p == expunged, åˆ™ entry å·²ç»è¢«åˆ é™¤, æ­¤æ—¶ m.dirty != nil, ä¸” m.dirty ä¸å­˜åœ¨ entry // å¦åˆ™, entry æœ‰æ•ˆï¼Œå­˜åœ¨äº m.read.m[key] å¹¶ä¸”å¦‚æœ m.dirty != nil åˆ™åŒæ—¶å­˜åœ¨äº m.dirty[key] p atomic.Pointer[any] } ä»£ç è§£è¯»// newEntry åˆå§‹åŒ–æ–°çš„ entry func newEntry(i any) *entry { e := &entry{} e.p.Store(&i) return e } // åŠ è½½ read map func (m *Map) loadReadOnly() readOnly { if p := m.read.Load(); p != nil { return *p } return readOnly{} } // åŠ è½½ä¸€ä¸ªå…ƒç´  func (m *Map) Load(key any) (value any, ok bool) { read := m.loadReadOnly() e, ok := read.m[key] if !ok && read.amended { m.mu.Lock() // åŠ é” && double check read = m.loadReadOnly() e, ok = read.m[key] if !ok && read.amended { e, ok = m.dirty[key] // å¢åŠ  miss è®¡æ•°ï¼Œå¦‚æœè¿‡å¤§åˆ™å°† dirty map æå‡æˆ read map m.missLocked() } m.mu.Unlock() } if !ok { return nil, false } return e.load() } // load åŠ è½½ entry ä¸­çš„å…ƒç´ ï¼Œå¦‚æœ p == nil æˆ– p == expunged éƒ½è¡¨ç¤ºå…ƒç´ å·²åˆ é™¤ func (e *entry) load() (value any, ok bool) { p := e.p.Load() if p == nil || p == expunged { return nil, false } return *p, true } // Store å­˜å‚¨ä¸€ä¸ªå…ƒç´  func (m *Map) Store(key, value any) { _, _ = m.Swap(key, value) } // tryCompareAndSwap å°è¯•æ›¿æ¢ä¸€ä¸ªå€¼ func (e *entry) tryCompareAndSwap(old, new any) bool { p := e.p.Load() // å…ƒç´ è¢«åˆ æˆ–è€…æ—§å€¼å˜æ›´å°±ç›´æ¥å¤±è´¥ if p == nil || p == expunged || *p != old { return false } nc := new for { // å¦‚æœåˆšå¥½è¢«å¹¶å‘æ›´æ–°äº†å€¼å°±é‡è¯•ç›´åˆ°æˆåŠŸ if e.p.CompareAndSwap(p, &nc) { return true } p = e.p.Load() if p == nil || p == expunged || *p != old { return false } } } // unexpungeLocked åˆ é™¤ expunged æ ‡è®° func (e *entry) unexpungeLocked() (wasExpunged bool) { return e.p.CompareAndSwap(expunged, nil) } // swapLocked åŸå­æ€§çš„æ›¿æ¢æŒ‡é’ˆ func (e *entry) swapLocked(i *any) *any { return e.p.Swap(i) } // LoadOrStore func (m *Map) LoadOrStore(key, value any) (actual any, loaded bool) { // å¿«é€Ÿè·¯å¾„ï¼Œæ— é”æŸ¥è¯¢ read map read := m.loadReadOnly() if e, ok := read.m[key]; ok { actual, loaded, ok := e.tryLoadOrStore(value) if ok { return actual, loaded } } m.mu.Lock() read = m.loadReadOnly() if e, ok := read.m[key]; ok { if e.unexpungeLocked() { m.dirty[key] = e } actual, loaded, _ = e.tryLoadOrStore(value) } else if e, ok := m.dirty[key]; ok { actual, loaded, _ = e.tryLoadOrStore(value) m.missLocked() } else { if !read.amended { m.dirtyLocked() m.read.Store(&readOnly{m: read.m, amended: true}) } m.dirty[key] = newEntry(value) actual, loaded = value, false } m.mu.Unlock() return actual, loaded } // tryLoadOrStore func (e *entry) tryLoadOrStore(i any) (actual any, loaded, ok bool) { // æ— é”å¿«é€Ÿåˆ¤æ–­ p := e.p.Load() if p == expunged { return nil, false, false } if p != nil { return *p, true, true } ic := i for { if e.p.CompareAndSwap(nil, &ic) { return i, false, true } p = e.p.Load() if p == expunged { return nil, false, false } if p != nil { return *p, true, true } } } // LoadAndDelete func (m *Map) LoadAndDelete(key any) (value any, loaded bool) { read := m.loadReadOnly() e, ok := read.m[key] if !ok && read.amended { m.mu.Lock() read = m.loadReadOnly() e, ok = read.m[key] if !ok && read.amended { e, ok = m.dirty[key] // ä» dirty map å®é™…åˆ é™¤ delete(m.dirty, key) m.missLocked() } m.mu.Unlock() } if ok { // é€»è¾‘åˆ é™¤ return e.delete() } return nil, false } // delete æ ‡è®°å…ƒç´ é€»è¾‘åˆ é™¤ func (e *entry) delete() (value any, ok bool) { for { p := e.p.Load() if p == nil || p == expunged { return nil, false } if e.p.CompareAndSwap(p, nil) { return *p, true } } } // trySwap å¿«é€Ÿè·¯å¾„å°è¯•äº¤æ¢ func (e *entry) trySwap(i *any) (*any, bool) { for { p := e.p.Load() if p == expunged { return nil, false } if e.p.CompareAndSwap(p, i) { return p, true } } } func (m *Map) Swap(key, value any) (previous any, loaded bool) { read := m.loadReadOnly() if e, ok := read.m[key]; ok { if v, ok := e.trySwap(&value); ok { if v == nil { return nil, false } return *v, true } } m.mu.Lock() read = m.loadReadOnly() // å…ˆä» read map å°è¯•è¯»ä¸€æ¬¡ if e, ok := read.m[key]; ok { if e.unexpungeLocked() { // å¦‚æœåŸå…ˆæœ‰ expunged æ ‡è®°ï¼Œåˆ™è¡¨ç¤º dirty map éç©ºï¼Œå¹¶éœ€è¦æ›´æ–°è¯¥å€¼åˆ° dirty map m.dirty[key] = e } if v := e.swapLocked(&value); v != nil { // è¿”å›æ—§å€¼ loaded = true previous = *v } } else if e, ok := m.dirty[key]; ok { // ä» dirty map æŸ¥è¯¢ if v := e.swapLocked(&value); v != nil { loaded = true previous = *v } } else { if !read.amended { // å¦‚æœæ˜¯æ’å…¥ç¬¬ä¸€ä¸ªå€¼åˆ° dirty mapï¼Œéœ€è¦æ ‡è®° read map ä¸å®Œæ•´ m.dirtyLocked() m.read.Store(&readOnly{m: read.m, amended: true}) } // ç›´æ¥å¾€ dirty map æ’å…¥æ–°å€¼ m.dirty[key] = newEntry(value) } m.mu.Unlock() return previous, loaded } // CompareAndSwap func (m *Map) CompareAndSwap(key, old, new any) bool { read := m.loadReadOnly() if e, ok := read.m[key]; ok { return e.tryCompareAndSwap(old, new) } else if !read.amended { return false // No existing value for key. } m.mu.Lock() defer m.mu.Unlock() read = m.loadReadOnly() swapped := false if e, ok := read.m[key]; ok { swapped = e.tryCompareAndSwap(old, new) } else if e, ok := m.dirty[key]; ok { swapped = e.tryCompareAndSwap(old, new) m.missLocked() } return swapped } // CompareAndDelete func (m *Map) CompareAndDelete(key, old any) (deleted bool) { read := m.loadReadOnly() e, ok := read.m[key] if !ok && read.amended { m.mu.Lock() read = m.loadReadOnly() e, ok = read.m[key] if !ok && read.amended { e, ok = m.dirty[key] m.missLocked() } m.mu.Unlock() } for ok { p := e.p.Load() if p == nil || p == expunged || *p != old { return false } if e.p.CompareAndSwap(p, nil) { return true } } return false } // Range éå†å…ƒç´  func (m *Map) Range(f func(key, value any) bool) { read := m.loadReadOnly() if read.amended { m.mu.Lock() read = m.loadReadOnly() if read.amended { // æå‡ dirty map æˆ read map read = readOnly{m: m.dirty} copyRead := read m.read.Store(&copyRead) m.dirty = nil m.misses = 0 } m.mu.Unlock() } for k, e := range read.m { v, ok := e.load() if !ok { continue } if !f(k, v) { break } } } // missLocked å¢åŠ  miss è®¡æ•°ï¼Œå¦‚æœè¿‡å¤§åˆ™å°† dirty map æå‡æˆ read map func (m *Map) missLocked() { m.misses++ if m.misses Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-26 "},"doc_golang/mutex.html":{"url":"doc_golang/mutex.html","title":"sync.Mutex","keywords":"","body":" sync.Mutex ä»£ç è§£è¯» go ç‰ˆæœ¬: 1.22.2 è®¾è®¡æ€æƒ³ å…³é”®ç»“æ„ state ç»“æ„ mutexStarving è¡¨ç¤ºçš„ä¸¤ç§æ¨¡å¼ ä»£ç è§£è¯» Lock() Unlock() TryLock() sync.Mutex ä»£ç è§£è¯»go ç‰ˆæœ¬: 1.22.2è®¾è®¡æ€æƒ³åŸå­æ“ä½œä¸çŠ¶æ€å‹ç¼©ï¼šä½¿ç”¨ä¸€ä¸ª state å˜é‡å’Œä½æ“ä½œæ¥ç®¡ç†æ‰€æœ‰çŠ¶æ€ï¼Œæå¤§å‡å°‘äº†éœ€è¦åŒæ­¥çš„å†…å­˜ç©ºé—´ï¼Œæé«˜äº†ç¼“å­˜å‹å¥½æ€§ã€‚ æ··åˆç­–ç•¥ï¼šç»“åˆäº†ä¹è§‚çš„è‡ªæ—‹ï¼ˆé¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢å¼€é”€ï¼‰å’Œæ‚²è§‚çš„æ’é˜Ÿï¼ˆä¿è¯æœ€ç»ˆèƒ½è·å–åˆ°é”ï¼‰ã€‚ è‡ªé€‚åº”å…¬å¹³æ€§ï¼šé€šè¿‡æ­£å¸¸æ¨¡å¼å’Œé¥¥é¥¿æ¨¡å¼çš„åˆ‡æ¢ï¼Œåœ¨é«˜ååé‡å’Œå…¬å¹³æ€§ä¹‹é—´åšå‡ºäº†ä¼˜ç§€çš„æƒè¡¡ã€‚æ­£å¸¸æƒ…å†µä¸‹åå‘ååé‡ï¼Œä¸€æ—¦å‘ç°æœ‰ goroutine ç­‰å¾…è¿‡ä¹…ï¼Œå°±åˆ‡æ¢åˆ°å…¬å¹³çš„é¥¥é¥¿æ¨¡å¼ï¼Œé˜²æ­¢é¥¿æ­»ã€‚ ä¿¡å·é‡ï¼šåº•å±‚ä¾èµ– semaï¼ˆä¿¡å·é‡ï¼‰å’Œè¿è¡Œæ—¶è°ƒåº¦å™¨ (runtime_SemacquireMutex / runtime_Semrelease) æ¥å®ç° goroutine çš„é˜»å¡å’Œå”¤é†’ã€‚ å…³é”®ç»“æ„type Mutex struct { state int32 // çŠ¶æ€ä½ sema uint32 // ä¿¡å·é‡åœ°å€ } type Locker interface { Lock() Unlock() } state ç»“æ„| 31.............................. 3 | 2 | 1 | 0 | | | mutexStarving | mutexWoken | mutexLocked | | ç­‰å¾…çš„ goroutine æ•°é‡ | æ˜¯å¦é¥¥é¥¿æ¨¡å¼ | æœ‰åç¨‹è¢«å”¤é†’ | æ˜¯å¦è¢«é”å®š | ç¬¬ 0 ä½ (æœ€ä½ä½): mutexLockedã€‚ä¸º 1 è¡¨ç¤ºé”å·²è¢«æŸä¸ª goroutine æŒæœ‰ã€‚ ç¬¬ 1 ä½: mutexWokenã€‚ä¸º 1 è¡¨ç¤ºå·²ç»æœ‰ goroutine è¢«å”¤é†’ï¼Œæ­£åœ¨å°è¯•è·å–é”ã€‚è¿™å‘Šè¯‰ Unlock æ–¹æ³•ä¸éœ€è¦å†å»å”¤é†’å…¶ä»–ç­‰å¾…è€…ï¼Œå› ä¸ºå·²ç»æœ‰ä¸€ä¸ªæ´»è·ƒçš„ goroutine äº†ã€‚ ç¬¬ 2 ä½: mutexStarvingã€‚ä¸º 1 è¡¨ç¤ºå½“å‰é”å¤„äºé¥¥é¥¿æ¨¡å¼ã€‚ ç¬¬ 3 ä½åˆ°ç¬¬ 31 ä½: è¡¨ç¤ºå½“å‰åœ¨ç­‰å¾…è¿™ä¸ªé”çš„ goroutine çš„æ•°é‡ã€‚æ•°é‡å€¼ç­‰äº state >> mutexWaiterShiftã€‚ mutexStarving è¡¨ç¤ºçš„ä¸¤ç§æ¨¡å¼æ­£å¸¸æ¨¡å¼ï¼šç­‰å¾…çš„ goroutine ä¼šå…ˆè¿›è¡Œè‡ªæ—‹å°è¯•è·å–é”ï¼Œè‹¥è‡ªæ—‹å¤šæ¬¡åä»æœªè·å–åˆ°ï¼Œåˆ™è¿›å…¥ä¸€ä¸ª FIFO é˜Ÿåˆ—ç­‰å¾…ã€‚æ–°æ¥çš„ goroutine æœ‰ä¼˜åŠ¿ï¼Œå¯èƒ½ä¼šæ¯”æ—©å·²ç­‰å¾…çš„ goroutine å…ˆæ‹¿åˆ°é”ï¼ˆè¿™æä¾›äº†æ›´é«˜çš„ååé‡ï¼Œä½†å¯èƒ½å¯¼è‡´ç­‰å¾…æ—¶é—´è¿‡é•¿ï¼‰ã€‚ é¥¥é¥¿æ¨¡å¼ï¼šå½“ä¸€ä¸ªç­‰å¾…çš„ goroutine è¶…è¿‡ starvationThresholdNs (1ms) è¿˜æ²¡è·å–åˆ°é”æ—¶ï¼Œé”ä¼šè½¬å˜ä¸ºé¥¥é¥¿æ¨¡å¼ã€‚åœ¨é¥¥é¥¿æ¨¡å¼ä¸‹ï¼Œé”çš„æ‰€æœ‰æƒä¼šä»æ‰§è¡Œ Unlock çš„ goroutine ç›´æ¥ç§»äº¤ç»™é˜Ÿåˆ—æœ€å‰ç«¯çš„ç­‰å¾…è€…ã€‚æ–°æ¥çš„ goroutine ä¸ä¼šå°è¯•è·å–é”ï¼Œä¹Ÿä¸ä¼šè‡ªæ—‹ï¼Œè€Œæ˜¯ç›´æ¥åŠ å…¥åˆ°é˜Ÿåˆ—çš„æœ«å°¾ã€‚è¿™é˜²æ­¢äº†å°¾éƒ¨å»¶è¿Ÿç°è±¡ï¼Œä¿è¯äº†å…¬å¹³æ€§ã€‚ ä»£ç è§£è¯»Lock()Lock()func (m *Mutex) Lock() { // å°è¯•å¿«é€Ÿè·¯å¾„(Fast Path)åŠ é”ï¼Œæ›´æ–° state: [0|0|0|0] -> [0|0|0|1] if atomic.CompareAndSwapInt32(&m.state, 0, mutexLocked) { // æˆåŠŸï¼šåŠ é”æˆåŠŸï¼Œå‡½æ•°è¿”å› return } // è¿›å…¥æ…¢é€Ÿè·¯å¾„(Slow Path)åŠ é” m.lockSlow() } lockSlow()func (m *Mutex) lockSlow() { // åˆå§‹åŒ–çŠ¶æ€ï¼Œç„¶åé€šè¿‡è‡ªæ—‹æˆ–è€…ä¿¡å·é‡æ’é˜Ÿè·å–é” var waitStartTime int64 // å½“å‰é”ç­‰å¾…æ—¶é•¿ starving := false // å½“å‰åç¨‹æ˜¯å¦é¥¥é¥¿ awoke := false // å½“å‰åç¨‹æ˜¯å¦å”¤é†’ iter := 0 // è¿­ä»£æ¬¡æ•°ï¼Œç”¨äºåˆ¤æ–­æ˜¯å¦èƒ½è‡ªæ—‹ old := m.state // è®°å½•å½“å‰çŠ¶æ€ for { // å¦‚æœå½“å‰æ˜¯çŠ¶æ€æ˜¯ [*|0|*|1](æ­£å¸¸æ¨¡å¼&é”å®š) && è¿è¡Œç¯å¢ƒå…è®¸è‡ªæ—‹ï¼šä½¿ç”¨è‡ªæ—‹ç­‰å¾…é” if old&(mutexLocked|mutexStarving) == mutexLocked && runtime_canSpin(iter) { // å¦‚æœå½“å‰åç¨‹æœªå”¤é†’ && å½“å‰çŠ¶æ€æœªå”¤é†’ && æœ‰åç¨‹ç­‰å¾…å”¤é†’ [n|*|0|*] && if !awoke && old&mutexWoken == 0 && old>>mutexWaiterShift != 0 && // æ›´æ–°çŠ¶æ€ä¸ºæœ‰åç¨‹è¢«å”¤é†’ // [n|0|0|1] -> [n|0|1|1] atomic.CompareAndSwapInt32(&m.state, old, old|mutexWoken) { // æ ‡è®°å½“å‰åç¨‹è¢«å”¤é†’ awoke = true } // è‡ªæ—‹ç­‰å¾…åå†æ¬¡å°è¯•è·å–é” runtime_doSpin() iter++ old = m.state continue } new := old // å¦‚æœæ˜¯æ­£å¸¸æ¨¡å¼ï¼Œæ›´æ–°ä¸ºï¼šå·²é”å®šã€‚ä¸è¦è·å–é¥¥é¥¿æ¨¡å¼çš„äº’æ–¥é‡ï¼Œæ–°åˆ°è¾¾çš„åç¨‹å¿…é¡»æ’é˜Ÿ // [*|0|*|*] -> [*|0|*|1] if old&mutexStarving == 0 { new |= mutexLocked } // å¦‚æœå·²é”å®š || å¤„äºé¥¥é¥¿æ¨¡å¼ï¼šå¢åŠ åç¨‹ç­‰å¾…å”¤é†’æ•° // [n|*|*|1] -> [n+1|*|*|1] // [n|1|*|*] -> [n+1|1|*|*] if old&(mutexLocked|mutexStarving) != 0 { new += 1 [*|1|*|1] if starving && old&mutexLocked != 0 { new |= mutexStarving } if awoke { // çŠ¶æ€ä¸€è‡´æ€§æ–­è¨€ if new&mutexWoken == 0 { throw(\"sync: inconsistent mutex state\") } // å½“å‰åç¨‹å”¤é†’ç»“æŸï¼Œæ¸…é™¤æ ‡è®°ä½ // [*|*|1|*] -> [*|*|0|*] new &^= mutexWoken } if atomic.CompareAndSwapInt32(&m.state, old, new) { // æ—§çŠ¶æ€æ˜¯ [*|0|*|0] çš„äº’æ–¥é‡åŠ é”æˆåŠŸå°±è¿”å› if old&(mutexLocked|mutexStarving) == 0 { break } // æ–°æ¥çš„åç¨‹ï¼šFIFOï¼Œæ’åˆ°é˜Ÿå°¾ç­‰å¾… // å·²ç»ç­‰å¾…è¿‡çš„åç¨‹ï¼šLIFOï¼Œæ’åˆ°é˜Ÿé¦–ç«‹å³æ‰§è¡Œï¼Œåˆ©ç”¨CPUç¼“å­˜å±€éƒ¨æ€§ä¼˜åŒ–æ€§èƒ½ queueLifo := waitStartTime != 0 if waitStartTime == 0 { waitStartTime = runtime_nanotime() } // æŒ‚èµ·å½“å‰åç¨‹ï¼Œç­‰å¾…è°ƒåº¦ runtime_SemacquireMutex(&m.sema, queueLifo, 1) // ç­‰å¾…æ—¶é—´è¶…è¿‡é˜ˆå€¼ starvationThresholdNs åˆ™æ›´æ–°ä¸ºé¥¥é¥¿çŠ¶æ€ starving = starving || runtime_nanotime()-waitStartTime > starvationThresholdNs old = m.state // å¦‚æœå½“å‰çŠ¶æ€å¤„äºé¥¥é¥¿æ¨¡å¼ï¼š[*|1|*|*|] if old&mutexStarving != 0 { // å¦‚æœå½“å‰åç¨‹è¢«å”¤é†’å¹¶ä¸”å¤„äºé¥¥é¥¿æ¨¡å¼ï¼Œæ£€æŸ¥çŠ¶æ€ä¸€è‡´æ€§ï¼Œä¸åº”è¯¥å‡ºç°ä¸‹åˆ—çŠ¶æ€ï¼š // [*|*|*|1] || [0|*|*|*] // [*|*|1|*] || [0|*|*|*] if old&(mutexLocked|mutexWoken) != 0 || old>>mutexWaiterShift == 0 { throw(\"sync: inconsistent mutex state\") } delta := int32(mutexLocked - 1>mutexWaiterShift == 1 { // å¦‚æœéé¥¥é¥¿å¤„ç†ï¼Œæˆ–è€…å¤„ç†å®Œæœ€åä¸€ä¸ªç­‰å¾…è€…æ—¶ï¼Œ // å°±ç¦»å¼€ç»“æŸé¥¥é¥¿æ¨¡å¼ï¼Œé˜²æ­¢2ä¸ªåç¨‹æ— é™ç¤¼è®©ï¼Œä¸€ç›´ç»´æŒé¥¥é¥¿æ¨¡å¼é™ä½æ€§èƒ½ // [n|1|0|0] -> [n-1|0|0|1] delta -= mutexStarving } // [n|1|0|0] -> [n-1|1|0|1] atomic.AddInt32(&m.state, delta) break } awoke = true iter = 0 } else { old = m.state } } } Unlock()Unlock()func (m *Mutex) Unlock() { // å°è¯•å¿«é€Ÿè·¯å¾„(Fast Path)è§£é” new := atomic.AddInt32(&m.state, -mutexLocked) if new != 0 { // æ…¢é€Ÿè·¯å¾„è§£é”(Slow Path) m.unlockSlow(new) } } unlockSlow()func (m *Mutex) unlockSlow(new int32) { // newä¸º-1æ—¶æŠ¥é”™é‡å¤è§£é” if (new+mutexLocked)&mutexLocked == 0 { fatal(\"sync: unlock of unlocked mutex\") } if new&mutexStarving == 0 { // æ­£å¸¸æ¨¡å¼ old := new for { // æ— éœ€å”¤é†’ï¼šå¦‚æœæ²¡æœ‰ç­‰å¾…è€…æˆ–è€…å·²æœ‰åç¨‹æ‹¿åˆ°äº†è¯¥é”ï¼Œåˆ™ç›´æ¥é€€å‡º // [0|*|*|*] || [*|1|*|*] // [0|*|*|*] || [*|*|1|*] // [0|*|*|*] || [*|*|*|1] if old>>mutexWaiterShift == 0 || old&(mutexLocked|mutexWoken|mutexStarving) != 0 { return } // å”¤é†’æˆåŠŸï¼šé€šè¿‡ä¿¡å·é‡å”¤é†’ä¸€ä¸ªåç¨‹ // [n|0|0|0] -> [n-1|0|1|0] new = (old - 1 TryLock()func (m *Mutex) TryLock() bool { old := m.state // å·²ç»é”å®šæˆ–å¤„äºé¥¥é¥¿æ¨¡å¼æ—¶ç›´æ¥å¤±è´¥ // [*|*|*|1] || [*|1|*|*] if old&(mutexLocked|mutexStarving) != 0 { return false } // å°è¯•ä¸€æ¬¡è·å–é”ï¼Œç±»ä¼¼ Lock() çš„å¿«é€Ÿè·¯å¾„ // [*|0|*|0] -> [*|0|*|1] if !atomic.CompareAndSwapInt32(&m.state, old, old|mutexLocked) { return false } return true } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-22 "},"doc_golang/once.html":{"url":"doc_golang/once.html","title":"sync.Once","keywords":"","body":" sync.Once ä»£ç è§£è¯» go ç‰ˆæœ¬: 1.22.2 è®¾è®¡æ€æƒ³ å…³é”®ç»“æ„ ä»£ç è§£è¯» sync.Once ä»£ç è§£è¯»go ç‰ˆæœ¬: 1.22.2è®¾è®¡æ€æƒ³ä½¿ç”¨ Mutex åŠ é”ï¼Œç”¨ double check å’ŒåŸå­é‡åšæ ‡è®°å…³é”®ç»“æ„type Once struct { done atomic.Uint32 // æ ‡è®°ä½ï¼Œè°ƒç”¨ä¸€æ¬¡åæ ‡è®°æˆ1 m Mutex // äº’æ–¥é‡ } ä»£ç è§£è¯»func (o *Once) Do(f func()) { if o.done.Load() == 0 { o.doSlow(f) } } func (o *Once) doSlow(f func()) { o.m.Lock() defer o.m.Unlock() // double check åæ‰§è¡Œå‡½æ•°ï¼Œå†æ›´æ–°æ ‡è®° if o.done.Load() == 0 { defer o.done.Store(1) f() } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-26 "},"doc_golang/rwmutex.html":{"url":"doc_golang/rwmutex.html","title":"sync.RWMutex","keywords":"","body":" sync.RWMutex ä»£ç è§£è¯» go ç‰ˆæœ¬: 1.22.2 è®¾è®¡æ€æƒ³ å…³é”®ç»“æ„ ä»£ç è§£è¯» RLock() RUnlock() TryRLock() Lock() UnLock() TryLock() sync.RWMutex ä»£ç è§£è¯»go ç‰ˆæœ¬: 1.22.2è®¾è®¡æ€æƒ³RWMutex çš„å®ç°åŸºäºä¸€ä¸ªå…³é”®åŸåˆ™ï¼šå†™æ“ä½œä¼˜å…ˆäºè¯»æ“ä½œã€‚è¿™æ„å‘³ç€å¦‚æœä¸€ä¸ªå†™æ“ä½œåœ¨ç­‰å¾…é”ï¼Œé‚£ä¹ˆåç»­æ–°çš„è¯»æ“ä½œå°†è¢«é˜»å¡ï¼Œç›´åˆ°ä¹‹å‰çš„å†™æ“ä½œå®Œæˆã€‚è¿™æ ·å¯ä»¥é˜²æ­¢å†™æ“ä½œé™·å…¥â€œé¥¥é¥¿â€ï¼ˆæ°¸è¿œæ— æ³•è·å¾—é”ï¼‰ã€‚å®ç°ä¸Šï¼Œå®ƒå†…éƒ¨ä½¿ç”¨äº†ä¸€ä¸ªäº’æ–¥é”ï¼ˆMutexï¼‰ç”¨äºå†™æ“ä½œä¹‹é—´çš„äº’æ–¥ï¼Œå¹¶ç”¨ä¸¤ä¸ªä¿¡å·é‡ï¼ˆreaderSem å’Œ writerSemï¼‰æ¥åè°ƒè¯»å’Œå†™æ“ä½œã€‚å…³é”®ç»“æ„type RWMutex struct { w Mutex // åŸºç¡€çš„äº’æ–¥é” writerSem uint32 // å†™æ“ä½œç­‰å¾…çš„ä¿¡å·é‡ readerSem uint32 // è¯»æ“ä½œç­‰å¾…çš„ä¿¡å·é‡ readerCount atomic.Int32 // å½“å‰è¯»æ“ä½œæ•°é‡ readerWait atomic.Int32 // å†™æ“ä½œé˜»å¡æ—¶éœ€è¦ç­‰å¾…å®Œæˆçš„è¯»æ“ä½œæ•° } const rwmutexMaxReaders = 1 w (Mutex): è¿™æ˜¯ä¸€ä¸ªåŸºç¡€çš„äº’æ–¥é”ã€‚å®ƒæœ‰ä¸¤ä¸ªä¸»è¦ç”¨é€”ï¼šå†™é”ä¹‹é—´äº’æ–¥ï¼šä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªå†™æ“ä½œèƒ½è¿›å…¥ä¸´ç•ŒåŒºã€‚ å®ç°å†™ä¼˜å…ˆï¼šå½“ä¸€ä¸ªå†™æ“ä½œåˆ°æ¥æ—¶ï¼Œå®ƒä¼šå…ˆé”ä½è¿™ä¸ª w é˜»å¡å…¶ä»–å†™ï¼Œç„¶åä¿®æ”¹ readerCount é˜»æ­¢è¯»æ“ä½œ writerSem å’Œ readerSem: è¿™äº›éƒ½æ˜¯ä¿¡å·é‡ï¼Œç”¨äº goroutine çš„é˜»å¡å’Œå”¤é†’ã€‚writerSem: å†™æ“ä½œç­‰å¾…çš„ä¿¡å·é‡ã€‚ä¸€ä¸ªå†™æ“ä½œåœ¨ç­‰å¾…æ—¶ï¼Œä¼šé˜»å¡åœ¨è¿™é‡Œï¼Œç›´åˆ°å®ƒéœ€è¦ç­‰å¾…çš„æ‰€æœ‰è¯»æ“ä½œéƒ½å®Œæˆåï¼Œæ‰ä¼šè¢«å”¤é†’ã€‚ readerSem: è¯»æ“ä½œç­‰å¾…çš„ä¿¡å·é‡ã€‚å½“æœ‰ä¸€ä¸ªå†™æ“ä½œæ­£åœ¨è¿›è¡Œæˆ–ç­‰å¾…æ—¶ï¼Œæ–°çš„è¯»æ“ä½œä¼šé˜»å¡åœ¨è¿™é‡Œï¼Œç›´åˆ°å†™æ“ä½œå®Œæˆåæ‰è¢«å”¤é†’ã€‚ readerCount: è¿™æ˜¯ä¸€ä¸ªéå¸¸å·§å¦™çš„å˜é‡ï¼Œå®ƒåŒæ—¶æ‰®æ¼”ä¸¤ä¸ªè§’è‰²ï¼šå½“å‰æ´»è·ƒçš„è¯»æ“ä½œæ•°é‡ï¼ˆå½“å€¼ >= 0 æ—¶ï¼‰ã€‚ æ˜¯å¦æœ‰å†™æ“ä½œåœ¨ç­‰å¾…çš„æ ‡è®°ï¼ˆå½“å€¼ readerWait: è®°å½•å½“ä¸€ä¸ªå†™æ“ä½œè¢«é˜»å¡æ—¶ï¼Œå®ƒéœ€è¦ç­‰å¾…å¤šå°‘ä¸ªæ­£åœ¨è¿›è¡Œçš„è¯»æ“ä½œå®Œæˆã€‚å†™æ“ä½œåœ¨è·å–é”æ—¶ï¼Œä¼šå°†è‡ªå·±çš„ readerWait è®¾ç½®ä¸ºå½“æ—¶çš„ readerCountï¼ˆæ­£å€¼ï¼‰ã€‚æ¯ä¸ªè¯»æ“ä½œè§£é”æ—¶ï¼Œä¼šåŸå­åœ°å‡å°‘ readerWait çš„å€¼ã€‚å½“ readerWait å‡ä¸º 0 æ—¶ï¼Œå†™æ“ä½œå°±ä¼šè¢«å”¤é†’ã€‚ ä»£ç è§£è¯»RLock()func (rw *RWMutex) RLock() { // å¦‚æœæœ‰å†™é”ï¼ŒreaderCount æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„è´Ÿå€¼ if rw.readerCount.Add(1) RUnlock()RUnlock()func (rw *RWMutex) RUnlock() { // å¿«é€Ÿè·¯å¾„(Fast Path)ï¼Œå¦‚æœæ²¡æœ‰å†™ç­‰å¾…åˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™è¿›å…¥æ…¢é€Ÿè·¯å¾„(Slow Path) if r := rw.readerCount.Add(-1); r rUnlockSlow()func (rw *RWMutex) rUnlockSlow(r int32) { // æ£€æŸ¥æ˜¯å¦é‡å¤é‡Šæ”¾è¯»é”ï¼Œä¸‹åˆ—æƒ…å½¢ç›´æ¥æŠ¥é”™ï¼š // - r ä¸º -1ï¼Œè¡¨ç¤ºæ— å†™ç­‰å¾…ï¼Œè¯»é”é‡å¤é‡Šæ”¾ä¸€æ¬¡ // - r ä¸º -1-rwmutexMaxReadersï¼Œè¡¨ç¤ºæœ‰å†™ç­‰å¾…ï¼Œè¯»é”é‡å¤é‡Šæ”¾ä¸€æ¬¡ if r+1 == 0 || r+1 == -rwmutexMaxReaders { fatal(\"sync: RUnlock of unlocked RWMutex\") } // æ›´æ–°è¯»ç­‰å¾…æ•° if rw.readerWait.Add(-1) == 0 { // æœ€åä¸€ä¸ªè¯»é”è¢«é‡Šæ”¾åï¼Œå”¤é†’å†™æ“ä½œåç¨‹ runtime_Semrelease(&rw.writerSem, false, 1) } } TryRLock()func (rw *RWMutex) TryRLock() bool { for { c := rw.readerCount.Load() if c Lock()func (rw *RWMutex) Lock() { // ä½¿ç”¨äº’æ–¥é”ï¼Œé˜»å¡å…¶ä»–å†™æ“ä½œ rw.w.Lock() // æ›´æ–° readerCount ä¸ºå¾ˆå¤§çš„è´Ÿå€¼ï¼Œé˜»æ­¢è¯»æ“ä½œ r := rw.readerCount.Add(-rwmutexMaxReaders) + rwmutexMaxReaders // ç­‰å¾…å‰é¢çš„è¯»æ“ä½œç»“æŸ if r != 0 && rw.readerWait.Add(r) != 0 { runtime_SemacquireRWMutex(&rw.writerSem, false, 0) } } UnLock()func (rw *RWMutex) Unlock() { // æ›´æ–°çŠ¶æ€ï¼Œå‘Šè¯‰è¯»æ“ä½œæ­¤æ—¶æ²¡æœ‰å†™æ“ä½œäº† r := rw.readerCount.Add(rwmutexMaxReaders) // æ£€æŸ¥æ˜¯å¦é‡å¤é‡Šæ”¾å†™é” if r >= rwmutexMaxReaders { fatal(\"sync: Unlock of unlocked RWMutex\") } // å”¤é†’è¯»æ“ä½œ for i := 0; i TryLock()func (rw *RWMutex) TryLock() bool { // ä½¿ç”¨äº’æ–¥é‡ç›´æ¥å°è¯•åŠ é” if !rw.w.TryLock() { return false } // å°è¯•æ›´æ–° readerCount å˜ä¸ºå†™é”å®š if !rw.readerCount.CompareAndSwap(0, -rwmutexMaxReaders) { rw.w.Unlock() return false } return true } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-22 "},"doc_golang/waitgroup.html":{"url":"doc_golang/waitgroup.html","title":"sync.WaitGroup","keywords":"","body":" sync.WaitGroup ä»£ç è§£è¯» go ç‰ˆæœ¬: 1.22.2 å…³é”®ç»“æ„ ä»£ç è§£è¯» Add(delta int) Done() Wait() sync.WaitGroup ä»£ç è§£è¯»go ç‰ˆæœ¬: 1.22.2å…³é”®ç»“æ„type WaitGroup struct { noCopy noCopy // ç¦æ­¢æ‹·è´ state atomic.Uint64 // é«˜32ä½æ˜¯æœªå®Œæˆä»»åŠ¡æ•°(v)ï¼Œä½32ä½æ˜¯ç­‰å¾…è€…æ•°é‡(w) sema uint32 // ä¿¡å·é‡ï¼Œç”¨äºé˜»å¡å’Œå”¤é†’ goroutine } ä»£ç è§£è¯»Add(delta int)func (wg *WaitGroup) Add(delta int) { state := wg.state.Add(uint64(delta) > 32) w := uint32(state) if v 0 && v == int32(delta) { // é˜²æ­¢åœ¨ Wait æœŸé—´è°ƒç”¨ Add(æ­£æ•°) // ä¸ºäº†æ£€æµ‹ä¸‹åˆ—è¿™ç§å¸¸è§çš„é”™è¯¯ç”¨æ³•ï¼š // * var wg sync.WaitGroup // * go func() { // * wg.Add(1) // å¤ªæ™šäº†ï¼Waitå¯èƒ½å·²ç»å¼€å§‹ // * defer wg.Done() // * // do something... // * }() // wg.Wait() // å¯èƒ½åœ¨è¿™é‡Œ panic panic(\"sync: WaitGroup misuse: Add called concurrently with Wait\") } // åªæœ‰ä»»åŠ¡å¤„ç†å®Œæˆ(v == 0) && æœ‰ç­‰å¾…è€…(w > 0) æ‰éœ€è¦æ¸…ç†å’Œå”¤é†’ï¼Œå¦åˆ™é€€å‡º if v > 0 || w == 0 { return } // è¿è¡Œåˆ°è¿™é‡Œæ—¶ï¼Œv == 0ï¼Œw > 0ï¼Œè¯´æ˜ Wait å·²ç»è°ƒç”¨è¿‡ï¼Œå¹¶ä¸”ä»»åŠ¡å…¨éƒ¨å®Œæˆå¯ä»¥å¼€å§‹æ¸…ç† // æ­¤æ—¶ Add å’Œ Wait éƒ½ä¸åº”è¯¥å†è¢«è°ƒç”¨ï¼Œæ‰€ä»¥ state ä¸€å®šä¸ä¼šå‘ç”Ÿå˜åŒ– if wg.state.Load() != state { panic(\"sync: WaitGroup misuse: Add called concurrently with Wait\") } // æ¸…ç©ºç­‰å¾…è€…è®¡æ•° wg.state.Store(0) for ; w != 0; w-- { // å”¤é†’æ‰€æœ‰ç­‰å¾…è€… runtime_Semrelease(&wg.sema, false, 0) } } Done()func (wg *WaitGroup) Done() { // è®¡æ•°å‡1 wg.Add(-1) } Wait()func (wg *WaitGroup) Wait() { for { state := wg.state.Load() v := int32(state >> 32) w := uint32(state) if v == 0 { // ä»»åŠ¡æ•°ä¸º0ï¼Œæ— éœ€ç­‰å¾… return } // å¢åŠ ç­‰å¾…è€…æ•°é‡ if wg.state.CompareAndSwap(state, state+1) { runtime_Semacquire(&wg.sema) // æ‰€æœ‰ç­‰å¾…è€…è¢«åŒæ—¶å”¤é†’ï¼Œæ­¤æ—¶æ‰€æœ‰ä»»åŠ¡è‚¯å®šå·²ç»å¤„ç†å®Œæˆï¼Œå¹¶ä¸”ç­‰å¾…è€…æ•°é‡å·²ç»æ¸…ç†ï¼Œ if wg.state.Load() != 0 { panic(\"sync: WaitGroup is reused before previous Wait has returned\") } return } } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-22 "},"doc_other/":{"url":"doc_other/","title":"å…¶ä»–","keywords":"","body":"ç®€ä»‹å…¶ä»–åˆ†äº«æ–‡æ¡£Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_other/learn.html":{"url":"doc_other/learn.html","title":"å­¦ä¹ èµ„æ–™æ•´ç†","keywords":"","body":" å­¦ä¹ èµ„æ–™æ•´ç† FreeCodeCamp å­¦ä¹ èµ„æ–™æ•´ç†FreeCodeCampFreeCodeCamp æ˜¯ä¸€ä¸ªå¹¿å—æ¬¢è¿çš„åœ¨çº¿å­¦ä¹ å¹³å°ï¼Œæä¾›å…è´¹çš„ç¼–ç¨‹è¯¾ç¨‹å’Œé¡¹ç›®ï¼Œå¸®åŠ©äººä»¬å­¦ä¹ ç½‘é¡µå¼€å‘ã€æ•°æ®ç§‘å­¦å’Œå…¶ä»–ç¼–ç¨‹æŠ€èƒ½ã€‚è¯¥ç½‘ç«™æä¾›äº†ä¸°å¯Œçš„äº’åŠ¨ç¼–ç¨‹æŒ‘æˆ˜ã€æ•™ç¨‹ä»¥åŠè®¤è¯è¯¾ç¨‹ï¼Œæ¶µç›– HTMLã€CSSã€JavaScriptã€Reactã€Node.js ç­‰å¤šç§æŠ€æœ¯Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_other/proxy.html":{"url":"doc_other/proxy.html","title":"wsl ç§‘å­¦ä¸Šç½‘","keywords":"","body":" WSL ç§‘å­¦ä¸Šç½‘ æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ wsl æ ‡å‡†æ¨¡å¼ é…ç½® http ä»£ç† æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ wsl é•œåƒæ¨¡å¼ é¢å¤–é…ç½® ssh ä»£ç† WSL ç§‘å­¦ä¸Šç½‘æ–¹æ¡ˆä¸€ï¼šä½¿ç”¨ wsl æ ‡å‡†æ¨¡å¼å›½å†…å› ä¸ºè¢«å¢™æ— æ³•æ­£å¸¸è®¿é—® githubï¼Œéœ€è¦è®¾ç½®ä»£ç†æ¥æ­£å¸¸è®¿é—®ã€‚ æœ¬æ–‡ä»‹ç» wsl2 + ubuntu20.04 ä¸‹å¦‚ä½•è®¾ç½®ä»£ç†ä»¥æ­£å¸¸è®¿é—® githubã€‚é…ç½® http ä»£ç†å¼€å¯ä»£ç†åï¼Œå‡å®šä»£ç†ç«¯å£ä¸º 7890ï¼Œåœ¨ç»ˆç«¯æ‰§è¡Œä¸‹åˆ—å‘½ä»¤è®¾ç½®ä»£ç†ï¼šgit config --global http.proxy http://127.0.0.1:7890 git config --global https.proxy https://127.0.0.1:7890 æ–¹æ¡ˆäºŒï¼šä½¿ç”¨ wsl é•œåƒæ¨¡å¼win11 æ”¯æŒ wsl è®¾ç½®é•œåƒç½‘ç»œï¼Œå¯ä»¥è®© wsl å…±äº«ä¸»æœºç½‘ç»œï¼Œè¿™ç§æ–¹å¼ä¸éœ€è¦å†è®¾ç½® http.proxy å’Œ https.proxyã€‚è®¾ç½® .wslconfig é…ç½®åé‡å¯ wsl å³å¯ç”Ÿæ•ˆ[wsl2] networkingMode=mirrored localhostForwarding=true dnsTunneling=true é¢å¤–é…ç½® ssh ä»£ç†æ­¤æ—¶å·²ç»å¯ä»¥ä½¿ç”¨ https è®¿é—® github:git clone https://github.com/LRaito/books.git ä½†è¿˜ä¸èƒ½ä½¿ç”¨ ssh è®¿é—®ï¼Œæ¯”å¦‚ä¸‹åˆ—å‘½ä»¤ä¸é€šï¼šgit clone git@github.com:LRaito/books.git æ­¤æ—¶éœ€è¦ä¸º SSH é…ç½® SOCKS ä»£ç†ï¼ŒCFW é€šå¸¸å¼€å¯ SOCKS5 ç«¯å£ï¼Œä¸€èˆ¬ä½¿ç”¨ mixed portï¼Œå¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­çœ‹åˆ°clash é…ç½®ä¸­å¯èƒ½åŒ…å« 3 ç§ç«¯å£ï¼šHTTP/HTTPS ä»£ç†ç«¯å£ï¼š7890 SOCKS5 ä»£ç†ç«¯å£ï¼š7891 Mixed Portï¼ˆæ··åˆç«¯å£ï¼‰ï¼š7892ï¼ˆåŒæ—¶æ”¯æŒ HTTP å’Œ SOCKSï¼‰ ç¼–è¾‘ ~/.ssh/config æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼šHost github.com Hostname ssh.github.com User git Port 443 ProxyCommand nc -x 127.0.0.1:7890 %h %p Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-28 "},"doc_other/jenkins_parallel.html":{"url":"doc_other/jenkins_parallel.html","title":"Jenkins å¹¶å‘æ„å»º","keywords":"","body":"Jenkins å¹¶å‘æ„å»ºé€šè¿‡ parallel æŒ‡ä»¤å¹¶å‘æ‰§è¡Œä»»åŠ¡åŠ é€Ÿæ„å»ºstages { stage('x86_64') { environment { GOPROXY = 'https://goproxy.cn,direct' } stages { stage('init'){ steps { script { sh \"go env\" sh \"go mod tidy\" } } } stage('build') { steps { script{ def stepsForParallel = [:] String[] apps = [\"app1\", \"app2\", \"app3\"] apps.each{ app -> stepsForParallel[app] = { stage(app) { sh \"make build -C app/${app}\" } } } parallel stepsForParallel } } } } } } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-03-24 "},"doc_other/redis_sentinel.html":{"url":"doc_other/redis_sentinel.html","title":"Redis å“¨å…µæ¨¡å¼","keywords":"","body":" Redis Sentinel å“¨å…µæ¨¡å¼ æ¶æ„ å¿«é€Ÿéƒ¨ç½² æ–‡ä»¶ç»“æ„ docker-compose.yaml sentinel.conf æ•…éšœè½¬ç§»æµ‹è¯• å¸¸ç”¨å‘½ä»¤ æŸ¥çœ‹ master çŠ¶æ€ æŸ¥çœ‹ slave çŠ¶æ€ æŸ¥çœ‹ sentinel ç»´æŠ¤çš„ master çŠ¶æ€ æ ¹æ®åç§°æŸ¥ master åœ°å€ æŸ¥çœ‹ sentinel çŠ¶æ€ å®¢æˆ·ç«¯ demo å¸¸è§é—®é¢˜ 1. Failed to resolve hostname 'redis-master' 2. Could not rename tmp config file (Device or resource busy) 3. æ‰‹åŠ¨åœæ­¢ redis-mater æœåŠ¡æ•…éšœè½¬ç§»ä¸ç”Ÿæ•ˆ Redis Sentinel å“¨å…µæ¨¡å¼æ¶æ„â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Sentinel â”‚ â”‚ â”‚ â”‚ Sentinel-1 Sentinel-2 Sentinel-3 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² | â–¼ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Redis â”‚ â”‚ â”‚ â”‚ Master Slave-1 Slave-2 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å¿«é€Ÿéƒ¨ç½²æ–‡ä»¶ç»“æ„redis-sentinel â”œâ”€â”€ docker-compose.yml â””â”€â”€ config â”œâ”€â”€ sentinel-1 â”‚ â””â”€â”€ sentinel.conf â”œâ”€â”€ sentinel-2 â”‚ â””â”€â”€ sentinel.conf â””â”€â”€ sentinel-3 â”‚ â””â”€â”€ sentinel.conf â””â”€â”€ sentinel.conf docker-compose.yamlservices: redis-master: image: redis:6.2 container_name: redis-master command: redis-server ports: - 6380:6379 redis-slave-1: image: redis:6.2 container_name: redis-slave-1 command: redis-server --slaveof redis-master 6379 ports: - 6381:6379 redis-slave-2: image: redis:6.2 container_name: redis-slave-2 command: redis-server --slaveof redis-master 6379 ports: - 6382:6379 redis-sentinel-1: image: redis:6.2 container_name: redis-sentinel-1 command: redis-sentinel /etc/redis/sentinel.conf volumes: - ./config/sentinel-1:/etc/redis ports: - 26379:26379 redis-sentinel-2: image: redis:6.2 container_name: redis-sentinel-2 command: redis-sentinel /etc/redis/sentinel.conf volumes: - ./config/sentinel-2:/etc/redis ports: - 26380:26379 redis-sentinel-3: image: redis:6.2 container_name: redis-sentinel-3 command: redis-sentinel /etc/redis/sentinel.conf volumes: - ./config/sentinel-3:/etc/redis ports: - 26381:26379 sentinel.confport 26379 dir \"/tmp\" sentinel resolve-hostnames yes sentinel monitor mymaster redis-master 6379 2 sentinel down-after-milliseconds mymaster 5000 sentinel failover-timeout mymaster 30000 sentinel deny-scripts-reconfig yes æ•…éšœè½¬ç§»æµ‹è¯•# è§¦å‘æ•…éšœè½¬ç§» redis-cli -p 26379 sentinel failover mymaster # æŸ¥çœ‹ master èŠ‚ç‚¹åœ°å€æ›´æ–° redis-cli -p 26379 sentinel get-master-addr-by-name mymaster # master å¯è¯»å†™ï¼Œslave åªè¯»ï¼Œå¯ä»¥å†™å…¥æ•°æ®æµ‹è¯• master èŠ‚ç‚¹æ›´æ–° redis-cli -p 6380 set key value å¸¸ç”¨å‘½ä»¤æŸ¥çœ‹ master çŠ¶æ€redis-cli -p 6380 info replication # Replication role:master connected_slaves:2 slave0:ip=172.31.0.4,port=6379,state=online,offset=37130,lag=0 slave1:ip=172.31.0.6,port=6379,state=online,offset=37130,lag=0 master_failover_state:no-failover master_replid:7091597e5f925bfe9865272bfab57b3d0929c87c master_replid2:0000000000000000000000000000000000000000 master_repl_offset:37130 second_repl_offset:-1 repl_backlog_active:1 repl_backlog_size:1048576 repl_backlog_first_byte_offset:1 repl_backlog_histlen:37130 æŸ¥çœ‹ slave çŠ¶æ€redis-cli -p 6381 info replication # Replication role:slave master_host:redis-master master_port:6379 master_link_status:up master_last_io_seconds_ago:0 master_sync_in_progress:0 slave_read_repl_offset:47865 slave_repl_offset:47865 slave_priority:100 slave_read_only:1 replica_announced:1 connected_slaves:0 master_failover_state:no-failover master_replid:7091597e5f925bfe9865272bfab57b3d0929c87c master_replid2:0000000000000000000000000000000000000000 master_repl_offset:47865 second_repl_offset:-1 repl_backlog_active:1 repl_backlog_size:1048576 repl_backlog_first_byte_offset:1 repl_backlog_histlen:47865 æŸ¥çœ‹ sentinel ç»´æŠ¤çš„ master çŠ¶æ€redis-cli -p 26379 sentinel master mymaster 1) \"name\" 2) \"mymaster\" 3) \"ip\" 4) \"172.30.0.2\" 5) \"port\" 6) \"6379\" 7) \"runid\" 8) \"13d01c0efea404e842e294749edf256a6d14865c\" 9) \"flags\" 10) \"master\" 11) \"link-pending-commands\" 12) \"0\" 13) \"link-refcount\" 14) \"1\" 15) \"last-ping-sent\" 16) \"0\" 17) \"last-ok-ping-reply\" 18) \"147\" 19) \"last-ping-reply\" 20) \"147\" 21) \"down-after-milliseconds\" 22) \"5000\" 23) \"info-refresh\" 24) \"4182\" 25) \"role-reported\" 26) \"master\" 27) \"role-reported-time\" 28) \"1208691\" 29) \"config-epoch\" 30) \"0\" 31) \"num-slaves\" 32) \"2\" 33) \"num-other-sentinels\" 34) \"2\" 35) \"quorum\" 36) \"2\" 37) \"failover-timeout\" 38) \"30000\" 39) \"parallel-syncs\" 40) \"1\" æ ¹æ®åç§°æŸ¥ master åœ°å€redis-cli -p 26379 sentinel get-master-addr-by-name mymaster æŸ¥çœ‹ sentinel çŠ¶æ€redis-cli -p 26379 info sentinel # Sentinel sentinel_masters:1 sentinel_tilt:0 sentinel_running_scripts:0 sentinel_scripts_queue_length:0 sentinel_simulate_failure_flags:0 master0:name=mymaster,status=ok,address=172.31.0.7:6379,slaves=2,sentinels=3 å®¢æˆ·ç«¯ demopackage main import ( \"context\" \"fmt\" \"time\" \"github.com/redis/go-redis/v9\" ) func main() { // å“¨å…µæ¨¡å¼é…ç½® sentinelOptions := &redis.FailoverOptions{ MasterName: \"mymaster\", // ä¸»èŠ‚ç‚¹åç§°ï¼Œåœ¨å“¨å…µé…ç½®ä¸­æŒ‡å®š SentinelAddrs: []string{ // å“¨å…µèŠ‚ç‚¹åœ°å€åˆ—è¡¨ \"redis-sentinel-1:26379\", \"redis-sentinel-2:26379\", \"redis-sentinel-3:26379\", }, MaxRetries: 3, // æœ€å¤§é‡è¯•æ¬¡æ•° MinRetryBackoff: 100 * time.Millisecond, // æœ€å°é‡è¯•é—´éš” MaxRetryBackoff: 1 * time.Second, // æœ€å¤§é‡è¯•é—´éš” DialTimeout: 5 * time.Second, // è¿æ¥è¶…æ—¶ ReadTimeout: 5 * time.Second, // è¯»å–è¶…æ—¶ WriteTimeout: 5 * time.Second, // å†™å…¥è¶…æ—¶ PoolSize: 10, // è¿æ¥æ± å¤§å° } // åˆ›å»ºå®¢æˆ·ç«¯ client := redis.NewFailoverClient(sentinelOptions) // æµ‹è¯•è¿æ¥ ctx := context.Background() _, err := client.Ping(ctx).Result() if err != nil { panic(err) } for { time.Sleep(time.Second * 3) err = client.Set(ctx, \"test_key\", \"test_value\", 10*time.Minute).Err() if err == nil { fmt.Println(\"write ok\") } _, err := client.Get(ctx, \"test_key\").Result() if err == redis.Nil { fmt.Println(\"key not exist\") } else if err != nil { fmt.Println(\"read ok\") } else { fmt.Println(\"read err\") } } } å¸¸è§é—®é¢˜1. Failed to resolve hostname 'redis-master'sentinel é»˜è®¤ä¸å¼€å¯ hostname è§£æï¼Œéœ€è¦å¢åŠ é…ç½®: sentinel resolve-hostnames yes2. Could not rename tmp config file (Device or resource busy)ä¸è¦ç›´æ¥æŒ‚è½½ sentinel.confg é…ç½®æ–‡ä»¶ï¼ŒæŒ‚è½½ç›®å½•volumes: - ./config/sentinel:/etc/redis 3. æ‰‹åŠ¨åœæ­¢ redis-mater æœåŠ¡æ•…éšœè½¬ç§»ä¸ç”Ÿæ•ˆæŠ¥é”™ redis-master æ— æ³•è§£æï¼ŒçŒœæµ‹å¯ä»¥è®¾ç½®æˆ IP æˆ–è€…ä½¿ç”¨ DNS æœåŠ¡æ¥é¿å…Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-08-28 "},"doc_design_pattern/":{"url":"doc_design_pattern/","title":"è®¾è®¡æ¨¡å¼","keywords":"","body":" è®¾è®¡æ¨¡å¼ golang ç‰ˆæœ¬ ç›®å½• å‚è€ƒ è®¾è®¡æ¨¡å¼ golang ç‰ˆæœ¬ç›®å½•åˆ›å»ºå‹æ¨¡å¼å·¥å‚æ–¹æ³• Factory Method æŠ½è±¡å·¥å‚ Abstract Factory ç”Ÿæˆå™¨ Builder åŸå‹ Prototype å•ä¾‹ Singleton ç»“æ„å‹æ¨¡å¼é€‚é…å™¨ Adapter æ¡¥æ¥ Bridge ç»„åˆ Composite è£…é¥° Decorator å¤–è§‚ Fecade äº«å…ƒ Flyweight ä»£ç† Proxy è¡Œä¸ºæ¨¡å¼è´£ä»»é“¾ Chain of Responsobility å‘½ä»¤ Command è¿­ä»£å™¨ Iterator ä¸­ä»‹è€… Mediator å¤‡å¿˜å½• Memento è§‚å¯Ÿè€… Observer çŠ¶æ€ State ç­–ç•¥ Strategy æ¨¡æ¿æ–¹æ³• Template Method è®¿é—®è€… Visitor å‚è€ƒhttps://refactoringguru.cn/design-patterns Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-22 "},"doc_design_pattern/factory_method.html":{"url":"doc_design_pattern/factory_method.html","title":"å·¥å‚æ–¹æ³•","keywords":"","body":" å·¥å‚æ–¹æ³• Factory Method ç¤ºä¾‹ iGun.go: äº§å“æ¥å£ gun.go: å…·ä½“äº§å“ ak47.go: å…·ä½“äº§å“ musket.go: å…·ä½“äº§å“ gunFactory.go: å·¥å‚ main.go: å®¢æˆ·ç«¯ä»£ç  å·¥å‚æ–¹æ³• Factory Methodå·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œ å…¶åœ¨çˆ¶ç±»ä¸­æä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ–¹æ³•ï¼Œ å…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚ç”±äº Go ä¸­ç¼ºå°‘ç±»å’Œç»§æ‰¿ç­‰ OOP ç‰¹æ€§ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ Go æ¥å®ç°ç»å…¸çš„å·¥å‚æ–¹æ³•æ¨¡å¼ã€‚ä¸è¿‡æˆ‘ä»¬ä»ç„¶èƒ½å®ç°æ¨¡å¼çš„åŸºç¡€ç‰ˆæœ¬ï¼Œå³ç®€å•å·¥å‚ã€‚ç¤ºä¾‹åˆ›å»ºä¸€ä¸ªåä¸º iÂ­Gun çš„æ¥å£ï¼Œ å…¶ä¸­å°†å®šä¹‰ä¸€æ”¯æªæ‰€éœ€å…·å¤‡çš„æ‰€æœ‰æ–¹æ³• ç„¶åæ˜¯å®ç°äº† iGun æ¥å£çš„ gunæªæ”¯ç»“æ„ä½“ç±»å‹ã€‚ä¸¤ç§å…·ä½“çš„æªæ”¯ï¼šak47 ä¸ musket ç«æªï¼Œä¸¤è€…éƒ½åµŒå…¥äº†æªæ”¯ç»“æ„ä½“ï¼Œ ä¸”é—´æ¥å®ç°äº†æ‰€æœ‰çš„ iÂ­Gunæ–¹æ³• gunÂ­Factory æªæ”¯å·¥å‚ç»“æ„ä½“å°†å‘æŒ¥å·¥å‚çš„ä½œç”¨ï¼Œå³é€šè¿‡ä¼ å…¥å‚æ•°æ„å»ºæ‰€éœ€ç±»å‹çš„æªæ”¯ iGun.go: äº§å“æ¥å£package main type IGun interface { setName(name string) setPower(power int) getName() string getPower() int } gun.go: å…·ä½“äº§å“package main type Gun struct { name string power int } func (g *Gun) setName(name string) { g.name = name } func (g *Gun) getName() string { return g.name } func (g *Gun) setPower(power int) { g.power = power } func (g *Gun) getPower() int { return g.power } ak47.go: å…·ä½“äº§å“package main type Ak47 struct { Gun } func newAk47() IGun { return &Ak47{ Gun: Gun{ name: \"AK47 gun\", power: 4, }, } } musket.go: å…·ä½“äº§å“package main type musket struct { Gun } func newMusket() IGun { return &musket{ Gun: Gun{ name: \"Musket gun\", power: 1, }, } } gunFactory.go: å·¥å‚package main import \"fmt\" func getGun(gunType string) (IGun, error) { if gunType == \"ak47\" { return newAk47(), nil } if gunType == \"musket\" { return newMusket(), nil } return nil, fmt.Errorf(\"Wrong gun type passed\") } main.go: å®¢æˆ·ç«¯ä»£ç package main import \"fmt\" func main() { ak47, _ := getGun(\"ak47\") musket, _ := getGun(\"musket\") printDetails(ak47) printDetails(musket) } func printDetails(g IGun) { fmt.Printf(\"Gun: %s\", g.getName()) fmt.Println() fmt.Printf(\"Power: %d\", g.getPower()) fmt.Println() } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-22 "},"doc_design_pattern/abstract_factory.html":{"url":"doc_design_pattern/abstract_factory.html","title":"æŠ½è±¡å·¥å‚","keywords":"","body":" æŠ½è±¡å·¥å‚ Abstract Factory ç¤ºä¾‹ iSportsFactory.go: æŠ½è±¡å·¥å‚æ¥å£ adidas.go: å…·ä½“å·¥å‚ nike.go: å…·ä½“å·¥å‚ iShoe.go: æŠ½è±¡äº§å“ adidasShoe.go: å…·ä½“äº§å“ nikeShoe.go: å…·ä½“äº§å“ iShirt.go: æŠ½è±¡äº§å“ adidasShirt.go: å…·ä½“äº§å“ nikeShirt.go: å…·ä½“äº§å“ main.go: å®¢æˆ·ç«¯ä»£ç  æŠ½è±¡å·¥å‚ Abstract FactoryæŠ½è±¡å·¥å‚æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œ å®ƒèƒ½åˆ›å»ºä¸€ç³»åˆ—ç›¸å…³çš„å¯¹è±¡ï¼Œ è€Œæ— éœ€æŒ‡å®šå…¶å…·ä½“ç±»ã€‚ç¤ºä¾‹è®©æˆ‘ä»¬å‡è®¾ä¸€ä¸‹ï¼Œå¦‚æœä½ æƒ³è¦è´­ä¹°ä¸€ç»„è¿åŠ¨è£…å¤‡ï¼Œæ¯”å¦‚ä¸€åŒé‹ä¸ä¸€ä»¶è¡¬è¡«è¿™æ ·ç”±ä¸¤ç§ä¸åŒäº§å“ç»„åˆè€Œæˆçš„å¥—è£…ã€‚ç›¸ä¿¡ä½ ä¼šæƒ³å»è´­ä¹°åŒä¸€å“ç‰Œçš„å•†å“ï¼Œè¿™æ ·å•†å“ä¹‹é—´èƒ½å¤Ÿäº’ç›¸æ­é…èµ·æ¥ã€‚å¦‚æœæˆ‘ä»¬æŠŠè¿™æ ·çš„è¡Œä¸ºè½¬æ¢æˆä»£ç çš„è¯ï¼Œå¸®åŠ©æˆ‘ä»¬åˆ›å»ºæ­¤ç±»äº§å“ç»„çš„å·¥å…·å°±æ˜¯æŠ½è±¡å·¥å‚ï¼Œä¾¿äºäº§å“ä¹‹é—´èƒ½å¤Ÿç›¸äº’åŒ¹é…ã€‚iSportsFactory.go: æŠ½è±¡å·¥å‚æ¥å£package main import \"fmt\" type ISportsFactory interface { makeShoe() IShoe makeShirt() IShirt } func GetSportsFactory(brand string) (ISportsFactory, error) { if brand == \"adidas\" { return &Adidas{}, nil } if brand == \"nike\" { return &Nike{}, nil } return nil, fmt.Errorf(\"Wrong brand type passed\") } adidas.go: å…·ä½“å·¥å‚package main type Adidas struct { } func (a *Adidas) makeShoe() IShoe { return &AdidasShoe{ Shoe: Shoe{ logo: \"adidas\", size: 14, }, } } func (a *Adidas) makeShirt() IShirt { return &AdidasShirt{ Shirt: Shirt{ logo: \"adidas\", size: 14, }, } } nike.go: å…·ä½“å·¥å‚package main type Nike struct { } func (n *Nike) makeShoe() IShoe { return &NikeShoe{ Shoe: Shoe{ logo: \"nike\", size: 14, }, } } func (n *Nike) makeShirt() IShirt { return &NikeShirt{ Shirt: Shirt{ logo: \"nike\", size: 14, }, } } iShoe.go: æŠ½è±¡äº§å“package main type IShoe interface { setLogo(logo string) setSize(size int) getLogo() string getSize() int } type Shoe struct { logo string size int } func (s *Shoe) setLogo(logo string) { s.logo = logo } func (s *Shoe) getLogo() string { return s.logo } func (s *Shoe) setSize(size int) { s.size = size } func (s *Shoe) getSize() int { return s.size } adidasShoe.go: å…·ä½“äº§å“package main type AdidasShoe struct { Shoe } nikeShoe.go: å…·ä½“äº§å“package main type NikeShoe struct { Shoe } iShirt.go: æŠ½è±¡äº§å“package main type IShirt interface { setLogo(logo string) setSize(size int) getLogo() string getSize() int } type Shirt struct { logo string size int } func (s *Shirt) setLogo(logo string) { s.logo = logo } func (s *Shirt) getLogo() string { return s.logo } func (s *Shirt) setSize(size int) { s.size = size } func (s *Shirt) getSize() int { return s.size } adidasShirt.go: å…·ä½“äº§å“package main type AdidasShirt struct { Shirt } nikeShirt.go: å…·ä½“äº§å“package main type NikeShirt struct { Shirt } main.go: å®¢æˆ·ç«¯ä»£ç package main import \"fmt\" func main() { adidasFactory, _ := GetSportsFactory(\"adidas\") nikeFactory, _ := GetSportsFactory(\"nike\") nikeShoe := nikeFactory.makeShoe() nikeShirt := nikeFactory.makeShirt() adidasShoe := adidasFactory.makeShoe() adidasShirt := adidasFactory.makeShirt() printShoeDetails(nikeShoe) printShirtDetails(nikeShirt) printShoeDetails(adidasShoe) printShirtDetails(adidasShirt) } func printShoeDetails(s IShoe) { fmt.Printf(\"Logo: %s\", s.getLogo()) fmt.Println() fmt.Printf(\"Size: %d\", s.getSize()) fmt.Println() } func printShirtDetails(s IShirt) { fmt.Printf(\"Logo: %s\", s.getLogo()) fmt.Println() fmt.Printf(\"Size: %d\", s.getSize()) fmt.Println() } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-22 "},"doc_design_pattern/builder.html":{"url":"doc_design_pattern/builder.html","title":"ç”Ÿæˆå™¨","keywords":"","body":" ç”Ÿæˆå™¨ Builder ç¤ºä¾‹ iBuilder.go: ç”Ÿæˆå™¨æ¥å£ normalBuilder.go: å…·ä½“ç”Ÿæˆå™¨ iglooBuilder.go: å…·ä½“ç”Ÿæˆå™¨ house.go: äº§å“ director.go: ä¸»ç®¡ main.go: å®¢æˆ·ç«¯ä»£ç  ç”Ÿæˆå™¨ Builderç”Ÿæˆå™¨æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œä½¿ä½ èƒ½å¤Ÿåˆ†æ­¥éª¤åˆ›å»ºå¤æ‚å¯¹è±¡ã€‚ç¤ºä¾‹å½“æ‰€éœ€äº§å“è¾ƒä¸ºå¤æ‚ä¸”éœ€è¦å¤šä¸ªæ­¥éª¤æ‰èƒ½å®Œæˆæ—¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ç”Ÿæˆå™¨æ¨¡å¼ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¤šä¸ªæ„é€ æ–¹æ³•æ¯”ä»…ä»…ä½¿ç”¨ä¸€ä¸ªå¤æ‚å¯æ€•çš„æ„é€ å‡½æ•°æ›´ç®€å•ã€‚åˆ†ä¸ºå¤šä¸ªæ­¥éª¤è¿›è¡Œæ„å»ºçš„æ½œåœ¨é—®é¢˜æ˜¯ï¼Œæ„å»ºä¸å®Œæ•´çš„å’Œä¸ç¨³å®šçš„äº§å“å¯èƒ½ä¼šè¢«æš´éœ²ç»™å®¢æˆ·ç«¯ã€‚ç”Ÿæˆå™¨æ¨¡å¼èƒ½å¤Ÿåœ¨äº§å“å®Œæˆæ„å»ºä¹‹å‰ä½¿å…¶å¤„äºç§å¯†çŠ¶æ€ã€‚åœ¨ä¸‹æ–¹çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° iglooÂ­Builderå†°å±‹ç”Ÿæˆå™¨ä¸ normalÂ­Builderæ™®é€šæˆ¿å±‹ç”Ÿæˆå™¨å¯å»ºé€ ä¸åŒç±»å‹æˆ¿å±‹ï¼Œå³ igloo å†°å±‹å’Œ normalÂ­House æ™®é€šæˆ¿å±‹ ã€‚æ¯ç§æˆ¿å±‹ç±»å‹çš„å»ºé€ æ­¥éª¤éƒ½æ˜¯ç›¸åŒçš„ã€‚ä¸»ç®¡ï¼ˆå¯é€‰ï¼‰ç»“æ„ä½“å¯å¯¹å»ºé€ è¿‡ç¨‹è¿›è¡Œç»„ç»‡ã€‚iBuilder.go: ç”Ÿæˆå™¨æ¥å£package main type IBuilder interface { setWindowType() setDoorType() setNumFloor() getHouse() House } func getBuilder(builderType string) IBuilder { if builderType == \"normal\" { return newNormalBuilder() } if builderType == \"igloo\" { return newIglooBuilder() } return nil } normalBuilder.go: å…·ä½“ç”Ÿæˆå™¨package main type NormalBuilder struct { windowType string doorType string floor int } func newNormalBuilder() *NormalBuilder { return &NormalBuilder{} } func (b *NormalBuilder) setWindowType() { b.windowType = \"Wooden Window\" } func (b *NormalBuilder) setDoorType() { b.doorType = \"Wooden Door\" } func (b *NormalBuilder) setNumFloor() { b.floor = 2 } func (b *NormalBuilder) getHouse() House { return House{ doorType: b.doorType, windowType: b.windowType, floor: b.floor, } } iglooBuilder.go: å…·ä½“ç”Ÿæˆå™¨package main type IglooBuilder struct { windowType string doorType string floor int } func newIglooBuilder() *IglooBuilder { return &IglooBuilder{} } func (b *IglooBuilder) setWindowType() { b.windowType = \"Snow Window\" } func (b *IglooBuilder) setDoorType() { b.doorType = \"Snow Door\" } func (b *IglooBuilder) setNumFloor() { b.floor = 1 } func (b *IglooBuilder) getHouse() House { return House{ doorType: b.doorType, windowType: b.windowType, floor: b.floor, } } house.go: äº§å“package main type House struct { windowType string doorType string floor int } director.go: ä¸»ç®¡package main type Director struct { builder IBuilder } func newDirector(b IBuilder) *Director { return &Director{ builder: b, } } func (d *Director) setBuilder(b IBuilder) { d.builder = b } func (d *Director) buildHouse() House { d.builder.setDoorType() d.builder.setWindowType() d.builder.setNumFloor() return d.builder.getHouse() } main.go: å®¢æˆ·ç«¯ä»£ç package main import \"fmt\" func main() { normalBuilder := getBuilder(\"normal\") iglooBuilder := getBuilder(\"igloo\") director := newDirector(normalBuilder) normalHouse := director.buildHouse() fmt.Printf(\"Normal House Door Type: %s\\n\", normalHouse.doorType) fmt.Printf(\"Normal House Window Type: %s\\n\", normalHouse.windowType) fmt.Printf(\"Normal House Num Floor: %d\\n\", normalHouse.floor) director.setBuilder(iglooBuilder) iglooHouse := director.buildHouse() fmt.Printf(\"\\nIgloo House Door Type: %s\\n\", iglooHouse.doorType) fmt.Printf(\"Igloo House Window Type: %s\\n\", iglooHouse.windowType) fmt.Printf(\"Igloo House Num Floor: %d\\n\", iglooHouse.floor) } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-22 "},"doc_design_pattern/prototype.html":{"url":"doc_design_pattern/prototype.html","title":"åŸå‹","keywords":"","body":" åŸå‹ Prototype ç¤ºä¾‹ inode.go: åŸå‹æ¥å£ file.go: å…·ä½“åŸå‹ folder.go: å…·ä½“åŸå‹ main.go: å®¢æˆ·ç«¯ä»£ç  åŸå‹ PrototypeåŸå‹æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œä½¿ä½ èƒ½å¤Ÿå¤åˆ¶å¯¹è±¡ï¼Œç”šè‡³æ˜¯å¤æ‚å¯¹è±¡ï¼Œè€Œåˆæ— éœ€ä½¿ä»£ç ä¾èµ–å®ƒä»¬æ‰€å±çš„ç±»ã€‚ç¤ºä¾‹è®©æˆ‘ä»¬å°è¯•é€šè¿‡åŸºäºæ“ä½œç³»ç»Ÿæ–‡ä»¶ç³»ç»Ÿçš„ç¤ºä¾‹æ¥ç†è§£åŸå‹æ¨¡å¼ã€‚æ“ä½œç³»ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯é€’å½’çš„ï¼šæ–‡ä»¶å¤¹ä¸­åŒ…å«æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åˆåŒ…å«æ–‡ä»¶å’Œæ–‡ä»¶å¤¹ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ¯ä¸ªæ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½å¯ç”¨ä¸€ä¸ª inode æ¥å£æ¥è¡¨ç¤ºã€‚â€‹ inode æ¥å£ä¸­åŒæ ·ä¹Ÿæœ‰ clone å…‹éš†åŠŸèƒ½ã€‚file æ–‡ä»¶å’Œ folder æ–‡ä»¶å¤¹ç»“æ„ä½“éƒ½å®ç°äº† print æ‰“å°å’Œ clone æ–¹æ³•ï¼Œå› ä¸ºå®ƒä»¬éƒ½æ˜¯ inode ç±»å‹ã€‚åŒæ—¶ï¼Œæ³¨æ„ file å’Œ folder ä¸­çš„ clone æ–¹æ³•ã€‚è¿™ä¸¤è€…çš„ clone æ–¹æ³•éƒ½ä¼šè¿”å›ç›¸åº”æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„å‰¯æœ¬ã€‚åŒæ—¶åœ¨å…‹éš†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šåœ¨å…¶åç§°åé¢æ·»åŠ  â€œ_cloneâ€ å­—æ ·ã€‚inode.go: åŸå‹æ¥å£package main type Inode interface { print(string) clone() Inode } file.go: å…·ä½“åŸå‹package main import \"fmt\" type File struct { name string } func (f *File) print(indentation string) { fmt.Println(indentation + f.name) } func (f *File) clone() Inode { return &File{name: f.name + \"_clone\"} } folder.go: å…·ä½“åŸå‹package main import \"fmt\" type Folder struct { children []Inode name string } func (f *Folder) print(indentation string) { fmt.Println(indentation + f.name) for _, i := range f.children { i.print(indentation + indentation) } } func (f *Folder) clone() Inode { cloneFolder := &Folder{name: f.name + \"_clone\"} var tempChildren []Inode for _, i := range f.children { copy := i.clone() tempChildren = append(tempChildren, copy) } cloneFolder.children = tempChildren return cloneFolder } main.go: å®¢æˆ·ç«¯ä»£ç package main import \"fmt\" func main() { file1 := &File{name: \"File1\"} file2 := &File{name: \"File2\"} file3 := &File{name: \"File3\"} folder1 := &Folder{ children: []Inode{file1}, name: \"Folder1\", } folder2 := &Folder{ children: []Inode{folder1, file2, file3}, name: \"Folder2\", } fmt.Println(\"\\nPrinting hierarchy for Folder2\") folder2.print(\" \") cloneFolder := folder2.clone() fmt.Println(\"\\nPrinting hierarchy for clone Folder\") cloneFolder.print(\" \") } output.txt: æ‰§è¡Œç»“æœPrinting hierarchy for Folder2 Folder2 Folder1 File1 File2 File3 Printing hierarchy for clone Folder Folder2_clone Folder1_clone File1_clone File2_clone File3_clone Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-22 "},"doc_design_pattern/singleton.html":{"url":"doc_design_pattern/singleton.html","title":"å•ä¾‹","keywords":"","body":" å•ä¾‹ Singleton ç¤ºä¾‹ä¸€ ç¤ºä¾‹äºŒ ç¤ºä¾‹ä¸‰ å•ä¾‹ Singletonå•ä¾‹æ¨¡å¼æ˜¯ä¸€ç§åˆ›å»ºå‹è®¾è®¡æ¨¡å¼ï¼Œ è®©ä½ èƒ½å¤Ÿä¿è¯ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œ å¹¶æä¾›ä¸€ä¸ªè®¿é—®è¯¥å®ä¾‹çš„å…¨å±€èŠ‚ç‚¹ã€‚ç¤ºä¾‹ä¸€å…ˆä¸åŠ é”å¿«é€Ÿåˆ¤æ–­è¿”å›æé«˜æ€§èƒ½ åŠ é”å double check ä¿è¯å¹¶å‘å®‰å…¨ package main import ( \"fmt\" \"sync\" ) var lock = &sync.Mutex{} type single struct { } var singleInstance *single func getInstance() *single { // double check if singleInstance == nil { lock.Lock() defer lock.Unlock() if singleInstance == nil { fmt.Println(\"Creating single instance now.\") singleInstance = &single{} } else { fmt.Println(\"Single instance already created.\") } } else { fmt.Println(\"Single instance already created.\") } return singleInstance } ç¤ºä¾‹äºŒinit å‡½æ•°ä¼šåœ¨åŒ…ä¸­çš„æ¯ä¸ªæ–‡ä»¶è°ƒç”¨ä¸€æ¬¡ï¼Œå¯ä»¥åšå•ä¾‹åˆå§‹åŒ–åŠ¨ä½œ func init () {} ç¤ºä¾‹ä¸‰ä½¿ç”¨ sync.Once å®ç°å•ä¾‹ï¼Œå®é™…åº•å±‚å®ç°æ˜¯åŸå­é‡åŠ äº’æ–¥é” package main import ( \"fmt\" \"sync\" ) var once sync.Once type single struct { } var singleInstance *single func getInstance() *single { if singleInstance == nil { once.Do( func() { fmt.Println(\"Creating single instance now.\") singleInstance = &single{} }) } else { fmt.Println(\"Single instance already created.\") } return singleInstance } Copyright Â©ZhangFeng all right reservedï¼Œpowered by Gitbook 2025-09-22 "}}